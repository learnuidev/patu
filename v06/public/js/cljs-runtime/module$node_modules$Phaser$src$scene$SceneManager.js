shadow$provide.module$node_modules$Phaser$src$scene$SceneManager=function(global,require,module,exports){global=require("module$node_modules$Phaser$src$utils$Class");var CONST=require("module$node_modules$Phaser$src$scene$const"),GetValue=require("module$node_modules$Phaser$src$utils$object$GetValue"),NOOP=require("module$node_modules$Phaser$src$utils$NOOP"),Scene=require("module$node_modules$Phaser$src$scene$Scene"),Systems=require("module$node_modules$Phaser$src$scene$Systems");require=new global({initialize:function(game,
sceneConfig){this.game=game;this.keys={};this.scenes=[];this._pending=[];this._start=[];this._queue=[];this._data={};this.isBooted=this.isProcessing=!1;this.customViewports=0;if(sceneConfig){Array.isArray(sceneConfig)||(sceneConfig=[sceneConfig]);for(var i=0;i<sceneConfig.length;i++)this._pending.push({key:"default",scene:sceneConfig[i],autoStart:0===i,data:{}})}game.events.once("ready",this.bootQueue,this)},bootQueue:function(){if(!this.isBooted){var i;for(i=0;i<this._pending.length;i++){var entry=
this._pending[i];var key=entry.key;var sceneConfig=entry.scene;var newScene;sceneConfig instanceof Scene?newScene=this.createSceneFromInstance(key,sceneConfig):"object"===typeof sceneConfig?newScene=this.createSceneFromObject(key,sceneConfig):"function"===typeof sceneConfig&&(newScene=this.createSceneFromFunction(key,sceneConfig));key=newScene.sys.settings.key;this.keys[key]=newScene;this.scenes.push(newScene);this._data[key]&&(newScene.sys.settings.data=this._data[key].data,this._data[key].autoStart&&
(entry.autoStart=!0));(entry.autoStart||newScene.sys.settings.active)&&this._start.push(key)}this._pending.length=0;this._data={};this.isBooted=!0;for(i=0;i<this._start.length;i++)entry=this._start[i],this.start(entry);this._start.length=0}},processQueue:function(){var pendingLength=this._pending.length,queueLength=this._queue.length;if(0!==pendingLength||0!==queueLength)if(pendingLength){for(queueLength=0;queueLength<pendingLength;queueLength++){var entry=this._pending[queueLength];this.add(entry.key,
entry.scene,entry.autoStart,entry.data)}for(queueLength=0;queueLength<this._start.length;queueLength++)entry=this._start[queueLength],this.start(entry);this._start.length=0;this._pending.length=0}else{for(queueLength=0;queueLength<this._queue.length;queueLength++)entry=this._queue[queueLength],this[entry.op](entry.keyA,entry.keyB);this._queue.length=0}},add:function(key,sceneConfig,autoStart,data){void 0===autoStart&&(autoStart=!1);void 0===data&&(data={});if(this.isProcessing||!this.isBooted)return this._pending.push({key:key,
scene:sceneConfig,autoStart:autoStart,data:data}),this.isBooted||(this._data[key]={data:data}),null;key=this.getKey(key,sceneConfig);if(sceneConfig instanceof Scene)var newScene=this.createSceneFromInstance(key,sceneConfig);else"object"===typeof sceneConfig?(sceneConfig.key=key,newScene=this.createSceneFromObject(key,sceneConfig)):"function"===typeof sceneConfig&&(newScene=this.createSceneFromFunction(key,sceneConfig));newScene.sys.settings.data=data;key=newScene.sys.settings.key;this.keys[key]=newScene;
this.scenes.push(newScene);if(autoStart||newScene.sys.settings.active)this._pending.length?this._start.push(key):this.start(key);return newScene},remove:function(key){if(this.isProcessing)this._queue.push({op:"remove",keyA:key,keyB:null});else{key=this.getScene(key);if(!key||key.sys.isTransitioning())return this;var index=this.scenes.indexOf(key),sceneKey=key.sys.settings.key;-1<index&&(delete this.keys[sceneKey],this.scenes.splice(index,1),-1<this._start.indexOf(sceneKey)&&(index=this._start.indexOf(sceneKey),
this._start.splice(index,1)),key.sys.destroy())}return this},bootScene:function(scene){var sys=scene.sys,settings=sys.settings;scene.init&&(scene.init.call(scene,settings.data),settings.status=CONST.INIT,settings.isTransition&&sys.events.emit("transitioninit",settings.transitionFrom,settings.transitionDuration));if(sys.load){var loader=sys.load;loader.reset()}loader&&scene.preload?(scene.preload.call(scene),0===loader.list.size?this.create(scene):(settings.status=CONST.LOADING,loader.once("complete",
this.loadComplete,this),loader.start())):this.create(scene)},loadComplete:function(loader){loader=loader.scene;this.game.sound.onBlurPausedSounds&&this.game.sound.unlock();this.create(loader)},payloadComplete:function(loader){this.bootScene(loader.scene)},update:function(time,delta){this.processQueue();this.isProcessing=!0;for(var i=this.scenes.length-1;0<=i;i--){var sys=this.scenes[i].sys;sys.settings.status>CONST.START&&sys.settings.status<=CONST.RUNNING&&sys.step(time,delta)}},resize:function(width,
height){for(var i=0;i<this.scenes.length;i++)this.scenes[i].sys.resize(width,height)},render:function(renderer){for(var i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys;sys.settings.visible&&sys.settings.status>=CONST.LOADING&&sys.settings.status<CONST.SLEEPING&&sys.render(renderer)}this.isProcessing=!1},create:function(scene){var sys=scene.sys,settings=sys.settings;scene.create&&(settings.status=CONST.CREATING,scene.create.call(scene,settings.data),settings.isTransition&&sys.events.emit("transitionstart",
settings.transitionFrom,settings.transitionDuration));scene.update&&(sys.sceneUpdate=scene.update);settings.status=CONST.RUNNING},createSceneFromFunction:function(key,scene){scene=new scene;if(scene instanceof Scene){var configKey=scene.sys.settings.key;""!==configKey&&(key=configKey);if(this.keys.hasOwnProperty(key))throw Error("Cannot add a Scene with duplicate key: "+key);return this.createSceneFromInstance(key,scene)}scene.sys=new Systems(scene);scene.sys.settings.key=key;scene.sys.init(this.game);
return scene},createSceneFromInstance:function(key,newScene){""===newScene.sys.settings.key&&(newScene.sys.settings.key=key);newScene.sys.init(this.game);return newScene},createSceneFromObject:function(key,sceneConfig){var newScene=new Scene(sceneConfig);""===newScene.sys.settings.key&&(newScene.sys.settings.key=key);newScene.sys.init(this.game);key=["init","preload","create","update","render"];for(var i=0;i<key.length;i++){var sceneCallback=GetValue(sceneConfig,key[i],null);sceneCallback&&(newScene[key[i]]=
sceneCallback)}if(sceneConfig.hasOwnProperty("extend"))for(var propertyKey in sceneConfig.extend)key=sceneConfig.extend[propertyKey],"data"===propertyKey&&newScene.hasOwnProperty("data")&&"object"===typeof key?newScene.data.merge(key):"sys"!==propertyKey&&(newScene[propertyKey]=key);return newScene},getKey:function(key,sceneConfig){key||(key="default");if("function"===typeof sceneConfig)return key;sceneConfig instanceof Scene?key=sceneConfig.sys.settings.key:"object"===typeof sceneConfig&&sceneConfig.hasOwnProperty("key")&&
(key=sceneConfig.key);if(this.keys.hasOwnProperty(key))throw Error("Cannot add a Scene with duplicate key: "+key);return key},getScene:function(key){if("string"===typeof key){if(this.keys[key])return this.keys[key]}else for(var i=0;i<this.scenes.length;i++)if(key===this.scenes[i])return key;return null},isActive:function(key){return(key=this.getScene(key))?key.sys.isActive():null},isVisible:function(key){return(key=this.getScene(key))?key.sys.isVisible():null},isSleeping:function(key){return(key=
this.getScene(key))?key.sys.isSleeping():null},pause:function(key,data){(key=this.getScene(key))&&key.sys.pause(data);return this},resume:function(key,data){(key=this.getScene(key))&&key.sys.resume(data);return this},sleep:function(key,data){(key=this.getScene(key))&&!key.sys.isTransitioning()&&key.sys.sleep(data);return this},wake:function(key,data){(key=this.getScene(key))&&key.sys.wake(data);return this},run:function(key,data){var scene=this.getScene(key);if(!scene){for(scene=0;scene<this._pending.length;scene++)if(this._pending[scene].key===
key){this.queueOp("start",key,data);break}return this}scene.sys.isSleeping()?scene.sys.wake(data):scene.sys.isBooted&&!scene.sys.isActive()?scene.sys.resume(data):this.start(key,data)},start:function(key,data){if(!this.isBooted)return this._data[key]={autoStart:!0,data:data},this;if(key=this.getScene(key)){if(key.sys.isActive()||key.sys.isPaused())key.sys.shutdown(),key.sys.start(data);else{key.sys.start(data);if(key.sys.load)var loader=key.sys.load;if(loader&&key.sys.settings.hasOwnProperty("pack")&&
(loader.reset(),loader.addPack({payload:key.sys.settings.pack})))return key.sys.settings.status=CONST.LOADING,loader.once("complete",this.payloadComplete,this),loader.start(),this}this.bootScene(key)}return this},stop:function(key){(key=this.getScene(key))&&!key.sys.isTransitioning()&&key.sys.shutdown();return this},switch:function(from,to){var sceneA=this.getScene(from),sceneB=this.getScene(to);sceneA&&sceneB&&sceneA!==sceneB&&(this.sleep(from),this.isSleeping(to)?this.wake(to):this.start(to));return this},
getAt:function(index){return this.scenes[index]},getIndex:function(key){key=this.getScene(key);return this.scenes.indexOf(key)},bringToTop:function(key){if(this.isProcessing)this._queue.push({op:"bringToTop",keyA:key,keyB:null});else{var index=this.getIndex(key);-1!==index&&index<this.scenes.length&&(key=this.getScene(key),this.scenes.splice(index,1),this.scenes.push(key))}return this},sendToBack:function(key){if(this.isProcessing)this._queue.push({op:"sendToBack",keyA:key,keyB:null});else{var index=
this.getIndex(key);-1!==index&&0<index&&(key=this.getScene(key),this.scenes.splice(index,1),this.scenes.unshift(key))}return this},moveDown:function(key){if(this.isProcessing)this._queue.push({op:"moveDown",keyA:key,keyB:null});else{var indexA=this.getIndex(key);if(0<indexA){var indexB=indexA-1;key=this.getScene(key);var sceneB=this.getAt(indexB);this.scenes[indexA]=sceneB;this.scenes[indexB]=key}}return this},moveUp:function(key){if(this.isProcessing)this._queue.push({op:"moveUp",keyA:key,keyB:null});
else{var indexA=this.getIndex(key);if(indexA<this.scenes.length-1){var indexB=indexA+1;key=this.getScene(key);var sceneB=this.getAt(indexB);this.scenes[indexA]=sceneB;this.scenes[indexB]=key}}return this},moveAbove:function(keyA,keyB){if(keyA===keyB)return this;if(this.isProcessing)this._queue.push({op:"moveAbove",keyA:keyA,keyB:keyB});else if(keyA=this.getIndex(keyA),keyB=this.getIndex(keyB),-1!==keyA&&-1!==keyB){var tempScene=this.getAt(keyB);this.scenes.splice(keyB,1);this.scenes.splice(keyA+1,
0,tempScene)}return this},moveBelow:function(keyA,keyB){if(keyA===keyB)return this;if(this.isProcessing)this._queue.push({op:"moveBelow",keyA:keyA,keyB:keyB});else if(keyA=this.getIndex(keyA),keyB=this.getIndex(keyB),-1!==keyA&&-1!==keyB){var tempScene=this.getAt(keyB);this.scenes.splice(keyB,1);0===keyA?this.scenes.unshift(tempScene):this.scenes.splice(keyA,0,tempScene)}return this},queueOp:function(op,keyA,keyB){this._queue.push({op:op,keyA:keyA,keyB:keyB});return this},swapPosition:function(keyA,
keyB){if(keyA===keyB)return this;if(this.isProcessing)this._queue.push({op:"swapPosition",keyA:keyA,keyB:keyB});else if(keyA=this.getIndex(keyA),keyB=this.getIndex(keyB),keyA!==keyB&&-1!==keyA&&-1!==keyB){var tempScene=this.getAt(keyA);this.scenes[keyA]=this.scenes[keyB];this.scenes[keyB]=tempScene}return this},dump:function(){for(var out=[],map="pending init start loading creating running paused sleeping shutdown destroyed".split(" "),i=0;i<this.scenes.length;i++){var sys=this.scenes[i].sys,key=
!sys.settings.visible||sys.settings.status!==CONST.RUNNING&&sys.settings.status!==CONST.PAUSED?"[-] ":"[*] ";key+=sys.settings.key+" ("+map[sys.settings.status]+")";out.push(key)}console.log(out.join("\n"))},destroy:function(){for(var i=0;i<this.scenes.length;i++)this.scenes[i].sys.destroy();this.update=NOOP;this.scenes=[];this._pending=[];this._start=[];this._queue=[];this.game=null}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$scene$SceneManager.js.map
