shadow$provide.module$node_modules$Phaser$src$gameobjects$text$static$Text=function(global,require,module,exports){var AddToDOM=require("module$node_modules$Phaser$src$dom$AddToDOM"),CanvasPool=require("module$node_modules$Phaser$src$display$canvas$CanvasPool");global=require("module$node_modules$Phaser$src$utils$Class");var Components=require("module$node_modules$Phaser$src$gameobjects$components$index"),CONST=require("module$node_modules$Phaser$src$const"),GameObject=require("module$node_modules$Phaser$src$gameobjects$GameObject"),
GetTextSize=require("module$node_modules$Phaser$src$gameobjects$text$GetTextSize"),GetValue=require("module$node_modules$Phaser$src$utils$object$GetValue"),RemoveFromDOM=require("module$node_modules$Phaser$src$dom$RemoveFromDOM");exports=require("module$node_modules$Phaser$src$gameobjects$text$static$TextRender");var TextStyle=require("module$node_modules$Phaser$src$gameobjects$text$TextStyle");require=new global({Extends:GameObject,Mixins:[Components.Alpha,Components.BlendMode,Components.ComputedSize,
Components.Crop,Components.Depth,Components.Flip,Components.GetBounds,Components.Mask,Components.Origin,Components.Pipeline,Components.ScaleMode,Components.ScrollFactor,Components.Tint,Components.Transform,Components.Visible,exports],initialize:function(scene,x,y,text,style){void 0===x&&(x=0);void 0===y&&(y=0);GameObject.call(this,scene,"Text");this.renderer=scene.sys.game.renderer;this.setPosition(x,y);this.setOrigin(0,0);this.initPipeline();this.canvas=CanvasPool.create(this);this.context=this.canvas.getContext("2d");
this.style=new TextStyle(this,style);this.autoRound=!0;this.splitRegExp=/(?:\r\n|\r|\n)/;this._text="";this.padding={left:0,right:0,top:0,bottom:0};this.height=this.width=1;this.lineSpacing=0;this.dirty=!1;0===this.style.resolution&&(this.style.resolution=scene.sys.game.config.resolution);this._crop=this.resetCropObject();this.texture=scene.sys.textures.addCanvas(null,this.canvas,!0);this.frame=this.texture.get();this.frame.source.resolution=this.style.resolution;this.initRTL();style&&style.padding&&
this.setPadding(style.padding);style&&style.lineSpacing&&(this.lineSpacing=style.lineSpacing);this.setText(text);if(scene.sys.game.config.renderType===CONST.WEBGL)scene.sys.game.renderer.onContextRestored(function(){this.dirty=!0},this)},initRTL:function(){this.style.rtl&&(this.canvas.dir="rtl",this.context.direction="rtl",this.canvas.style.display="none",AddToDOM(this.canvas,this.scene.sys.canvas),this.originX=1)},runWordWrap:function(text){var style=this.style;return style.wordWrapCallback?(text=
style.wordWrapCallback.call(style.wordWrapCallbackScope,text,this),Array.isArray(text)&&(text=text.join("\n")),text):style.wordWrapWidth?style.wordWrapUseAdvanced?this.advancedWordWrap(text,this.context,this.style.wordWrapWidth):this.basicWordWrap(text,this.context,this.style.wordWrapWidth):text},advancedWordWrap:function(text,context,wordWrapWidth){var output="";text=text.replace(/ +/gi," ").split(this.splitRegExp);for(var linesCount=text.length,i=0;i<linesCount;i++){var line=text[i],out="";line=
line.replace(/^ *|\s*$/gi,"");if(context.measureText(line).width<wordWrapWidth)output+=line+"\n";else{var currentLineWidth=wordWrapWidth;line=line.split(" ");for(var j=0;j<line.length;j++){var word=line[j],wordWithSpace=word+" ",wordWidth=context.measureText(wordWithSpace).width;if(wordWidth>currentLineWidth){if(0===j){for(linesCount=wordWithSpace;linesCount.length&&!(linesCount=linesCount.slice(0,-1),wordWidth=context.measureText(linesCount).width,wordWidth<=currentLineWidth););if(!linesCount.length)throw Error("This text's wordWrapWidth setting is less than a single character!");
currentLineWidth=word.substr(linesCount.length);line[j]=currentLineWidth;out+=linesCount}currentLineWidth=line.slice(line[j].length?j:j+1).join(" ").replace(/[ \n]*$/gi,"");text[i+1]=currentLineWidth+" "+(text[i+1]||"");linesCount=text.length;break}else out+=wordWithSpace,currentLineWidth-=wordWidth}output+=out.replace(/[ \n]*$/gi,"")+"\n"}}return output=output.replace(/[\s|\n]*$/gi,"")},basicWordWrap:function(text,context,wordWrapWidth){var result="";text=text.split(this.splitRegExp);for(var i=0;i<
text.length;i++){for(var spaceLeft=wordWrapWidth,words=text[i].split(" "),j=0;j<words.length;j++){var wordWidth=context.measureText(words[j]).width,wordWidthWithSpace=wordWidth+context.measureText(" ").width;wordWidthWithSpace>spaceLeft?(0<j&&(result+="\n"),result+=words[j]+" ",spaceLeft=wordWrapWidth-wordWidth):(spaceLeft-=wordWidthWithSpace,result+=words[j],j<words.length-1&&(result+=" "))}i<text.length-1&&(result+="\n")}return result},getWrappedText:function(text){void 0===text&&(text=this._text);
this.style.syncFont(this.canvas,this.context);return this.runWordWrap(text).split(this.splitRegExp)},setText:function(value){value||0===value||(value="");Array.isArray(value)&&(value=value.join("\n"));value!==this._text&&(this._text=value.toString(),this.updateText());return this},setStyle:function(style){return this.style.setStyle(style)},setFont:function(font){return this.style.setFont(font)},setFontFamily:function(family){return this.style.setFontFamily(family)},setFontSize:function(size){return this.style.setFontSize(size)},
setFontStyle:function(style){return this.style.setFontStyle(style)},setFixedSize:function(width,height){return this.style.setFixedSize(width,height)},setBackgroundColor:function(color){return this.style.setBackgroundColor(color)},setFill:function(color){return this.style.setFill(color)},setColor:function(color){return this.style.setColor(color)},setStroke:function(color,thickness){return this.style.setStroke(color,thickness)},setShadow:function(x,y,color,blur,shadowStroke,shadowFill){return this.style.setShadow(x,
y,color,blur,shadowStroke,shadowFill)},setShadowOffset:function(x,y){return this.style.setShadowOffset(x,y)},setShadowColor:function(color){return this.style.setShadowColor(color)},setShadowBlur:function(blur){return this.style.setShadowBlur(blur)},setShadowStroke:function(enabled){return this.style.setShadowStroke(enabled)},setShadowFill:function(enabled){return this.style.setShadowFill(enabled)},setWordWrapWidth:function(width,useAdvancedWrap){return this.style.setWordWrapWidth(width,useAdvancedWrap)},
setWordWrapCallback:function(callback,scope){return this.style.setWordWrapCallback(callback,scope)},setAlign:function(align){return this.style.setAlign(align)},setResolution:function(value){return this.style.setResolution(value)},setLineSpacing:function(value){this.lineSpacing=value;return this.updateText()},setPadding:function(left,top,right,bottom){if("object"===typeof left){bottom=left;top=GetValue(bottom,"x",null);null!==top?right=left=top:(left=GetValue(bottom,"left",0),right=GetValue(bottom,
"right",left));var y=GetValue(bottom,"y",null);null!==y?bottom=top=y:(top=GetValue(bottom,"top",0),bottom=GetValue(bottom,"bottom",top))}else void 0===left&&(left=0),void 0===top&&(top=left),void 0===right&&(right=left),void 0===bottom&&(bottom=top);this.padding.left=left;this.padding.top=top;this.padding.right=right;this.padding.bottom=bottom;return this.updateText()},setMaxLines:function(max){return this.style.setMaxLines(max)},updateText:function(){var canvas=this.canvas,context=this.context,style=
this.style,resolution=style.resolution,size=style.metrics;style.syncFont(canvas,context);var outputText=this._text;if(style.wordWrapWidth||style.wordWrapCallback)outputText=this.runWordWrap(this._text);outputText=outputText.split(this.splitRegExp);var textSize=GetTextSize(this,size,outputText),padding=this.padding,w=textSize.width+padding.left+padding.right,h=textSize.height+padding.top+padding.bottom;0===style.fixedWidth&&(this.width=w);0===style.fixedHeight&&(this.height=h);this.updateDisplayOrigin();
w=Math.max(w*resolution,1);h=Math.max(h*resolution,1);canvas.width!==w||canvas.height!==h?(canvas.width=w,canvas.height=h,this.frame.setSize(w,h),style.syncFont(canvas,context)):context.clearRect(0,0,w,h);context.save();context.scale(resolution,resolution);style.backgroundColor&&(context.fillStyle=style.backgroundColor,context.fillRect(0,0,w,h));style.syncStyle(canvas,context);context.textBaseline="alphabetic";context.translate(padding.left,padding.top);for(h=0;h<textSize.lines;h++)resolution=style.strokeThickness/
2,padding=style.strokeThickness/2+h*textSize.lineHeight+size.ascent,0<h&&(padding+=textSize.lineSpacing*h),style.rtl?resolution=w-resolution:"right"===style.align?resolution+=textSize.width-textSize.lineWidths[h]:"center"===style.align&&(resolution+=(textSize.width-textSize.lineWidths[h])/2),this.autoRound&&(resolution=Math.round(resolution),padding=Math.round(padding)),style.strokeThickness&&(this.style.syncShadow(context,style.shadowStroke),context.strokeText(outputText[h],resolution,padding)),
style.color&&(this.style.syncShadow(context,style.shadowFill),context.fillText(outputText[h],resolution,padding));context.restore();this.renderer.gl&&(this.frame.source.glTexture=this.renderer.canvasToTexture(canvas,this.frame.source.glTexture),this.frame.glTexture=this.frame.source.glTexture);this.dirty=!0;return this},getTextMetrics:function(){return this.style.getTextMetrics()},text:{get:function(){return this._text},set:function(value){this.setText(value)}},toJSON:function(){var out=Components.ToJSON(this),
data={autoRound:this.autoRound,text:this._text,style:this.style.toJSON(),padding:{left:this.padding.left,right:this.padding.right,top:this.padding.top,bottom:this.padding.bottom}};out.data=data;return out},preDestroy:function(){this.style.rtl&&RemoveFromDOM(this.canvas);CanvasPool.remove(this.canvas);this.texture.destroy()}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$gameobjects$text$static$Text.js.map
