{
"version":3,
"file":"module$lib$app.js",
"lineCount":176,
"mappings":"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",
"sources":["lib/app.js"],
"sourcesContent":["import { vec2 } from \"/lib/math.js\";\n\nfunction processBtnState(s) {\n  if (s === \"pressed\" || s === \"rpressed\") {\n    return \"down\";\n  }\n  if (s === \"released\") {\n    return \"up\";\n  }\n  return s;\n}\n\nfunction appInit(gconf = {}) {\n  const app = {\n    // canvas x 20\n    // global x15 [width x2[s], height x2[s], style[s], setAttribute[m], getContext[m]], addEventListener[m]x7, focus[m]]\n    // funcs x 4\n    //  1. screenshot    #(.toDataURL canvas)\n    //  2. cursor x2     #(set! canvas -style -cursor (or % \"default\"))\n    //  3. focused       #(= canvas (js-get document :activeElement))\n    //  4. focus         #(.focus canvas)\n    canvas: gconf.canvas\n      ? gconf.canvas\n      : (() => {\n          const canvas = document.createElement(\"canvas\");\n          (gconf.root ? gconf.root : document.body).appendChild(canvas);\n          return canvas;\n        })(),\n\n    // ===============================================================================================================\n    // ======================================================= State =================================================\n    // ===============================================================================================================\n    // ==\n    loopID: null, // 3    2 funs [run quit]\n    stopped: false, // 2    2 funs [run quit]\n    // depends on canvas\n    keyStates: {}, // 13   8 funcs [run x3, keyPressed, keyPressedRep x2, keyDown x3, keyReleased, canvas.el [keydown x2, keyup]]\n    charInputted: [], // 4    3 funcs [runx2, charInputted, canvas.el [keydown]]\n    mouseState: \"up\", // 8    7 funcs [run, mouseClicked, mouseDown, moseReleased, canvas.el [mousedownx2, mouseup, touchstart]]\n    mousePos: vec2(0, 0), // 4    4 funcs [mousePos, canvas.el [mousemove, touchstart, touchmove]]\n    skipTime: false, // 3    3 funcs [run x2, document.el(\"visibilitychange\", cb)]\n    scale: gconf.scale ? gconf.scale : 1, // 5    3 funcs [canvas.el [mousemove, touchstart, touchmove]] | depends on canvas, fullScreen,\n    realTime: 0, // 2    1 func [run]\n    // depends on realTime\n    dt: 0.0, // 5    2 funcs [run, dt],\n    // depends on window, navigator\n    isTouch: false, // 1    0 funcs\n    // depends on skipTime, fpsTimer\n    fps: 0, // 1    1 func [run]\n    // depends on skipTime\n    time: 0, // 2    1 func [run]\n    fpsBuf: [], // 4    1 func [run]\n    fpsTimer: 0 // 3    1 func [run x3]\n  };\n\n  localStorage.setItem(\"app\", JSON.stringify(app));\n  console.log(\"app\", app);\n\n  const keyMap = {\n    ArrowLeft: \"left\",\n    ArrowRight: \"right\",\n    ArrowUp: \"up\",\n    ArrowDown: \"down\",\n    \" \": \"space\"\n  };\n\n  const preventDefaultKeys = [\n    \"space\",\n    \"left\",\n    \"right\",\n    \"up\",\n    \"down\",\n    \"tab\",\n    \"f1\",\n    \"f2\",\n    \"f3\",\n    \"f4\",\n    \"f5\",\n    \"f6\",\n    \"f7\",\n    \"f8\",\n    \"f9\",\n    \"f10\",\n    \"f11\"\n  ];\n\n  if (gconf.fullscreen) {\n    app.canvas.width = window.innerWidth;\n    app.canvas.height = window.innerHeight;\n  } else {\n    app.canvas.width = (gconf.width || 640) * app.scale;\n    app.canvas.height = (gconf.height || 480) * app.scale;\n  }\n\n  const styles = [\"outline: none\", \"cursor: default\"];\n\n  if (gconf.crisp) {\n    styles.push(\"image-rendering: pixelated\");\n    styles.push(\"image-rendering: crisp-edges\");\n  }\n\n  // @ts-ignore\n  app.canvas.style = styles.join(\";\");\n  app.canvas.setAttribute(\"tabindex\", \"0\");\n\n  const gl = app.canvas.getContext(\"webgl\", {\n    antialias: true,\n    depth: true,\n    stencil: true,\n    alpha: true,\n    preserveDrawingBuffer: true\n  });\n\n  app.isTouch =\n    \"ontouchstart\" in window ||\n    navigator.maxTouchPoints > 0 ||\n    navigator.msMaxTouchPoints > 0;\n\n  app.canvas.addEventListener(\"mousemove\", e => {\n    app.mousePos = vec2(e.offsetX, e.offsetY).scale(1 / app.scale);\n  });\n\n  app.canvas.addEventListener(\"mousedown\", () => {\n    app.mouseState = \"pressed\";\n  });\n\n  app.canvas.addEventListener(\"mouseup\", () => {\n    app.mouseState = \"released\";\n  });\n\n  app.canvas.addEventListener(\"touchstart\", e => {\n    const t = e.touches[0];\n    app.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n    app.mouseState = \"pressed\";\n  });\n\n  app.canvas.addEventListener(\"touchmove\", e => {\n    const t = e.touches[0];\n    app.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n  });\n\n  // funcs [run x3, canvas.el [keydown x2  ]]\n  app.canvas.addEventListener(\"keydown\", e => {\n    const k = keyMap[e.key] || e.key.toLowerCase();\n\n    if (preventDefaultKeys.includes(k)) {\n      e.preventDefault();\n    }\n\n    if (k.length === 1) {\n      app.charInputted.push(k);\n    }\n\n    if (k === \"space\") {\n      app.charInputted.push(\" \");\n    }\n\n    if (e.repeat) {\n      app.keyStates[k] = \"rpressed\";\n    } else {\n      app.keyStates[k] = \"pressed\";\n    }\n  });\n  // funcs [run x3, canvas.el [keydown x2, keyup,   ]]\n\n  app.canvas.addEventListener(\"keyup\", e => {\n    const k = keyMap[e.key] || e.key.toLowerCase();\n    app.keyStates[k] = \"released\";\n  });\n\n  app.canvas.focus();\n\n  document.addEventListener(\"visibilitychange\", () => {\n    switch (document.visibilityState) {\n      case \"visible\":\n        // prevent a surge of dt() when switch back after the tab being hidden for a while\n        app.skipTime = true;\n        //  \t\t\t\taudio.ctx().resume();\n        break;\n      case \"hidden\":\n        //  \t\t\t\taudio.ctx().suspend();\n        break;\n    }\n  });\n\n  function mousePos() {\n    return app.mousePos.clone();\n  }\n\n  function mouseClicked() {\n    return app.mouseState === \"pressed\";\n  }\n\n  function mouseDown() {\n    return app.mouseState === \"pressed\" || app.mouseState === \"down\";\n  }\n\n  function mouseReleased() {\n    return app.mouseState === \"released\";\n  }\n\n  function keyPressed(k) {\n    return app.keyStates[k] === \"pressed\";\n  }\n\n  function keyPressedRep(k) {\n    return app.keyStates[k] === \"pressed\" || app.keyStates[k] === \"rpressed\";\n  }\n\n  function keyDown(k) {\n    return (\n      app.keyStates[k] === \"pressed\" ||\n      app.keyStates[k] === \"rpressed\" ||\n      app.keyStates[k] === \"down\"\n    );\n  }\n\n  function keyReleased(k) {\n    return app.keyStates[k] === \"released\";\n  }\n\n  function charInputted() {\n    return [...app.charInputted];\n  }\n\n  // get delta time between last frame\n  function dt() {\n    return app.dt;\n  }\n\n  // get current running time\n  function time() {\n    return app.time; // num\n  }\n\n  function fps() {\n    return app.fps; // num\n  }\n\n  // get a base64 png image of canvas\n  // funcs [screenshot (.toDataURL canvas),  ]\n  function screenshot() {\n    return app.canvas.toDataURL();\n  }\n\n  // funcs [screenshot [(.toDataURL canvas)],\n  //        cursor - #(set! canvas -style -cursor (or % \"default\"))\n  //       ]\n  function cursor(c) {\n    if (c) {\n      app.canvas.style.cursor = c ? c : \"default\";\n    }\n    return app.canvas.style.cursor;\n  }\n\n  function run(f) {\n    const frame = t => {\n      const realTime = t / 1000;\n      const realDt = realTime - app.realTime;\n\n      app.realTime = realTime;\n\n      if (!app.skipTime) {\n        app.dt = realDt;\n        app.time += app.dt;\n        app.fpsBuf.push(1 / app.dt);\n        app.fpsTimer += app.dt;\n        if (app.fpsTimer >= 1) {\n          app.fpsTimer = 0;\n          app.fps = Math.round(\n            app.fpsBuf.reduce((a, b) => a + b) / app.fpsBuf.length\n          );\n          app.fpsBuf = [];\n        }\n      }\n\n      app.skipTime = false;\n\n      f();\n      // funcs [runx3, ]\n      for (const k in app.keyStates) {\n        app.keyStates[k] = processBtnState(app.keyStates[k]);\n      }\n\n      app.mouseState = processBtnState(app.mouseState);\n      app.charInputted = [];\n\n      if (!app.stopped) {\n        app.loopID = requestAnimationFrame(frame);\n      }\n    };\n\n    app.loopID = requestAnimationFrame(frame);\n  }\n\n  function quit() {\n    cancelAnimationFrame(app.loopID);\n    app.stopped = true;\n  }\n  // == **canvas** ==\n  // funcs  1. screenshot #(.toDataURL canvas)\n  //        2. cursor     #(set! canvas -style -cursor (or % \"default\"))\n  //        3. focused    #(= canvas (js-get document :activeElement))\n  //        4. focus      #(.focus canvas)\n  function focused() {\n    return document.activeElement === app.canvas;\n  }\n\n  function focus() {\n    app.canvas.focus();\n  }\n\n  // (8 + 4 + 3 + 1) 18 functions + 1 canvas context [ canvas.getContext(\"webgl\", {...}) ]\n  // TOTAL: 19\n  return {\n    gl,\n    // Pure functions\n    // 1. Event functions x 8\n    keyDown, // boolean  x 2 1. handleEvents, 2. context\n    keyPressed, // boolean  x 2 1. handleEvents, 2. context\n    keyPressedRep, // boolean  x 2 1. handleEvents, 2. context\n    keyReleased, // boolean  x 2 1. handleEvents, 2. context\n    mouseDown, // boolean  x 2 1. handleEvents, 2. context\n    mouseClicked, // boolean  x 3 1. handleEvents, 2. context, 3. area (component)\n    mouseReleased, // boolean  x 2 1. handleEvents, 2. context\n    charInputted, // string[] x 1 1. handleEvents\n    // 2. Other functions x 4\n    mousePos, // Vec2     x 2. 1. mouseFrame, mousePos\n    dt, // number   x 1. 1. dt\n    time, // number   x 1. 1. context\n    fps, // number   x 2. 1. debug. 2. drawObj. Note: used for debugging purpose\n    // 2.1 canvas functions x 3\n    screenshot, // string   x 1. 1. context\n    cursor, // string   x 1. 1. context\n    focused, // boolean  x 1. 1. context\n    // 2.2. Side effect function + context x 1\n    focus, // void     x 1  1. context\n    // 3. Side effect functions - 3\n    run, // void     x 1 -> 1. start : app.loopID = requestAnimationFrame(frame);\n    quit // void     x 1 -> 1. start : cancelAnimationFrame(app.loopID);\n  };\n}\n\nexport { appInit };\n"],
"names":["processBtnState","s","appInit","gconf","mousePos","app","clone","mouseClicked","mouseState","mouseDown","mouseReleased","keyPressed","k","keyStates","keyPressedRep","keyDown","keyReleased","charInputted","dt","time","fps","screenshot","canvas","toDataURL","cursor","c","style","run","f","frame","t","realTime","realDt","skipTime","fpsBuf","push","fpsTimer","Math","round","reduce","a","b","length","stopped","loopID","requestAnimationFrame","quit","cancelAnimationFrame","focused","document","activeElement","focus","createElement","appendChild","root","body","vec2","scale","isTouch","localStorage","setItem","JSON","stringify","console","log","keyMap","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","preventDefaultKeys","fullscreen","width","window","innerWidth","height","innerHeight","styles","crisp","join","setAttribute","gl","getContext","antialias","depth","stencil","alpha","preserveDrawingBuffer","navigator","maxTouchPoints","msMaxTouchPoints","addEventListener","e","offsetX","offsetY","touches","clientX","clientY","key","toLowerCase","includes","preventDefault","repeat","visibilityState","$jscomp$tmp$exports$module$name"]
}
