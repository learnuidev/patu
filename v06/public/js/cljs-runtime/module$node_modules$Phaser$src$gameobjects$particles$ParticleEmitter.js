shadow$provide.module$node_modules$Phaser$src$gameobjects$particles$ParticleEmitter=function(global,require,module,exports){var BlendModes=require("module$node_modules$Phaser$src$renderer$BlendModes");global=require("module$node_modules$Phaser$src$utils$Class");exports=require("module$node_modules$Phaser$src$gameobjects$components$index");var DeathZone=require("module$node_modules$Phaser$src$gameobjects$particles$zones$DeathZone"),EdgeZone=require("module$node_modules$Phaser$src$gameobjects$particles$zones$EdgeZone"),
EmitterOp=require("module$node_modules$Phaser$src$gameobjects$particles$EmitterOp"),GetFastValue=require("module$node_modules$Phaser$src$utils$object$GetFastValue"),GetRandom=require("module$node_modules$Phaser$src$utils$array$GetRandom"),HasAny=require("module$node_modules$Phaser$src$utils$object$HasAny"),HasValue=require("module$node_modules$Phaser$src$utils$object$HasValue"),Particle=require("module$node_modules$Phaser$src$gameobjects$particles$Particle"),RandomZone=require("module$node_modules$Phaser$src$gameobjects$particles$zones$RandomZone"),
Rectangle=require("module$node_modules$Phaser$src$geom$rectangle$Rectangle"),StableSort=require("module$node_modules$Phaser$src$utils$array$StableSort"),Vector2=require("module$node_modules$Phaser$src$math$Vector2"),Wrap=require("module$node_modules$Phaser$src$math$Wrap");require=new global({Mixins:[exports.BlendMode,exports.Mask,exports.ScrollFactor,exports.Visible],initialize:function(manager,config){this.manager=manager;this.texture=manager.texture;this.frames=[manager.defaultFrame];this.defaultFrame=
manager.defaultFrame;this.configFastMap="active blendMode collideBottom collideLeft collideRight collideTop deathCallback deathCallbackScope emitCallback emitCallbackScope follow frequency gravityX gravityY maxParticles name on particleBringToTop particleClass radial timeScale trackVisible visible".split(" ");this.configOpMap="accelerationX accelerationY angle alpha bounce delay lifespan maxVelocityX maxVelocityY moveToX moveToY quantity rotate scaleX scaleY speedX speedY tint x y".split(" ");this.name=
"";this.particleClass=Particle;this.x=new EmitterOp(config,"x",0);this.y=new EmitterOp(config,"y",0);this.radial=!0;this.gravityY=this.gravityX=0;this.acceleration=!1;this.accelerationX=new EmitterOp(config,"accelerationX",0,!0);this.accelerationY=new EmitterOp(config,"accelerationY",0,!0);this.maxVelocityX=new EmitterOp(config,"maxVelocityX",1E4,!0);this.maxVelocityY=new EmitterOp(config,"maxVelocityY",1E4,!0);this.speedX=new EmitterOp(config,"speedX",0,!0);this.speedY=new EmitterOp(config,"speedY",
0,!0);this.moveTo=!1;this.moveToX=new EmitterOp(config,"moveToX",0,!0);this.moveToY=new EmitterOp(config,"moveToY",0,!0);this.bounce=new EmitterOp(config,"bounce",0,!0);this.scaleX=new EmitterOp(config,"scaleX",1);this.scaleY=new EmitterOp(config,"scaleY",1);this.tint=new EmitterOp(config,"tint",4294967295);this.alpha=new EmitterOp(config,"alpha",1);this.lifespan=new EmitterOp(config,"lifespan",1E3);this.angle=new EmitterOp(config,"angle",{min:0,max:360});this.rotate=new EmitterOp(config,"rotate",
0);this.deathCallbackScope=this.deathCallback=this.emitCallbackScope=this.emitCallback=null;this.maxParticles=0;this.quantity=new EmitterOp(config,"quantity",1,!0);this.delay=new EmitterOp(config,"delay",0,!0);this.frequency=0;this.particleBringToTop=this.on=!0;this.timeScale=1;this.bounds=this.deathZone=this.emitZone=null;this.visible=this.active=this.collideBottom=this.collideTop=this.collideRight=this.collideLeft=!0;this.blendMode=BlendModes.NORMAL;this.follow=null;this.followOffset=new Vector2;
this.trackVisible=!1;this.currentFrame=0;this.randomFrame=!0;this.frameQuantity=1;this.dead=[];this.alive=[];this._frameCounter=this._counter=0;config&&this.fromJSON(config)},fromJSON:function(config){if(!config)return this;var i;for(i=0;i<this.configFastMap.length;i++){var key=this.configFastMap[i];HasValue(config,key)&&(this[key]=GetFastValue(config,key))}for(i=0;i<this.configOpMap.length;i++)key=this.configOpMap[i],HasValue(config,key)&&this[key].loadConfig(config);this.acceleration=0!==this.accelerationX.propertyValue||
0!==this.accelerationY.propertyValue;this.moveTo=0!==this.moveToX.propertyValue||0!==this.moveToY.propertyValue;HasValue(config,"speed")&&(this.speedX.loadConfig(config,"speed"),this.speedY=null);if(HasAny(config,["speedX","speedY"])||this.moveTo)this.radial=!1;HasValue(config,"scale")&&(this.scaleX.loadConfig(config,"scale"),this.scaleY=null);HasValue(config,"callbackScope")&&(this.deathCallbackScope=this.emitCallbackScope=i=GetFastValue(config,"callbackScope",null));HasValue(config,"emitZone")&&
this.setEmitZone(config.emitZone);HasValue(config,"deathZone")&&this.setDeathZone(config.deathZone);HasValue(config,"bounds")&&this.setBounds(config.bounds);HasValue(config,"followOffset")&&this.followOffset.setFromObject(GetFastValue(config,"followOffset",0));HasValue(config,"frame")&&this.setFrame(config.frame);return this},toJSON:function(output){void 0===output&&(output={});var i;for(i=0;i<this.configFastMap.length;i++){var key=this.configFastMap[i];output[key]=this[key]}for(i=0;i<this.configOpMap.length;i++)key=
this.configOpMap[i],this[key]&&(output[key]=this[key].toJSON());this.speedY||(delete output.speedX,output.speed=this.speedX.toJSON());this.scaleY||(delete output.scaleX,output.scale=this.scaleX.toJSON());return output},startFollow:function(target,offsetX,offsetY,trackVisible){void 0===offsetX&&(offsetX=0);void 0===offsetY&&(offsetY=0);void 0===trackVisible&&(trackVisible=!1);this.follow=target;this.followOffset.set(offsetX,offsetY);this.trackVisible=trackVisible;return this},stopFollow:function(){this.follow=
null;this.followOffset.set(0,0);this.trackVisible=!1;return this},getFrame:function(){if(1===this.frames.length)return this.defaultFrame;if(this.randomFrame)return GetRandom(this.frames);var frame=this.frames[this.currentFrame];this._frameCounter++;this._frameCounter===this.frameQuantity&&(this._frameCounter=0,this.currentFrame=Wrap(this.currentFrame+1,0,this._frameLength));return frame},setFrame:function(frames,pickRandom,quantity){void 0===pickRandom&&(pickRandom=!0);void 0===quantity&&(quantity=
1);this.randomFrame=pickRandom;this.frameQuantity=quantity;this._frameCounter=this.currentFrame=0;pickRandom=typeof frames;Array.isArray(frames)||"string"===pickRandom||"number"===pickRandom?this.manager.setEmitterFrames(frames,this):"object"===pickRandom&&(pickRandom=frames,(frames=GetFastValue(pickRandom,"frames",null))&&this.manager.setEmitterFrames(frames,this),this.randomFrame=GetFastValue(pickRandom,"cycle",!1)?!1:!0,this.frameQuantity=GetFastValue(pickRandom,"quantity",quantity));this._frameLength=
this.frames.length;1===this._frameLength&&(this.frameQuantity=1,this.randomFrame=!1);return this},setRadial:function(value){void 0===value&&(value=!0);this.radial=value;return this},setPosition:function(x,y){this.x.onChange(x);this.y.onChange(y);return this},setBounds:function(x,y,width,height){"object"===typeof x&&(height=x,x=height.x,y=height.y,width=HasValue(height,"w")?height.w:height.width,height=HasValue(height,"h")?height.h:height.height);this.bounds?this.bounds.setTo(x,y,width,height):this.bounds=
new Rectangle(x,y,width,height);return this},setSpeedX:function(value){this.speedX.onChange(value);this.radial=!1;return this},setSpeedY:function(value){this.speedY&&(this.speedY.onChange(value),this.radial=!1);return this},setSpeed:function(value){this.speedX.onChange(value);this.speedY=null;this.radial=!0;return this},setScaleX:function(value){this.scaleX.onChange(value);return this},setScaleY:function(value){this.scaleY.onChange(value);return this},setScale:function(value){this.scaleX.onChange(value);
this.scaleY=null;return this},setGravityX:function(value){this.gravityX=value;return this},setGravityY:function(value){this.gravityY=value;return this},setGravity:function(x,y){this.gravityX=x;this.gravityY=y;return this},setAlpha:function(value){this.alpha.onChange(value);return this},setEmitterAngle:function(value){this.angle.onChange(value);return this},setAngle:function(value){this.angle.onChange(value);return this},setLifespan:function(value){this.lifespan.onChange(value);return this},setQuantity:function(quantity){this.quantity.onChange(quantity);
return this},setFrequency:function(frequency,quantity){this.frequency=frequency;this._counter=0;if(quantity)this.quantity.onChange(quantity);return this},setEmitZone:function(zoneConfig){if(void 0===zoneConfig)this.emitZone=null;else{var type=GetFastValue(zoneConfig,"type","random"),source=GetFastValue(zoneConfig,"source",null);switch(type){case "random":this.emitZone=new RandomZone(source);break;case "edge":type=GetFastValue(zoneConfig,"quantity",1);var stepRate=GetFastValue(zoneConfig,"stepRate",
0),yoyo=GetFastValue(zoneConfig,"yoyo",!1);zoneConfig=GetFastValue(zoneConfig,"seamless",!0);this.emitZone=new EdgeZone(source,type,stepRate,yoyo,zoneConfig)}}return this},setDeathZone:function(zoneConfig){if(void 0===zoneConfig)this.deathZone=null;else{var type=GetFastValue(zoneConfig,"type","onEnter");(zoneConfig=GetFastValue(zoneConfig,"source",null))&&"function"===typeof zoneConfig.contains&&(this.deathZone=new DeathZone(zoneConfig,"onEnter"===type?!0:!1))}return this},reserve:function(particleCount){for(var dead=
this.dead,i=0;i<particleCount;i++)dead.push(new this.particleClass(this));return this},getAliveParticleCount:function(){return this.alive.length},getDeadParticleCount:function(){return this.dead.length},getParticleCount:function(){return this.getAliveParticleCount()+this.getDeadParticleCount()},atLimit:function(){return 0<this.maxParticles&&this.getParticleCount()===this.maxParticles},onParticleEmit:function(callback,context){void 0===callback?this.emitCallbackScope=this.emitCallback=null:"function"===
typeof callback&&(this.emitCallback=callback,context&&(this.emitCallbackScope=context));return this},onParticleDeath:function(callback,context){void 0===callback?this.deathCallbackScope=this.deathCallback=null:"function"===typeof callback&&(this.deathCallback=callback,context&&(this.deathCallbackScope=context));return this},killAll:function(){for(var dead=this.dead,alive=this.alive;0<alive.length;)dead.push(alive.pop());return this},forEachAlive:function(callback,context){for(var alive=this.alive,
length=alive.length,index=0;index<length;++index)callback.call(context,alive[index],this);return this},forEachDead:function(callback,context){for(var dead=this.dead,length=dead.length,index=0;index<length;++index)callback.call(context,dead[index],this);return this},start:function(){this.on=!0;this._counter=0;return this},stop:function(){this.on=!1;return this},pause:function(){this.active=!1;return this},resume:function(){this.active=!0;return this},depthSort:function(){StableSort.inplace(this.alive,
this.depthSortCallback);return this},flow:function(frequency,count){void 0===count&&(count=1);this.frequency=frequency;this.quantity.onChange(count);return this.start()},explode:function(count,x,y){this.frequency=-1;return this.emitParticle(count,x,y)},emitParticleAt:function(x,y,count){return this.emitParticle(count,x,y)},emitParticle:function(count,x,y){if(!this.atLimit()){void 0===count&&(count=this.quantity.onEmit());for(var dead=this.dead,i=0;i<count;i++){var particle=0<dead.length?dead.pop():
new this.particleClass(this);particle.fire(x,y);this.particleBringToTop?this.alive.push(particle):this.alive.unshift(particle);this.emitCallback&&this.emitCallback.call(this.emitCallbackScope,particle,this);if(this.atLimit())break}return particle}},preUpdate:function(time,delta){delta*=this.timeScale;var step=delta/1E3;this.trackVisible&&(this.visible=this.follow.visible);var processors=this.manager.getProcessors();time=this.alive;for(var length=time.length,index=0;index<length;index++){var particle=
time[index];if(particle.update(delta,step,processors)){var last=time[length-1];time[length-1]=particle;time[index]=last;--index;--length}}step=time.length-length;if(0<step){step=time.splice(time.length-step,step);processors=this.deathCallback;length=this.deathCallbackScope;if(processors)for(index=0;index<step.length;index++)processors.call(length,step[index]);this.dead.concat(step);StableSort.inplace(time,this.indexSortCallback)}this.on&&(0===this.frequency?this.emitParticle():0<this.frequency&&(this._counter-=
delta,0>=this._counter&&(this.emitParticle(),this._counter=this.frequency-Math.abs(this._counter))))},depthSortCallback:function(a,b){return a.y-b.y},indexSortCallback:function(a,b){return a.index-b.index}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$gameobjects$particles$ParticleEmitter.js.map
