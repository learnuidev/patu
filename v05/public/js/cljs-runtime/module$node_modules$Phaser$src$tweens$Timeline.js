shadow$provide.module$node_modules$Phaser$src$tweens$Timeline=function(global,require,module,exports){global=require("module$node_modules$Phaser$src$utils$Class");var EventEmitter=require("module$node_modules$eventemitter3$index"),TweenBuilder=require("module$node_modules$Phaser$src$tweens$builders$TweenBuilder"),TWEEN_CONST=require("module$node_modules$Phaser$src$tweens$tween$const"),Timeline=new global({Extends:EventEmitter,initialize:function(manager){EventEmitter.call(this);this.manager=manager;
this.isTimeline=!0;this.data=[];this.totalData=0;this.useFrames=!1;this.timeScale=1;this.countdown=this.completeDelay=this.loopCounter=this.loopDelay=this.loop=0;this._pausedState=this.state=TWEEN_CONST.PENDING_ADD;this.paused=!1;this.totalProgress=this.totalDuration=this.progress=this.duration=this.totalElapsed=this.elapsed=0;this.callbacks={onComplete:null,onLoop:null,onStart:null,onUpdate:null,onYoyo:null};this.callbackScope},setTimeScale:function(value){this.timeScale=value;return this},getTimeScale:function(){return this.timeScale},
isPlaying:function(){return this.state===TWEEN_CONST.ACTIVE},add:function(config){return this.queue(TweenBuilder(this,config))},queue:function(tween){this.isPlaying()||(tween.parent=this,tween.parentIsTimeline=!0,this.data.push(tween),this.totalData=this.data.length);return this},hasOffset:function(tween){return null!==tween.offset},isOffsetAbsolute:function(value){return"number"===typeof value},isOffsetRelative:function(value){return"string"===typeof value&&(value=value[0],"-"===value||"+"===value)?
!0:!1},getRelativeOffset:function(value,base){var op=value[0];value=parseFloat(value.substr(2));switch(op){case "+":base+=value;break;case "-":base-=value}return Math.max(0,base)},calcDuration:function(){for(var prevEnd=0,totalDuration=0,offsetDuration=0,i=0;i<this.totalData;i++){var tween=this.data[i];tween.init();this.hasOffset(tween)?this.isOffsetAbsolute(tween.offset)?(tween.calculatedOffset=tween.offset,0===tween.offset&&(offsetDuration=0)):this.isOffsetRelative(tween.offset)&&(tween.calculatedOffset=
this.getRelativeOffset(tween.offset,prevEnd)):tween.calculatedOffset=offsetDuration;prevEnd=tween.totalDuration+tween.calculatedOffset;totalDuration+=tween.totalDuration;offsetDuration+=tween.totalDuration}this.duration=totalDuration;this.loopCounter=-1===this.loop?999999999999:this.loop;this.totalDuration=0<this.loopCounter?this.duration+this.completeDelay+(this.duration+this.loopDelay)*this.loopCounter:this.duration+this.completeDelay},init:function(){this.calcDuration();this.totalProgress=this.progress=
0;return this.paused?(this.state=TWEEN_CONST.PAUSED,!1):!0},resetTweens:function(resetFromLoop){for(var i=0;i<this.totalData;i++)this.data[i].play(resetFromLoop)},setCallback:function(type,callback,params,scope){-1!==Timeline.TYPES.indexOf(type)&&(this.callbacks[type]={func:callback,scope:scope,params:params});return this},makeActive:function(tween){return this.manager.makeActive(tween)},play:function(){if(this.state!==TWEEN_CONST.ACTIVE)if(this.paused)this.paused=!1,this.manager.makeActive(this);
else{this.resetTweens(!1);this.state=TWEEN_CONST.ACTIVE;var onStart=this.callbacks.onStart;onStart&&onStart.func.apply(onStart.scope,onStart.params);this.emit("start",this)}},nextState:function(){if(0<this.loopCounter){this.progress=this.elapsed=0;this.loopCounter--;var onLoop=this.callbacks.onLoop;onLoop&&onLoop.func.apply(onLoop.scope,onLoop.params);this.emit("loop",this,this.loopCounter);this.resetTweens(!0);0<this.loopDelay?(this.countdown=this.loopDelay,this.state=TWEEN_CONST.LOOP_DELAY):this.state=
TWEEN_CONST.ACTIVE}else 0<this.completeDelay?(this.countdown=this.completeDelay,this.state=TWEEN_CONST.COMPLETE_DELAY):((onLoop=this.callbacks.onComplete)&&onLoop.func.apply(onLoop.scope,onLoop.params),this.emit("complete",this),this.state=TWEEN_CONST.PENDING_REMOVE)},update:function(timestamp,delta){if(this.state!==TWEEN_CONST.PAUSED){var rawDelta=delta;this.useFrames&&(delta=1*this.manager.timeScale);delta*=this.timeScale;this.elapsed+=delta;this.progress=Math.min(this.elapsed/this.duration,1);
this.totalElapsed+=delta;this.totalProgress=Math.min(this.totalElapsed/this.totalDuration,1);switch(this.state){case TWEEN_CONST.ACTIVE:delta=this.totalData;for(var i=0;i<this.totalData;i++)this.data[i].update(timestamp,rawDelta)&&delta--;(timestamp=this.callbacks.onUpdate)&&timestamp.func.apply(timestamp.scope,timestamp.params);this.emit("update",this);0===delta&&this.nextState();break;case TWEEN_CONST.LOOP_DELAY:this.countdown-=delta;0>=this.countdown&&(this.state=TWEEN_CONST.ACTIVE);break;case TWEEN_CONST.COMPLETE_DELAY:this.countdown-=
delta,0>=this.countdown&&((timestamp=this.callbacks.onComplete)&&timestamp.func.apply(timestamp.scope,timestamp.params),this.emit("complete",this),this.state=TWEEN_CONST.PENDING_REMOVE)}return this.state===TWEEN_CONST.PENDING_REMOVE}},stop:function(){this.state=TWEEN_CONST.PENDING_REMOVE},pause:function(){if(this.state!==TWEEN_CONST.PAUSED)return this.paused=!0,this._pausedState=this.state,this.state=TWEEN_CONST.PAUSED,this.emit("pause",this),this},resume:function(){this.state===TWEEN_CONST.PAUSED&&
(this.paused=!1,this.state=this._pausedState);this.emit("resume",this);return this},hasTarget:function(target){for(var i=0;i<this.data.length;i++)if(this.data[i].hasTarget(target))return!0;return!1},destroy:function(){for(var i=0;i<this.data.length;i++)this.data[i].stop()}});Timeline.TYPES=["onStart","onUpdate","onLoop","onComplete","onYoyo"];module.exports=Timeline}
//# sourceMappingURL=module$node_modules$Phaser$src$tweens$Timeline.js.map
