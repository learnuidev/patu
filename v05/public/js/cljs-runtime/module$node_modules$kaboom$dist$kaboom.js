var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(arrayStrings){return arrayStrings.raw=arrayStrings};$jscomp.createTemplateTagFirstArgWithRaw=function(arrayStrings,rawArrayStrings){arrayStrings.raw=rawArrayStrings;return arrayStrings};$jscomp.arrayIteratorImpl=function(array){var index=0;return function(){return index<array.length?{done:!1,value:array[index++]}:{done:!0}}};$jscomp.arrayIterator=function(array){return{next:$jscomp.arrayIteratorImpl(array)}};
$jscomp.makeIterator=function(iterable){var iteratorFunction="undefined"!=typeof Symbol&&Symbol.iterator&&iterable[Symbol.iterator];return iteratorFunction?iteratorFunction.call(iterable):$jscomp.arrayIterator(iterable)};$jscomp.arrayFromIterator=function(iterator){for(var i,arr=[];!(i=iterator.next()).done;)arr.push(i.value);return arr};$jscomp.arrayFromIterable=function(iterable){return iterable instanceof Array?iterable:$jscomp.arrayFromIterator($jscomp.makeIterator(iterable))};
shadow$provide.module$node_modules$kaboom$dist$kaboom=function(global,require,module,exports){(function(){function nt(t){return t*Math.PI/180}function rt(t){return 180*t/Math.PI}function ae(t,e,o){return e>o?ae(t,o,e):Math.min(Math.max(t,e),o)}function De(t,e,o){return t+(e-t)*o}function ve(t,e,o,i,m){return i+(t-e)/(o-e)*(m-i)}function st(t,e,o,i,m){return ae(ve(t,e,o,i,m),i,m)}function f(t){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-
0]=arguments[$jscomp$restIndex];if(0===$jscomp$restParams.length)return f(0,0);if(1===$jscomp$restParams.length){if("number"==typeof $jscomp$restParams[0])return f($jscomp$restParams[0],$jscomp$restParams[0]);if(Re($jscomp$restParams[0]))return f($jscomp$restParams[0].x,$jscomp$restParams[0].y);if(Array.isArray($jscomp$restParams[0])&&2===$jscomp$restParams[0].length)return f.apply(null,$jscomp$restParams[0])}return{x:$jscomp$restParams[0],y:$jscomp$restParams[1],clone:function(){return f(this.x,
this.y)},add:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));return f(this.x+$jscomp$restParams.x,this.y+$jscomp$restParams.y)},sub:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-
0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));return f(this.x-$jscomp$restParams.x,this.y-$jscomp$restParams.y)},scale:function(e){return f(this.x*e,this.y*e)},dist:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));return Math.sqrt((this.x-
$jscomp$restParams.x)*(this.x-$jscomp$restParams.x)+(this.y-$jscomp$restParams.y)*(this.y-$jscomp$restParams.y))},len:function(){return this.dist(f(0,0))},unit:function(){return this.scale(1/this.len())},normal:function(){return f(this.y,-this.x)},dot:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));
return f(this.x*$jscomp$restParams.x,this.y*$jscomp$restParams.y)},angle:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));return Math.atan2(this.y-$jscomp$restParams.y,this.x-$jscomp$restParams.x)},lerp:function(e,o){return f(De(this.x,e.x,o),De(this.y,e.y,o))},eq:function(e){return this.x===
e.x&&this.y===e.y},str:function(){return"("+this.x+", "+this.y+")"}}}function ot(t){return f(Math.cos(t),Math.sin(t))}function Te(t,e,o){return{x:t,y:e,z:o,xy:function(){return f(this.x,this.y)}}}function Re(t){return void 0!==t&&void 0!==t.x&&void 0!==t.y}function it(t){return void 0!==t&&void 0!==t.x&&void 0!==t.y&&void 0!==t.z}function ye(t){return void 0!==t&&void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&void 0!==t.a}function at(t){if(void 0!==t&&Array.isArray(t.m)&&16===t.m.length)return t}function Ve(t){for(var $jscomp$restParams=
[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];if(0===$jscomp$restParams.length)return Y();if(1===$jscomp$restParams.length){if(ye($jscomp$restParams[0]))return Y($jscomp$restParams[0]);if(Array.isArray($jscomp$restParams[0])&&3===$jscomp$restParams[0].length)return Ve.apply(null,$jscomp$restParams[0])}return Y($jscomp$restParams[0],$jscomp$restParams[1],$jscomp$restParams[2],1)}function Y(t){for(var $jscomp$restParams=
[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];var e;if(0===$jscomp$restParams.length)return Y(1,1,1,1);if(1===$jscomp$restParams.length){if(ye($jscomp$restParams[0]))return Y($jscomp$restParams[0].r,$jscomp$restParams[0].g,$jscomp$restParams[0].b,$jscomp$restParams[0].a);if(Array.isArray($jscomp$restParams[0])&&4===$jscomp$restParams[0].length)return Y.apply(null,$jscomp$restParams[0])}return{r:$jscomp$restParams[0],
g:$jscomp$restParams[1],b:$jscomp$restParams[2],a:null!=(e=$jscomp$restParams[3])?e:1,clone:function(){return Y(this.r,this.g,this.b,this.a)},lighten:function(o){return Y(this.r+o,this.g+o,this.b+o,this.a)},darken:function(o){return this.lighten(-o)},invert:function(){return Y(1-this.r,1-this.g,1-this.b,this.a)},isDark:function(o){return this.r+this.g+this.b<3*(void 0===o?.5:o)},isLight:function(o){return this.r+this.g+this.b>3*(void 0===o?.5:o)},eq:function(o){return this.r===o.r&&this.g===o.g&&
this.b===o.g&&this.a===o.a}}}function oe(t,e,o,i){return{x:t,y:e,w:o,h:i,clone:function(){return oe(this.x,this.y,this.w,this.h)},eq:function(m){return this.x===m.x&&this.y===m.y&&this.w===m.w&&this.h===m.h}}}function ee(t){return{m:t?[].concat($jscomp.arrayFromIterable(t)):[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],clone:function(){return ee(this.m)},mult:function(e){for(var o=[],i=0;4>i;i++)for(var m=0;4>m;m++)o[4*i+m]=this.m[0+m]*e.m[4*i]+this.m[4+m]*e.m[4*i+1]+this.m[8+m]*e.m[4*i+2]+this.m[12+m]*e.m[4*
i+3];return ee(o)},multVec4:function(e){return{x:e.x*this.m[0]+e.y*this.m[4]+e.z*this.m[8]+e.w*this.m[12],y:e.x*this.m[1]+e.y*this.m[5]+e.z*this.m[9]+e.w*this.m[13],z:e.x*this.m[2]+e.y*this.m[6]+e.z*this.m[10]+e.w*this.m[14],w:e.x*this.m[3]+e.y*this.m[7]+e.z*this.m[11]+e.w*this.m[15]}},multVec3:function(e){e=this.multVec4({x:e.x,y:e.y,z:e.z,w:1});return Te(e.x,e.y,e.z)},multVec2:function(e){return f(e.x*this.m[0]+e.y*this.m[4]+0*this.m[8]+1*this.m[12],e.x*this.m[1]+e.y*this.m[5]+0*this.m[9]+1*this.m[13])},
translate:function(e){return this.mult(ee([1,0,0,0,0,1,0,0,0,0,1,0,e.x,e.y,0,1]))},scale:function(e){return this.mult(ee([e.x,0,0,0,0,e.y,0,0,0,0,1,0,0,0,0,1]))},rotateX:function(e){return this.mult(ee([1,0,0,0,0,Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1]))},rotateY:function(e){return this.mult(ee([Math.cos(e),0,-Math.sin(e),0,0,1,0,0,Math.sin(e),0,Math.cos(e),0,0,0,0,1]))},rotateZ:function(e){return this.mult(ee([Math.cos(e),-Math.sin(e),0,0,Math.sin(e),Math.cos(e),0,0,0,0,1,
0,0,0,0,1]))},invert:function(){var e=[],o=this.m[10]*this.m[15]-this.m[14]*this.m[11],i=this.m[9]*this.m[15]-this.m[13]*this.m[11],m=this.m[9]*this.m[14]-this.m[13]*this.m[10],v=this.m[8]*this.m[15]-this.m[12]*this.m[11],A=this.m[8]*this.m[14]-this.m[12]*this.m[10],R=this.m[8]*this.m[13]-this.m[12]*this.m[9],$=this.m[6]*this.m[15]-this.m[14]*this.m[7],k=this.m[5]*this.m[15]-this.m[13]*this.m[7],I=this.m[5]*this.m[14]-this.m[13]*this.m[6],j=this.m[4]*this.m[15]-this.m[12]*this.m[7],T=this.m[4]*this.m[14]-
this.m[12]*this.m[6],w=this.m[5]*this.m[15]-this.m[13]*this.m[7],S=this.m[4]*this.m[13]-this.m[12]*this.m[5],U=this.m[6]*this.m[11]-this.m[10]*this.m[7],B=this.m[5]*this.m[11]-this.m[9]*this.m[7],_=this.m[5]*this.m[10]-this.m[9]*this.m[6],G=this.m[4]*this.m[11]-this.m[8]*this.m[7],y=this.m[4]*this.m[10]-this.m[8]*this.m[6],H=this.m[4]*this.m[9]-this.m[8]*this.m[5];e[0]=this.m[5]*o-this.m[6]*i+this.m[7]*m;e[4]=-(this.m[4]*o-this.m[6]*v+this.m[7]*A);e[8]=this.m[4]*i-this.m[5]*v+this.m[7]*R;e[12]=-(this.m[4]*
m-this.m[5]*A+this.m[6]*R);e[1]=-(this.m[1]*o-this.m[2]*i+this.m[3]*m);e[5]=this.m[0]*o-this.m[2]*v+this.m[3]*A;e[9]=-(this.m[0]*i-this.m[1]*v+this.m[3]*R);e[13]=this.m[0]*m-this.m[1]*A+this.m[2]*R;e[2]=this.m[1]*$-this.m[2]*k+this.m[3]*I;e[6]=-(this.m[0]*$-this.m[2]*j+this.m[3]*T);e[10]=this.m[0]*w-this.m[1]*j+this.m[3]*S;e[14]=-(this.m[0]*I-this.m[1]*T+this.m[2]*S);e[3]=-(this.m[1]*U-this.m[2]*B+this.m[3]*_);e[7]=this.m[0]*U-this.m[2]*G+this.m[3]*y;e[11]=-(this.m[0]*B-this.m[1]*G+this.m[3]*H);e[15]=
this.m[0]*_-this.m[1]*y+this.m[2]*H;o=this.m[0]*e[0]+this.m[1]*e[4]+this.m[2]*e[8]+this.m[3]*e[12];for(i=0;4>i;i++)for(m=0;4>m;m++)e[4*i+m]*=1/o;return ee(e)}}}function ut(t,e,o){return t+(Math.sin(o)+1)/2*(e-t)}function Xe(t){return{seed:t,gen:function(e){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];if(0===$jscomp$restParams.length)return this.seed=(rn*this.seed+sn)%ct,
this.seed/ct;if(1===$jscomp$restParams.length){if("number"==typeof $jscomp$restParams[0])return this.gen(0,$jscomp$restParams[0]);if(Re($jscomp$restParams[0]))return this.gen(f(0,0),$jscomp$restParams[0]);if(ye($jscomp$restParams[0]))return this.gen(Y(0,0,0,0),$jscomp$restParams[0])}else if(2===$jscomp$restParams.length){if("number"==typeof $jscomp$restParams[0]&&"number"==typeof $jscomp$restParams[1])return this.gen()*($jscomp$restParams[1]-$jscomp$restParams[0])+$jscomp$restParams[0];if(Re($jscomp$restParams[0])&&
Re($jscomp$restParams[1]))return f(this.gen($jscomp$restParams[0].x,$jscomp$restParams[1].x),this.gen($jscomp$restParams[0].y,$jscomp$restParams[1].y));if(ye($jscomp$restParams[0])&&ye($jscomp$restParams[1]))return Y(this.gen($jscomp$restParams[0].r,$jscomp$restParams[1].r),this.gen($jscomp$restParams[0].g,$jscomp$restParams[1].g),this.gen($jscomp$restParams[0].b,$jscomp$restParams[1].b),this.gen($jscomp$restParams[0].a,$jscomp$restParams[1].a))}}}}function ft(t){dt.seed=t}function Pe(t){for(var $jscomp$restParams=
[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];return dt.gen.apply(dt,$jscomp.arrayFromIterable($jscomp$restParams))}function ht(t){return Pe()<=t}function mt(t){return t[Math.floor(Pe(t.length))]}function Ye(t,e){return t.p2.x>=e.p1.x&&t.p1.x<=e.p2.x&&t.p2.y>=e.p1.y&&t.p1.y<=e.p2.y}function lt(t,e){return t.p2.x>e.p1.x&&t.p1.x<e.p2.x&&t.p2.y>e.p1.y&&t.p1.y<e.p2.y}function pt(t,e){return e.x>=t.p1.x&&
e.x<=t.p2.x&&e.y>=t.p1.y&&e.y<t.p2.y}function $e(t,e){var o=typeof t,i=typeof e;if(o!==i)return!1;if("object"===o&&"object"===i){o=Object.keys(t);i=Object.keys(e);if(o.length!==i.length)return!1;o=$jscomp.makeIterator(o);for(i=o.next();!i.done;i=o.next()){var A=i.value;i=t[A];A=e[A];if(("function"!=typeof i||"function"!=typeof A)&&!$e(i,A))return!1}return!0}return t===e}function Le(t){switch(t){case "topleft":return f(-1,-1);case "top":return f(0,-1);case "topright":return f(1,-1);case "left":return f(-1,
0);case "center":return f(0,0);case "right":return f(1,0);case "botleft":return f(-1,1);case "bot":return f(0,1);case "botright":return f(1,1);default:return t}}function xt(t,e){function m(h){return 0==Math.log(h)/Math.log(2)%1}function v(h){var x=t.createTexture();t.bindTexture(t.TEXTURE_2D,x);t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,h);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,o);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,o);var b=m(h.width)&&m(h.height)?t.REPEAT:
t.CLAMP_TO_EDGE;return t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,b),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,b),t.bindTexture(t.TEXTURE_2D,null),{width:h.width,height:h.height,bind:function(){t.bindTexture(t.TEXTURE_2D,x)},unbind:function(){t.bindTexture(t.TEXTURE_2D,null)}}}function A(h,x){h=void 0===h?We:h;x=void 0===x?Ke:x;h=on.replace("{{user}}",null!=h?h:We);var z=an.replace("{{user}}",null!=x?x:Ke);x=t.createShader(t.VERTEX_SHADER);var K=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(x,
h),t.shaderSource(K,z),t.compileShader(x),t.compileShader(K),h=t.getShaderInfoLog(x))throw Error(h);if(h=t.getShaderInfoLog(K))throw Error(h);var C=t.createProgram();if(t.attachShader(C,x),t.attachShader(C,K),t.bindAttribLocation(C,0,"a_pos"),t.bindAttribLocation(C,1,"a_uv"),t.bindAttribLocation(C,2,"a_color"),t.linkProgram(C),(h=t.getProgramInfoLog(C))&&"\n"!==h)throw Error(h);return{bind:function(){t.useProgram(C)},unbind:function(){t.useProgram(null)},bindAttribs:function(){t.vertexAttribPointer(0,
3,t.FLOAT,!1,4*Ie,0);t.enableVertexAttribArray(0);t.vertexAttribPointer(1,2,t.FLOAT,!1,4*Ie,12);t.enableVertexAttribArray(1);t.vertexAttribPointer(2,4,t.FLOAT,!1,4*Ie,20);t.enableVertexAttribArray(2)},send:function(P){this.bind();for(var X in P){var F=P[X],Z=t.getUniformLocation(C,X);"number"==typeof F?t.uniform1f(Z,F):at(F)?t.uniformMatrix4fv(Z,!1,new Float32Array(F.m)):ye(F)?t.uniform4f(Z,F.r,F.g,F.b,F.a):it(F)?t.uniform3f(Z,F.x,F.y,F.z):Re(F)&&t.uniform2f(Z,F.x,F.y)}this.unbind()}}}function R(h,
x,b,L){x=h.width/x;var K=1/x;b=1/(h.height/b);var P={};L=L.split("").entries();L=$jscomp.makeIterator(L);for(var $jscomp$key$=L.next();!$jscomp$key$.done;$jscomp$key$=L.next()){var $jscomp$destructuring$var1=$jscomp.makeIterator($jscomp$key$.value);$jscomp$key$=$jscomp$destructuring$var1.next().value;$jscomp$destructuring$var1=$jscomp$destructuring$var1.next().value;P[$jscomp$destructuring$var1]=f($jscomp$key$%x*K,Math.floor($jscomp$key$/x)*b)}return{tex:h,map:P,qw:K,qh:b}}function $(h,x,b,L,z){b=
void 0===b?i.defTex:b;L=void 0===L?i.defProg:L;z=void 0===z?{}:z;b=null!=b?b:i.defTex;L=null!=L?L:i.defProg;(b!==i.curTex||L!==i.curProg||!$e(i.curUniform,z)||i.vqueue.length+h.length*Ie>Ne||i.iqueue.length+x.length>Ne)&&k();i.curTex=b;i.curProg=L;i.curUniform=z;x=x.map(function(C){return C+i.vqueue.length/Ie});h=h.map(function(C){var P=w(i.transform.multVec2(C.pos.xy()));return[P.x,P.y,C.pos.z,C.uv.x,C.uv.y,C.color.r,C.color.g,C.color.b,C.color.a]}).flat();x.forEach(function(C){return i.iqueue.push(C)});
h.forEach(function(C){return i.vqueue.push(C)})}function k(){i.curTex&&i.curProg&&0!==i.vqueue.length&&0!==i.iqueue.length&&(i.curProg.send(i.curUniform),t.bindBuffer(t.ARRAY_BUFFER,i.vbuf),t.bufferSubData(t.ARRAY_BUFFER,0,new Float32Array(i.vqueue)),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.ibuf),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,new Uint16Array(i.iqueue)),i.curProg.bind(),i.curProg.bindAttribs(),i.curTex.bind(),t.drawElements(t.TRIANGLES,i.iqueue.length,t.UNSIGNED_SHORT,0),i.curTex.unbind(),
i.curProg.unbind(),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),i.iqueue=[],i.vqueue=[],i.drawCalls++)}function I(){t.clear(t.COLOR_BUFFER_BIT);e.clearColor||q({width:he(),height:pe(),quad:oe(0,0,he()*be()/yt,pe()*be()/yt),tex:i.bgTex});i.drawCalls=0;i.transformStack=[];i.transform=ee()}function j(){k();i.lastDrawCalls=i.drawCalls}function T(){return i.lastDrawCalls}function w(h){return f(h.x/he()*2-1,-h.y/pe()*2+1)}function S(h){i.transform=h.clone()}function U(h){!h||
0===h.x&&0===h.y||(i.transform=i.transform.translate(h))}function B(h){!h||1===h.x&&1===h.y||(i.transform=i.transform.scale(h))}function y(h){!h||(i.transform=i.transform.rotateZ(h))}function H(){i.transformStack.push(i.transform.clone())}function M(){0<i.transformStack.length&&(i.transform=i.transformStack.pop())}function q(h){h=void 0===h?{}:h;var Z,re,x=h.width||0,b=h.height||0,L=h.pos||f(0,0),V=Le(h.origin||He).dot(f(x,b).scale(-.5)),K=f(null!=(Z=h.scale)?Z:1);Z=h.rot||0;var P=h.quad||oe(0,0,
1,1),X=1-(null!=(re=h.z)?re:0);re=h.color||Y(1,1,1,1);H();U(L);B(K);y(Z);U(V);$([{pos:Te(-x/2,b/2,X),uv:f(P.x,P.y+P.h),color:re},{pos:Te(-x/2,-b/2,X),uv:f(P.x,P.y),color:re},{pos:Te(x/2,-b/2,X),uv:f(P.x+P.w,P.y),color:re},{pos:Te(x/2,b/2,X),uv:f(P.x+P.w,P.y+P.h),color:re}],[0,1,3,1,2,3],h.tex,h.prog,h.uniform);M()}function J(h,x){x=void 0===x?{}:x;var V,b=null!=(V=x.quad)?V:oe(0,0,1,1);V=h.width*b.w;var z=h.height*b.h;q(we(le({},x),{tex:h,quad:b,width:V,height:z}))}function E(h,x,b,L){L=void 0===
L?{}:L;q(we(le({},L),{pos:h,width:x,height:b}))}function O(h,x,b,L){L=void 0===L?{}:L;var z=Le(L.origin||He).dot(f(x,b)).scale(.5),V=h.add(f(-x/2,-b/2)).sub(z),K=h.add(f(-x/2,b/2)).sub(z),C=h.add(f(x/2,b/2)).sub(z);h=h.add(f(x/2,-b/2)).sub(z);te(V,K,L);te(K,C,L);te(C,h,L);te(h,V,L)}function te(h,x,b){b=void 0===b?{}:b;var L=b.width||1,z=h.dist(x),V=Math.PI/2-h.angle(x);q(we(le({},b),{pos:h.add(x).scale(.5),width:L,height:z,rot:V,origin:"center"}))}function ne(h,x,b){b=void 0===b?{}:b;var L=(h+"").split("");
h=x.qw*x.tex.width;var V=x.qh*x.tex.height,C=f((b.size||V)/V).dot(f(b.scale||1)),P=C.x*h,X=C.y*V;h=0;V=X;var re=0,ge=[[]];L=$jscomp.makeIterator(L);for(var $jscomp$key$ie=L.next();!$jscomp$key$ie.done;$jscomp$key$ie=L.next())$jscomp$key$ie=$jscomp$key$ie.value,("\n"===$jscomp$key$ie||b.width&&h+P>b.width)&&(V+=X,h=0,ge.push([])),"\n"!==$jscomp$key$ie&&(ge[ge.length-1].push($jscomp$key$ie),h+=P),re=Math.max(re,h);b.width&&(re=b.width);var Fe=[],Ge=f(b.pos||0),se=Le(b.origin||He).scale(.5),me=-se.x*
P-(se.x+.5)*(re-P),Ce=-se.y*X-(se.y+.5)*(V-X);return ge.forEach(function(ie,Ue){var Me=(re-ie.length*P)*(se.x+.5);ie.forEach(function(Ae,Be){var _e=x.map[Ae];Be*=P;var qe=Ue*X;_e&&Fe.push({tex:x.tex,quad:oe(_e.x,_e.y,x.qw,x.qh),ch:Ae,pos:f(Ge.x+Be+me+Me,Ge.y+qe+Ce),color:b.color,origin:b.origin,scale:C,z:b.z})})}),{width:re,height:V,chars:Fe}}function ue(h,x,b){b=void 0===b?{}:b;ce(ne(h,x,b))}function ce(h){h=$jscomp.makeIterator(h.chars);for(var $jscomp$key$x=h.next();!$jscomp$key$x.done;$jscomp$key$x=
h.next())$jscomp$key$x=$jscomp$key$x.value,q({tex:$jscomp$key$x.tex,width:$jscomp$key$x.tex.width*$jscomp$key$x.quad.w,height:$jscomp$key$x.tex.height*$jscomp$key$x.quad.h,pos:$jscomp$key$x.pos,scale:$jscomp$key$x.scale,color:$jscomp$key$x.color,quad:$jscomp$key$x.quad,origin:"center",z:$jscomp$key$x.z})}function he(){return t.drawingBufferWidth/be()}function pe(){return t.drawingBufferHeight/be()}function be(){var h;return null!=(h=e.scale)?h:1}function Ee(){return i.clearColor.clone()}var o=function(){switch(e.texFilter){case "linear":return t.LINEAR;
case "nearest":return t.NEAREST;default:return t.NEAREST}}(),i=function(){var K,h=A(We,Ke),x=v(new ImageData(new Uint8ClampedArray([255,255,255,255]),1,1)),b=null!=(K=e.clearColor)?K:Y(0,0,0,1);t.clearColor(b.r,b.g,b.b,b.a);t.enable(t.BLEND);t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);K=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,K);t.bufferData(t.ARRAY_BUFFER,4*Ne,t.DYNAMIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,null);var z=t.createBuffer();t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,
z);t.bufferData(t.ELEMENT_ARRAY_BUFFER,2*Ne,t.DYNAMIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var V=v(new ImageData(new Uint8ClampedArray([128,128,128,255,190,190,190,255,190,190,190,255,128,128,128,255]),2,2));return{drawCalls:0,lastDrawCalls:0,defProg:h,curProg:h,defTex:x,curTex:x,curUniform:{},vbuf:K,ibuf:z,vqueue:[],iqueue:[],transform:ee(),transformStack:[],clearColor:b,bgTex:V}}();I();j();r(m,"powerOfTwo");r(v,"makeTex");r(A,"makeProgram");r(R,"makeFont");r($,"drawRaw");r(k,"flush");
r(I,"frameStart");r(j,"frameEnd");r(T,"drawCalls");r(w,"toNDC");r(S,"pushMatrix");r(U,"pushTranslate");r(B,"pushScale");r(function(h){!h||(i.transform=i.transform.rotateX(h))},"pushRotateX");r(function(h){!h||(i.transform=i.transform.rotateY(h))},"pushRotateY");r(y,"pushRotateZ");r(H,"pushTransform");r(M,"popTransform");r(q,"drawQuad");r(J,"drawTexture");r(E,"drawRect");r(O,"drawRectStroke");r(te,"drawLine");r(ne,"fmtText");r(ue,"drawText");r(ce,"drawFmtText");r(he,"width");r(pe,"height");r(be,"scale");
return r(Ee,"clearColor"),{width:he,height:pe,scale:be,makeTex:v,makeProgram:A,makeFont:R,drawTexture:J,drawText:ue,drawFmtText:ce,drawRect:E,drawRectStroke:O,drawLine:te,fmtText:ne,frameStart:I,frameEnd:j,pushTransform:H,popTransform:M,pushMatrix:S,drawCalls:T,clearColor:Ee}}function wt(t){return"pressed"===t||"rpressed"===t?"down":"released"===t?"up":t}function vt(t){function A(){return e.mousePos.clone()}function R(){return"pressed"===e.mouseState}function $(){return"pressed"===e.mouseState||"down"===
e.mouseState}function k(){return"released"===e.mouseState}function I(E){return"pressed"===e.keyStates[E]}function j(E){return"pressed"===e.keyStates[E]||"rpressed"===e.keyStates[E]}function T(E){return"pressed"===e.keyStates[E]||"rpressed"===e.keyStates[E]||"down"===e.keyStates[E]}function w(E){return"released"===e.keyStates[E]}function S(){return[].concat($jscomp.arrayFromIterable(e.charInputted))}function U(){return e.dt}function B(){return e.time}function _(){return e.fps}function G(){return e.canvas.toDataURL()}
function y(E){return E&&(e.canvas.style.cursor=null!=E?E:"default"),e.canvas.style.cursor}function H(E){var O=r(function(te){te/=1E3;var ue=te-e.realTime;e.realTime=te;e.skipTime||(e.dt=ue,e.time+=e.dt,e.fpsBuf.push(1/e.dt),e.fpsTimer+=e.dt,1<=e.fpsTimer&&(e.fpsTimer=0,e.fps=Math.round(e.fpsBuf.reduce(function(ce,he){return ce+he})/e.fpsBuf.length),e.fpsBuf=[]));e.skipTime=!1;E();for(var ce$jscomp$0 in e.keyStates)e.keyStates[ce$jscomp$0]=wt(e.keyStates[ce$jscomp$0]);e.mouseState=wt(e.mouseState);
e.charInputted=[];e.stopped||(e.loopID=requestAnimationFrame(O))},"frame");e.loopID=requestAnimationFrame(O)}function M(){cancelAnimationFrame(e.loopID);e.stopped=!0}t=void 0===t?{}:t;var q,J,e={canvas:null!=(q=t.canvas)?q:function(){var O,E=document.createElement("canvas");return(null!=(O=t.root)?O:document.body).appendChild(E),E}(),keyStates:{},charInputted:[],mouseState:"up",mousePos:f(0,0),time:0,realTime:0,skipTime:!1,dt:0,scale:null!=(J=t.scale)?J:1,isTouch:!1,loopID:null,stopped:!1,fps:0,fpsBuf:[],
fpsTimer:0},o={ArrowLeft:"left",ArrowRight:"right",ArrowUp:"up",ArrowDown:"down"," ":"space"},i="space left right up down tab f1 f2 f3 f4 f5 f6 f7 f8 f9 f10 f11".split(" ");t.fullscreen?(e.canvas.width=window.innerWidth,e.canvas.height=window.innerHeight):(e.canvas.width=(t.width||640)*e.scale,e.canvas.height=(t.height||480)*e.scale);q=["outline: none","cursor: default"];t.crisp&&(q.push("image-rendering: pixelated"),q.push("image-rendering: crisp-edges"));e.canvas.style=q.join(";");e.canvas.setAttribute("tabindex",
"0");q=e.canvas.getContext("webgl",{antialias:!0,depth:!0,stencil:!0,alpha:!0,preserveDrawingBuffer:!0});e.isTouch="ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints;e.canvas.addEventListener("mousemove",function(E){e.mousePos=f(E.offsetX,E.offsetY).scale(1/e.scale)});e.canvas.addEventListener("mousedown",function(){e.mouseState="pressed"});e.canvas.addEventListener("mouseup",function(){e.mouseState="released"});e.canvas.addEventListener("touchstart",function(E){E=E.touches[0];
e.mousePos=f(E.clientX,E.clientY).scale(1/e.scale);e.mouseState="pressed"});e.canvas.addEventListener("touchmove",function(E){E=E.touches[0];e.mousePos=f(E.clientX,E.clientY).scale(1/e.scale)});e.canvas.addEventListener("keydown",function(E){var O=o[E.key]||E.key.toLowerCase();i.includes(O)&&E.preventDefault();1===O.length&&e.charInputted.push(O);"space"===O&&e.charInputted.push(" ");E.repeat?e.keyStates[O]="rpressed":e.keyStates[O]="pressed"});e.canvas.addEventListener("keyup",function(E){E=o[E.key]||
E.key.toLowerCase();e.keyStates[E]="released"});e.canvas.focus();document.addEventListener("visibilitychange",function(){switch(document.visibilityState){case "visible":e.skipTime=!0}});r(A,"mousePos");r(R,"mouseClicked");r($,"mouseDown");r(k,"mouseReleased");r(I,"keyPressed");r(j,"keyPressedRep");r(T,"keyDown");r(w,"keyReleased");r(S,"charInputted");r(U,"dt");r(B,"time");r(_,"fps");r(G,"screenshot");r(y,"cursor");r(H,"run");return r(M,"quit"),{gl:q,mousePos:A,keyDown:T,keyPressed:I,keyPressedRep:j,
keyReleased:w,mouseDown:$,mouseClicked:R,mouseReleased:k,charInputted:S,cursor:y,dt:U,time:B,fps:_,screenshot:G,run:H,quit:M}}function Et(){function e(m){return void 0!==m&&(t.gainNode.gain.value=ae(m,Tt,St)),t.gainNode.gain.value}function o(m,v){v=void 0===v?{loop:!1,volume:1,speed:1,detune:0,seek:0}:v;var w,A=!1,R=t.ctx.createBufferSource();R.buffer=m;R.loop=!!v.loop;var $=t.ctx.createGain();R.connect($);$.connect(t.masterNode);var k=null!=(w=v.seek)?w:0;R.start(0,k);var I=t.ctx.currentTime-k,j=
null;w={stop:function(){A||(this.pause(),I=t.ctx.currentTime)},play:function(S){if(A){var U=R;R=t.ctx.createBufferSource();R.buffer=U.buffer;R.loop=U.loop;R.playbackRate.value=U.playbackRate.value;R.detune&&(R.detune.value=U.detune.value);R.connect($);S=null!=S?S:this.time();R.start(0,S);I=t.ctx.currentTime-S;A=!1;j=null}},pause:function(){A||(R.stop(),A=!0,j=t.ctx.currentTime)},paused:function(){return A},stopped:function(){return A},speed:function(S){return void 0!==S&&(R.playbackRate.value=ae(S,
un,cn)),R.playbackRate.value},detune:function(S){return R.detune?(void 0!==S&&(R.detune.value=ae(S,dn,fn)),R.detune.value):0},volume:function(S){return void 0!==S&&($.gain.value=ae(S,Tt,St)),$.gain.value},loop:function(){R.loop=!0},unloop:function(){R.loop=!1},duration:function(){return m.duration},time:function(){return A?j-I:t.ctx.currentTime-I}};return w.speed(v.speed),w.detune(v.detune),w.volume(v.volume),w}function i(){return t.ctx}var t=function(){var m=new (window.AudioContext||window.webkitAudioContext),
v=m.createGain();return v.connect(m.destination),{ctx:m,gainNode:v,masterNode:v}}();r(e,"volume");r(o,"play");return r(i,"ctx"),{ctx:i,volume:e,play:o}}function kt(t){var e=new Image;return e.src=t,e.crossOrigin="anonymous",new Promise(function(o,i){e.onload=function(){o(e)};e.onerror=function(){i("failed to load "+t)}})}function Dt(t){return t.startsWith("data:")}function Pt(t,e,o){function m(T){var S,w=i.lastLoaderID;i.loaders[w]=!1;i.lastLoaderID++;T.catch(null!=(S=o.errHandler)?S:console.error).finally(function(){i.loaders[w]=
!0})}function v(){var T=0,w=0,S;for(S in i.loaders)T+=1,i.loaders[S]&&(w+=1);return w/T}function A(T){return T&&(i.loadRoot=T),i.loadRoot}function R(T,w,S,U,B){B=void 0===B?mn:B;var _=new Promise(function(G,y){var H=Dt(w)?w:i.loadRoot+w;kt(H).then(function(M){M=t.makeFont(t.makeTex(M),S,U,B);i.fonts[T]=M;G(M)}).catch(y)});return m(_),_}function $(T,w,S){function U(_,G,y){y=void 0===y?{sliceX:1,sliceY:1,gridWidth:0,gridHeight:0,anims:{}}:y;var H=[];G=t.makeTex(G);for(var q=y.sliceX||G.width/(y.gridWidth||
G.width),J=y.sliceY||G.height/(y.gridHeight||G.height),E=1/q,O=1/J,ne=0;ne<J;ne++)for(var ue=0;ue<q;ue++)H.push(oe(ue*E,ne*O,E,O));y={tex:G,frames:H,anims:y.anims||{}};return i.sprites[_]=y,y}S=void 0===S?{sliceX:1,sliceY:1,anims:{}}:S;r(U,"loadRawSprite");var B=new Promise(function(_,G){if(!w)return G('expected sprite src for "'+T+'"');if("string"==typeof w){var y=Dt(w)?w:i.loadRoot+w;kt(y).then(function(H){_(U(T,H,S))}).catch(G)}else _(U(T,w,S))});return m(B),B}function k(T,w,S,U){function B(G,
y,H){y=t.makeProgram(y,H);return i.shaders[G]=y,y}U=void 0===U?!1:U;r(B,"loadRawShader");var _=new Promise(function(G,y){function H(M){return M?fetch(i.loadRoot+M).then(function(q){if(q.ok)return q.text();throw Error("failed to load "+M);}).catch(y):new Promise(function(q){return q(null)})}if(!w&&!S)return y("no shader");if(r(H,"resolveUrl"),U)Promise.all([H(w),H(S)]).then(function($jscomp$destructuring$var2){var $jscomp$destructuring$var3=$jscomp.makeIterator($jscomp$destructuring$var2);$jscomp$destructuring$var2=
$jscomp$destructuring$var3.next().value;$jscomp$destructuring$var3=$jscomp$destructuring$var3.next().value;G(B(T,$jscomp$destructuring$var2,$jscomp$destructuring$var3))}).catch(y);else try{G(B(T,w,S))}catch(M){y(M)}});return m(_),_}function I(T,w){var S=i.loadRoot+w,U=new Promise(function(B,_){if(!w)return _('expected sound src for "'+T+'"');"string"==typeof w&&fetch(S).then(function(G){if(G.ok)return G.arrayBuffer();throw Error("failed to load "+S);}).then(function(G){return new Promise(function(y,
H){e.ctx().decodeAudioData(G,y,H)})}).then(function(G){i.sounds[T]=G;B(G)}).catch(_)});return m(U),U}function j(){return i.fonts[Se]}o=void 0===o?{}:o;var i={lastLoaderID:0,loadRoot:"",loaders:{},sprites:{},sounds:{},fonts:{},shaders:{}};r(m,"addLoader");r(v,"loadProgress");r(A,"loadRoot");r(R,"loadFont");r($,"loadSprite");r(k,"loadShader");r(I,"loadSound");return r(j,"defFont"),R(Se,At,8,8),{loadRoot:A,loadSprite:$,loadSound:I,loadFont:R,loadShader:k,loadProgress:v,addLoader:m,defFont:j,sprites:i.sprites,
fonts:i.fonts,sounds:i.sounds,shaders:i.shaders}}function Lt(t,e,o){function v(){i.length>m&&(i=i.slice(0,m));var I=f(0,t.height());i.forEach(function(j,T){var w=ve(T,0,m,1,.5);T=ve(T,0,m,.8,.2);a:{switch(j.type){case "info":w=Y(1,1,1,w);break a;case "error":w=Y(1,0,.5,w);break a}w=void 0}j=t.fmtText(j.msg,e.defFont(),{pos:I,origin:"botleft",color:w,size:ln/t.scale(),width:t.width()});t.drawRect(I,j.width,j.height,{origin:"botleft",color:Y(0,0,0,T)});t.drawFmtText(j);I.y-=j.height})}function A(I){console.error(I);
i.unshift({type:"error",msg:I})}function R(I){i.unshift({type:"info",msg:I})}function $(){i=[]}o=void 0===o?{max:8}:o;var k,i=[],m=null!=(k=o.max)?k:8;r(v,"draw");r(A,"error");r(R,"info");return r($,"clear"),{info:R,error:A,draw:v,clear:$}}function Gt(t){function m(){return null!==i&&1===i.readyState}function v(){var k=new WebSocket(t);return new Promise(function(I,j){k.onopen=function(){I(k);i=k;for(var $jscomp$iter$5=$jscomp.makeIterator(o),$jscomp$key$T=$jscomp$iter$5.next();!$jscomp$key$T.done;$jscomp$key$T=
$jscomp$iter$5.next())k.send($jscomp$key$T.value)};k.onerror=function(){j("failed to connect to "+t)};k.onmessage=function(T){T=JSON.parse(T.data);if(e[T.type])for(var $jscomp$iter$6=$jscomp.makeIterator(e[T.type]),$jscomp$key$S=$jscomp$iter$6.next();!$jscomp$key$S.done;$jscomp$key$S=$jscomp$iter$6.next())$jscomp$key$S=$jscomp$key$S.value,$jscomp$key$S(T.data,T.id)}})}function A(k,I){e[k]||(e[k]=[]);e[k].push(I)}function R(k,I){k=JSON.stringify({type:k,data:I});i?i.send(k):o.push(k)}function $(){i&&
i.close()}var e={},o=[],i=null;r(m,"connected");r(v,"connect");r(A,"recv");r(R,"send");return r($,"close"),{connect:v,close:$,connected:m,recv:A,send:R}}var Je=Object.defineProperty,Qt=Object.defineProperties,Jt=Object.getOwnPropertyDescriptors,et=Object.getOwnPropertySymbols,en=Object.prototype.hasOwnProperty,tn=Object.prototype.propertyIsEnumerable,tt=function(t,e,o){return e in t?Je(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o},le=function(t,e){for(var o in e||(e={}))en.call(e,
o)&&tt(t,o,e[o]);if(et){var $jscomp$iter$0=$jscomp.makeIterator(et(e));for(o=$jscomp$iter$0.next();!o.done;o=$jscomp$iter$0.next())o=o.value,tn.call(e,o)&&tt(t,o,e[o])}return t},we=function(t,e){return Qt(t,Jt(e))},r=function(t,e){return Je(t,"name",{value:e,configurable:!0})},fe=function(t,e){return function(){return t&&(e=t(t=0)),e}},rn,sn,ct,dt,xe=fe(function(){r(nt,"deg2rad");r(rt,"rad2deg");r(ae,"clamp");r(De,"lerp");r(ve,"map");r(st,"mapc");r(f,"vec2");r(ot,"vec2FromAngle");r(Te,"vec3");r(Re,
"isVec2");r(it,"isVec3");r(ye,"isColor");r(at,"isMat4");r(Ve,"rgb");r(Y,"rgba");r(oe,"quad");r(ee,"mat4");r(ut,"wave");rn=1103515245;sn=12345;ct=2147483648;dt=Xe(Date.now());r(Xe,"makeRng");r(ft,"randSeed");r(Pe,"rand");r(ht,"chance");r(mt,"choose");r(Ye,"colRectRect");r(lt,"overlapRectRect");r(pt,"colRectPt")}),bt=fe(function(){r($e,"deepEq")}),He,Ie,Ne,yt,on,an,We,Ke,gt=fe(function(){xe();bt();He="topleft";Ie=9;Ne=65536;yt=64;on="\nattribute vec3 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nvec4 def_vert() {\n\treturn vec4(a_pos, 1.0);\n}\n\n{{user}}\n\nvoid main() {\n\tvec4 pos \x3d vert(a_pos, a_uv, a_color);\n\tv_pos \x3d a_pos;\n\tv_uv \x3d a_uv;\n\tv_color \x3d a_color;\n\tgl_Position \x3d pos;\n}\n";
an="\nprecision mediump float;\n\nvarying vec3 v_pos;\nvarying vec2 v_uv;\nvarying vec4 v_color;\n\nuniform sampler2D u_tex;\n\nvec4 def_frag() {\n\treturn v_color * texture2D(u_tex, v_uv);\n}\n\n{{user}}\n\nvoid main() {\n\tgl_FragColor \x3d frag(v_pos, v_uv, v_color, u_tex);\n\tif (gl_FragColor.a \x3d\x3d 0.0) {\n\t\tdiscard;\n\t}\n}\n";We="\nvec4 vert(vec3 pos, vec2 uv, vec4 color) {\n\treturn def_vert();\n}\n";Ke="\nvec4 frag(vec3 pos, vec2 uv, vec4 color, sampler2D tex) {\n\treturn def_frag();\n}\n";
r(Le,"originPt");r(xt,"gfxInit")}),Rt=fe(function(){xe();r(wt,"processBtnState");r(vt,"appInit")}),Tt,St,un,cn,dn,fn,Ct=fe(function(){xe();Tt=0;St=3;un=0;cn=3;dn=-1200;fn=1200;r(Et,"audioInit")}),At,_t=fe(function(){At="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAvgAAAAICAYAAACML4vTAAAAAXNSR0IArs4c6QAABo1JREFUeJzdW9uO5SgMJKv9/1/OPnQnDabKVQb6zGgtjeYkvmJsYwh9tQLc931//7yu63retdba+/4hTZ6ZDMQ3wHVdPe1kXk/60He2D/J7HLMhGyOwHQKji/o/BYmv40DecRq+cfgr8l8dhBfRLPF3v6F9Cu/ObwFPYxRBFptE7mA/wQ2yWMwI/1r+y3Bq/h4H3TwJ3fl16xcz4UfQPB+oplF9QJ7id+SjMVjz/wf5e5rK+hKfB9+a86PsZTIm+7P6942jufsqSvg7/END5WSg6ojLt7uurcjL6v8pfQ4doinIL9v+f4HTMfQ3gopR5gOQ+6jviPj7EfLvqQGsQFiXb/B7KMBGc/rQ3x1ONuHmBmOQfd93XwDVguPI/3Uw/fc8Dz5s4/xMogU/xScNKILJb4W5Q/YyXtt+IWcyF+GzMajY7ehZbCK5vf2sGczmJ+J6O6J8pT8dB5HPwPU706/knsjfVRlxvhje0Zn5H+F/m/+kf6uA1oxqPVD1Jeqj+kHuRr5x0ZzzU8nJANrCalDS5A54xV9Ynyd+p/6bNXSiBfY5Dk1pkPyObzI0s10ceFr+3+FXsMq/qk+BM97TusU6bIvp+Flf1ufuy/OJBh817s/vlcKOaOHgRBOeyu0nppt4uIEA+gcboLLv96oIu18IFLhfSRooMh19hsvkKyNjkCo6R+fXC3ya/ddAdjrekxH2i8VmiH23oGTNYy+n2iBHyPhYjtWV8IJtyz38BW6a42JMKuJtn30IfgJT+PdkziayaP1W+OpX6J6HyJ+ac8MXaJEvNfnGGheVow34neAn/tag30aByRfI5PDBlZ9tzNghHuJDMnZpGO37rMam/L/Jj2w6wY/8TH1gPCNfQ3zxAJTZ3wPKkS9EIS9bm3OfbDonof9YWgw7gCJ0uqF+390/JIs1QZE+yhjkKOcifMKDdMX3kYbxKB3xn8fsNZEPPm2SBQ7KD/OkkgXZfYV/PV/U/+rok0IswDH+HDyCmAcuXs1LHP8gBzTyd487dIrgAPPfC489wK6K/GwjouYoo6nmZQXUHCtA9RThd+yX87fIn9X3T8Kkl2yC3zlS+NZK9XUClruFjU3093IcBFui8U79Zfg74Flj7dRHJJ/1Hq58xAs3JAdgNb9QDxHB9f8JfgSV+c96QaVnCcRhzx3+r+hXY9qtq1HmKy+up3Ft3T7BN06gWVDGZhI5JL4b6Mh9yolu5T6iukMN7M4KQqWZ/SKYP9+lYJyAOYtPveMy5IPdZja//XPVnkw+tBHdPe35w8kWs3UX+tjNrtggvpWvM3H8Lihi5f/dE1kVD068PL7O+Fc2z65eNseuDEfHKoxFpx4fjm9bS+LjFyEu4F8P4gras1geqq8QzK9wlJ3IWYJk3TtS8zbvV8MN2qGvaxQOXt3YafKe2NjN8U8A2hzGDQpdg37xqzurObB3dOY9uyYG8nG37pXjp9rg7wQm+v0A201GvGqUd4KfFlejgUobxCDjixAXod3NiWVfRaa6YsT0hitIWWAqXyr+JdhYBDJbSg32Y8fOFZvVDdziBq/cABPY8WEKpxf31fgnMM2xq681u9HYagAM/6mxDmM0eXaBNhCELgKt36Z+Vf9GYoDLrsg496TZ8yFg629dEL+D7sDq4FB8bIF7xTaxI2X8Q9dJWf7Y/ks2iPYGf2HsWf5HnOovUH2m4896Q9JDDs+rV7TduKs2+EcLNdnhvM/f+MqCEp8tO437h9C2YEP2nL7/5WR2G79sgYwGqo1ElJHu4F9msAkC84Lscxd4Bg5/ansGhVOAKf7MAuBu4NC8seJ1mQ0lku/okM090M/iS8HuAq/ivxJ/To1RMrDg/G8OTuVHub4e1j/wg9xBuF5fbPJVTlTsdOaPrmdiHVqK3UN/w+Xmz2r+K/mQf6G5RnauwDuHm80oGwCLkZMbHLYB/nkYm9Md/yF6NDa3SR9sNPM/0rD+cpgf8ws+qifOGN35XK2bHznBj3xWEKHTy+QT5HYiGJ83kW3lP5ZI4MTmKU1a9rcFbNyFT76OzVC+olP2tQYLEJNfGmO2iVs4AU/nd/PzejrHiM58z/BWvjnzs+J7QEvxzlcQgFupJxXfVuSjuFP11NFp4bI76IVnpZ/a7cxfRkNiIxtL9n41f1yayhrngmrG5LwYdWkp/x35h9Yg1WC6vlYNuStvKeZW+h9zfR/eIboHxD12Bml87PYgiCZZP5Z81fI5lrm5k0fxfWVj+x9lSgjp7YOOoAAAAABJRU5ErkJggg\x3d\x3d"}),
mn,Se,It=fe(function(){xe();_t();mn=" !\"#$%\x26'()*+,-./0123456789:;\x3c\x3d\x3e?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~";Se="unscii";r(kt,"loadImg");r(Dt,"isDataUrl");r(Pt,"assetsInit")}),ln,Ft=fe(function(){xe();ln=16;r(Lt,"loggerInit")}),Mt=fe(function(){r(Gt,"netInit")});return function(t,e){return function(){return e||t((e={exports:{}}).exports,e),e.exports}}(function(Un,qt){xe();gt();Rt();Ct();It();Ft();Mt();qt.exports=function(t){function R(s,n){if(!A)throw Error("not connected to any websockets");
A.recv(s,function(a,d){try{n(a,d)}catch(u){v.error(u)}})}function $(s,n){if(!A)throw Error("not connected to any websockets");A.send(s,n)}function k(){return e.dt()*W.timeScale}function I(s,n){n=void 0===n?{}:n;var a=m.sounds[s];if(!a)throw Error('sound not found: "'+s+'"');return i.play(a,n)}function j(s){var a,n=y();return!(null==(a=n.layers[null!=s?s:n.defLayer])?0:a.noCam)}function T(s){return j(s)?y().cam.mpos:e.mousePos()}function w(s,n){n=void 0===n?{}:n;var u,a="string"==typeof s?m.sprites[s]:
s;if(!a)throw Error('sprite not found: "'+s+'"');s=a.frames[null!=(u=n.frame)?u:0];o.drawTexture(a.tex,we(le({},n),{quad:s}))}function S(s,n){n=void 0===n?{}:n;var u,a=null!=(u=n.font)?u:Se;u=m.fonts[a];if(!u)throw Error("font not found: "+a);o.drawText(s,u,n)}function G(s,n){_.scenes[s]={init:n,initialized:!1,events:{add:[],update:[],draw:[],destroy:[],keyDown:[],keyPress:[],keyPressRep:[],keyRelease:[],mouseClick:[],mouseRelease:[],mouseDown:[],charInput:[]},action:[],render:[],objs:new Map,lastObjID:0,
timers:{},lastTimerID:0,cam:{pos:f(o.width()/2,o.height()/2),scale:f(1,1),angle:0,shake:0,mpos:f(0),matrix:ee()},layers:{},defLayer:null,gravity:980,data:{}}}function y(){return _.scenes[_.curScene]}function H(){return y().data}function M(){X("`",function(){W.showLog=!W.showLog;v.info("show log: "+(W.showLog?"on":"off"))});X("f1",function(){W.inspect=!W.inspect;v.info("inspect: "+(W.inspect?"on":"off"))});X("f2",function(){W.clearLog()});X("f8",function(){W.paused=!W.paused;v.info(W.paused?"paused":
"unpaused")});X("f7",function(){W.timeScale=ae(W.timeScale-.2,0,2);v.info("time scale: "+W.timeScale.toFixed(1))});X("f9",function(){W.timeScale=ae(W.timeScale+.2,0,2);v.info("time scale: "+W.timeScale.toFixed(1))});X("f10",function(){W.stepFrame();v.info("stepped frame")})}function q(s,n){for(var $jscomp$restParams=[],$jscomp$restIndex=1;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-1]=arguments[$jscomp$restIndex];_.nextScene={name:s,args:[].concat($jscomp.arrayFromIterable($jscomp$restParams))}}
function J(s,n){for(var $jscomp$restParams=[],$jscomp$restIndex=1;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-1]=arguments[$jscomp$restIndex];E(s);_.curScene=s;$jscomp$restIndex=_.scenes[s];if(!$jscomp$restIndex)throw Error("scene not found: '"+s+"'");if(!$jscomp$restIndex.initialized){try{$jscomp$restIndex.init.apply($jscomp$restIndex,$jscomp.arrayFromIterable($jscomp$restParams))}catch(d){v.error(d.stack)}t.debug&&M();$jscomp$restIndex.initialized=
!0}}function E(s){if(!_.scenes[s])throw Error("scene not found: '"+s+"'");G(s,_.scenes[s].init)}function O(s,n){var a=y();!a||(s.forEach(function(d,u){a.layers[d]={alpha:1,order:u+1,noCam:!1}}),n&&(a.defLayer=n))}function te(s){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restIndex=y().cam;return 0<$jscomp$restParams.length&&($jscomp$restIndex.pos=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams))),
$jscomp$restIndex.pos.clone()}function ne(s){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restIndex=y().cam;return 0<$jscomp$restParams.length&&($jscomp$restIndex.scale=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams))),$jscomp$restIndex.scale.clone()}function ue(s){var n=y().cam;return void 0!==s&&(n.angle=s),n.angle}function ce(s){y().cam.shake=s}function he(s){var n=
y();s.forEach(function(a){n.layers[a]&&(n.layers[a].noCam=!0)})}function pe(s){var n={hidden:!1,paused:!1,_tags:[],_id:null,_events:{add:[],update:[],draw:[],destroy:[],inspect:[]},use:function(u){if(void 0!==u){var p=typeof u;if("string"===p)this._tags.push(u);else{if("object"!==p)throw Error("invalid comp type: "+p);if(Array.isArray(u))for(u=$jscomp.makeIterator(u),p=u.next();!p.done;p=u.next())this.use(p.value);else for(var c$42 in u)"function"==typeof u[c$42]?this._events[c$42]?this._events[c$42].push(u[c$42].bind(this)):
this[c$42]=u[c$42].bind(this):this[c$42]=u[c$42]}}},exists:function(){return void 0!==this._id},is:function(u){if("*"===u)return!0;if(Array.isArray(u)){u=$jscomp.makeIterator(u);for(var $jscomp$key$p=u.next();!$jscomp$key$p.done;$jscomp$key$p=u.next())if(!this._tags.includes($jscomp$key$p.value))return!1;return!0}return this._tags.includes(u)},on:function(u,p){this._events[u]||(this._events[u]=[]);this._events[u].push(p)},action:function(u){this.on("update",u)},trigger:function(u,p){for(var $jscomp$restParams=
[],$jscomp$restIndex=1;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-1]=arguments[$jscomp$restIndex];if(this._events[u]){$jscomp$restIndex=$jscomp.makeIterator(this._events[u]);for(var $jscomp$key$g=$jscomp$restIndex.next();!$jscomp$key$g.done;$jscomp$key$g=$jscomp$restIndex.next())$jscomp$key$g=$jscomp$key$g.value,$jscomp$key$g.call.apply($jscomp$key$g,[this].concat($jscomp.arrayFromIterable($jscomp$restParams)))}if($jscomp$restIndex=y().events[u])for($jscomp$restIndex=
$jscomp.makeIterator($jscomp$restIndex),$jscomp$key$g=$jscomp$restIndex.next();!$jscomp$key$g.done;$jscomp$key$g=$jscomp$restIndex.next())$jscomp$key$g=$jscomp$key$g.value,this.is($jscomp$key$g.tag)&&$jscomp$key$g.cb.apply($jscomp$key$g,[this].concat($jscomp.arrayFromIterable($jscomp$restParams)))},rmTag:function(u){u=this._tags.indexOf(u);-1<u&&this._tags.splice(u,1)}};n.use(s);s=y();var d=s.lastObjID++;s.objs.set(d,n);n._id=d;n.trigger("add");s=$jscomp.makeIterator(s.events.add);for(d=s.next();!d.done;d=
s.next())d=d.value,n.is(d.tag)&&d.cb(n);return n}function be(s){if(s.exists()){var n=y();n.objs.delete(s._id);var a=n.lastObjID++;return n.objs.set(a,s),s._id=a,s}}function Ee(s,n,a){var d=y();d.events[s]||(d.events[s]=[]);d.events[s].push({tag:n,cb:a})}function h(s,n){"function"==typeof s&&void 0===n?y().action.push(s):"string"==typeof s&&Ee("update",s,n)}function x(s,n){"function"==typeof s&&void 0===n?y().render.push(s):"string"==typeof s&&Ee("update",s,n)}function b(s,n,a){h(s,function(d){d._checkCollisions(n,
function(u){a(d,u)})})}function L(s,n,a){h(s,function(d){d._checkOverlaps(n,function(u){a(d,u)})})}function z(s,n){h(s,function(a){a.isClicked()&&n(a)})}function V(s,n){return new Promise(function(a){var d=y();d.timers[d.lastTimerID++]={time:s,cb:function(){n&&n();a()}}})}function K(s,n){var a=!1,d=r(function(){a||(n(),V(s,d))},"newF");return d(),{stop:function(){a=!0}}}function C(s,n,a){if(Array.isArray(n)){n=$jscomp.makeIterator(n);for(var $jscomp$key$d=n.next();!$jscomp$key$d.done;$jscomp$key$d=
n.next())C(s,$jscomp$key$d.value,a)}else y().events[s].push({key:n,cb:a})}function P(s,n){C("keyDown",s,n)}function X(s,n){C("keyPress",s,n)}function F(s,n){C("keyPressRep",s,n)}function Z(s,n){C("keyRelease",s,n)}function re(s){y().events.charInput.push({cb:s})}function ge(s){y().events.mouseDown.push({cb:s})}function Fe(s){y().events.mouseClick.push({cb:s})}function Ge(s){y().events.mouseRelease.push({cb:s})}function se(s){var n=y(),a=[].concat($jscomp.arrayFromIterable(n.objs.values())).sort(function(d,
u){var l,g,D,N,Q,de;d=null!=(D=null==(g=n.layers[null!=(l=d.layer)?l:n.defLayer])?void 0:g.order)?D:0;u=null!=(de=null==(Q=n.layers[null!=(N=u.layer)?N:n.defLayer])?void 0:Q.order)?de:0;return d-u});return s?a.filter(function(d){return d.is(s)}):a}function me(s,n){"function"==typeof s&&void 0===n?se().forEach(s):"string"==typeof s&&se(s).forEach(n)}function Ce(s,n){"function"==typeof s&&void 0===n?se().reverse().forEach(s):"string"==typeof s&&se(s).reverse().forEach(n)}function ie(s){if(s.exists()){var n=
y();!n||(s.trigger("destroy"),n.objs.delete(s._id),delete s._id)}}function Ue(s){me(s,function(n){ie(n)})}function Me(s){var n=y();return void 0!==s&&(n.gravity=s),n.gravity}function Ae(s){var n=y();if(!n)throw Error("scene not found: '"+_.curScene+"'");var a=s||!W.paused;if(a)for(var c$jscomp$0 in n.timers)s=n.timers[c$jscomp$0],s.time-=k(),0>=s.time&&(s.cb(),delete n.timers[c$jscomp$0]);if(Ce(function(c){!c.paused&&a&&c.trigger("update")}),a)for(c$jscomp$0=$jscomp.makeIterator(n.action),s=c$jscomp$0.next();!s.done;s=
c$jscomp$0.next())s=s.value,s();c$jscomp$0=f(o.width(),o.height());var u=n.cam;s=ot(Pe(0,2*Math.PI)).scale(u.shake);u.shake=De(u.shake,0,5*k());u.matrix=ee().translate(c$jscomp$0.scale(.5)).scale(u.scale).rotateZ(u.angle).translate(c$jscomp$0.scale(-.5)).translate(u.pos.scale(-1).add(c$jscomp$0.scale(.5)).add(s));u.mpos=u.matrix.invert().multVec2(e.mousePos());me(function(c){c.hidden||(o.pushTransform(),j(c.layer)&&o.pushMatrix(u.matrix),c.trigger("draw"),o.popTransform())});n=$jscomp.makeIterator(n.render);
for(s=n.next();!s.done;s=n.next())c$jscomp$0=s.value,c$jscomp$0()}function Be(){for(var s=y(),$jscomp$iter$15=$jscomp.makeIterator(s.events.charInput),$jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.charInputted().forEach($jscomp$key$n.cb);$jscomp$iter$15=$jscomp.makeIterator(s.events.keyDown);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,
e.keyDown($jscomp$key$n.key)&&$jscomp$key$n.cb();$jscomp$iter$15=$jscomp.makeIterator(s.events.keyPress);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.keyPressed($jscomp$key$n.key)&&$jscomp$key$n.cb();$jscomp$iter$15=$jscomp.makeIterator(s.events.keyPressRep);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.keyPressedRep($jscomp$key$n.key)&&
$jscomp$key$n.cb();$jscomp$iter$15=$jscomp.makeIterator(s.events.keyRelease);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.keyReleased($jscomp$key$n.key)&&$jscomp$key$n.cb();$jscomp$iter$15=$jscomp.makeIterator(s.events.mouseDown);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.mouseDown()&&$jscomp$key$n.cb();$jscomp$iter$15=
$jscomp.makeIterator(s.events.mouseClick);for($jscomp$key$n=$jscomp$iter$15.next();!$jscomp$key$n.done;$jscomp$key$n=$jscomp$iter$15.next())$jscomp$key$n=$jscomp$key$n.value,e.mouseClicked()&&$jscomp$key$n.cb();s=$jscomp.makeIterator(s.events.mouseRelease);for($jscomp$key$n=s.next();!$jscomp$key$n.done;$jscomp$key$n=s.next())$jscomp$key$n=$jscomp$key$n.value,e.mouseReleased()&&$jscomp$key$n.cb()}function _e(){function u(l,g,D){var N=f(4).scale(1/D);g=o.fmtText(g,a,{size:12/D,pos:l.add(f(N.x,N.y))});
o.drawRect(l,g.width+2*N.x,g.height+2*N.x,{color:Y(0,0,0,1)});o.drawFmtText(g)}function p(l,g){l=j(l.layer);var N=o.scale()*(l?(s.cam.scale.x+s.cam.scale.y)/2:1);l&&(o.pushTransform(),o.pushMatrix(s.cam.matrix));g(N);l&&o.popTransform()}var c,s=y(),n=null,a=m.defFont(),d=Y(null!=(c=t.inspectColor)?c:[0,1,1,1]);r(u,"drawInspectTxt");r(p,"drawObj");Ce(function(l){!l.area||l.hidden||p(l,function(g){n||l.isHovered()&&(n=l);g=(n===l?6:2)/g;var N=l._worldArea();o.drawRectStroke(N.p1,N.p2.x-N.p1.x,N.p2.y-
N.p1.y,{width:g,color:d})})});n&&p(n,function(l){for(var g=T(n.layer),D=[],$jscomp$iter$23=$jscomp.makeIterator(n._tags),$jscomp$key$N=$jscomp$iter$23.next();!$jscomp$key$N.done;$jscomp$key$N=$jscomp$iter$23.next())D.push('"'+$jscomp$key$N.value+'"');$jscomp$iter$23=$jscomp.makeIterator(n._events.inspect);for($jscomp$key$N=$jscomp$iter$23.next();!$jscomp$key$N.done;$jscomp$key$N=$jscomp$iter$23.next()){$jscomp$key$N=$jscomp$key$N.value;$jscomp$key$N=$jscomp$key$N();for(var de in $jscomp$key$N)D.push(de+
": "+$jscomp$key$N[de])}u(g,D.join("\n"),l)});u(f(0),e.fps()+"",o.scale())}function je(s,n){for(var $jscomp$restParams=[],$jscomp$restIndex=1;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-1]=arguments[$jscomp$restIndex];e.run(function(){if(o.frameStart(),_.loaded){try{if(!y())throw Error("scene not found: '"+_.curScene+"'");Be();Ae();W.inspect&&_e()}catch(a){v.error(a.stack),e.quit()}W.showLog&&v.draw();_.nextScene&&(J.apply(null,[_.nextScene.name].concat($jscomp.arrayFromIterable(_.nextScene.args))),
_.nextScene=null)}else{var a$56=m.loadProgress();if(1===a$56)_.loaded=!0,J.apply(null,[s].concat($jscomp.arrayFromIterable($jscomp$restParams))),A&&A.connect().catch(v.error);else{var d=o.width()/2,u=24/o.scale(),p=f(o.width()/2,o.height()/2).sub(f(d/2,u/2));o.drawRect(f(0),o.width(),o.height(),{color:Ve(0,0,0)});o.drawRectStroke(p,d,u,{width:4/o.scale()});o.drawRect(p,d*a$56,u)}}o.frameEnd()})}function qe(s){for(var $jscomp$restParams$jscomp$0=[],$jscomp$restIndex$jscomp$0=0;$jscomp$restIndex$jscomp$0<
arguments.length;++$jscomp$restIndex$jscomp$0)$jscomp$restParams$jscomp$0[$jscomp$restIndex$jscomp$0-0]=arguments[$jscomp$restIndex$jscomp$0];return{pos:f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams$jscomp$0)),move:function(n){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restIndex=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));$jscomp$restParams=
$jscomp$restIndex.x*k();$jscomp$restIndex=$jscomp$restIndex.y*k();this.pos.x+=$jscomp$restParams;this.pos.y+=$jscomp$restIndex},inspect:function(){return{pos:"("+~~this.pos.x+", "+~~this.pos.y+")"}}}}function Ze(s){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];return 0===$jscomp$restParams.length?Ze(1):{scale:f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams)),flipX:function(n){this.scale.x=
Math.sign(n)*Math.abs(this.scale.x)},flipY:function(n){this.scale.y=Math.sign(n)*Math.abs(this.scale.y)}}}function Ot(s){return{angle:null!=s?s:0}}function Vt(s){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];return{color:Y.apply(null,$jscomp.arrayFromIterable($jscomp$restParams))}}function Nt(s){return{origin:s}}function Ut(s){return{layer:s,inspect:function(){var a,n=y();
return{layer:null!=(a=this.layer)?a:n.defLayer}}}}function ze(s,n){var d,u,a=y();return(null!=(d=s.layer)?d:a.defLayer)===(null!=(u=n.layer)?u:a.defLayer)}function Qe(s,n){var a={},d={};return{area:{p1:s,p2:n},areaWidth:function(){var $jscomp$destructuring$var4=this._worldArea();return $jscomp$destructuring$var4.p2.x-$jscomp$destructuring$var4.p1.x},areaHeight:function(){var $jscomp$destructuring$var5=this._worldArea();return $jscomp$destructuring$var5.p2.y-$jscomp$destructuring$var5.p1.y},isClicked:function(){return e.mouseClicked()&&
this.isHovered()},isHovered:function(){return this.hasPt(T(this.layer))},isCollided:function(u){if(!u.area||!ze(this,u))return!1;var p=this._worldArea();u=u._worldArea();return Ye(p,u)},isOverlapped:function(u){if(!u.area||!ze(this,u))return!1;var p=this._worldArea();u=u._worldArea();return lt(p,u)},clicks:function(u){var $jscomp$this=this;this.action(function(){$jscomp$this.isClicked()&&u()})},hovers:function(u){var $jscomp$this=this;this.action(function(){$jscomp$this.isHovered()&&u()})},collides:function(u,
p){var $jscomp$this=this;this.action(function(){$jscomp$this._checkCollisions(u,p)})},overlaps:function(u,p){var $jscomp$this=this;this.action(function(){$jscomp$this._checkOverlaps(u,p)})},hasPt:function(u){var p=this._worldArea();return pt({p1:p.p1,p2:p.p2},u)},resolve:function(){var $jscomp$this=this,u=[];return me(function(p){if(p!==$jscomp$this&&p.solid&&p.area&&ze($jscomp$this,p)){var c=$jscomp$this._worldArea(),l=p._worldArea();if(Ye(c,l)){var g=c.p2.x-l.p1.x,D=l.p2.x-c.p1.x,N=c.p2.y-l.p1.y,
Q=l.p2.y-c.p1.y,de=Math.min(g,D,N,Q);c=function(){switch(de){case g:return $jscomp$this.pos.x-=g,"right";case D:return $jscomp$this.pos.x+=D,"left";case N:return $jscomp$this.pos.y-=N,"bottom";case Q:return $jscomp$this.pos.y+=Q,"top"}}();u.push({obj:p,side:c})}}}),u},_checkCollisions:function(u,p){var $jscomp$this=this;me(u,function(c){$jscomp$this!==c&&(a[c._id]||$jscomp$this.isCollided(c)&&(p(c),a[c._id]=c))});for(var c$jscomp$0 in a)this.isCollided(a[c$jscomp$0])||delete a[c$jscomp$0]},_checkOverlaps:function(u,
p){var $jscomp$this=this;me(u,function(c){$jscomp$this!==c&&(d[c._id]||$jscomp$this.isOverlapped(c)&&(p(c),d[c._id]=c))});for(var c$jscomp$0 in d)this.isOverlapped(d[c$jscomp$0])||delete d[c$jscomp$0]},_worldArea:function(){var u=this.area,p=this.pos||f(0),c=this.scale||f(1),l=p.add(u.p1.dot(c));u=p.add(u.p2.dot(c));return{p1:f(Math.min(l.x,u.x),Math.min(l.y,u.y)),p2:f(Math.max(l.x,u.x),Math.max(l.y,u.y))}}}}function Oe(s,n,a){s=f(s,n);a=Le(a||"topleft").dot(s).scale(-.5);return Qe(a.sub(s.scale(.5)),
a.add(s.scale(.5)))}function Bt(s,n){n=void 0===n?{}:n;var a=m.sprites[s];if(!a)throw Error('sprite not found: "'+s+'"');s=le({},a.frames[0]);n.quad&&(s.x+=n.quad.x*s.w,s.y+=n.quad.y*s.h,s.w*=n.quad.w,s.h*=n.quad.h);var c=null;return{width:a.tex.width*s.w,height:a.tex.height*s.h,animSpeed:n.animSpeed||.1,frame:n.frame||0,quad:n.quad||oe(0,0,1,1),add:function(){this.area||n.noArea||this.use(Oe(this.width,this.height,this.origin))},draw:function(){y();w(a,{pos:this.pos,scale:this.scale,rot:this.angle,
color:this.color,frame:this.frame,origin:this.origin,quad:this.quad,prog:m.shaders[this.shader],uniform:this.uniform})},update:function(){if(c){var l=a.anims[c.name];c.timer+=k();c.timer>=this.animSpeed&&(this.frame++,this.frame>l.to&&(c.loop?this.frame=l.from:(this.frame--,this.stop())),c&&(c.timer-=this.animSpeed))}},play:function(l,g){g=void 0===g?!0:g;var D=a.anims[l];if(!D)throw Error("anim not found: "+l);c&&this.stop();c={name:l,loop:g,timer:0};this.frame=D.from;this.trigger("animPlay",l)},
stop:function(){if(c){var l=c.name;c=null;this.trigger("animEnd",l)}},changeSprite:function(l){if(a=m.sprites[l],!a)throw Error('sprite not found: "'+l+'"');l=le({},a.frames[0]);n.quad&&(l.x+=n.quad.x*l.w,l.y+=n.quad.y*l.h,l.w*=n.quad.w,l.h*=n.quad.h);this.width=a.tex.width*l.w;this.height=a.tex.height*l.h;this.area&&!n.noArea&&this.use(Oe(this.width,this.height,this.origin));c=null;this.frame=0},numFrames:function(){return a.frames.length},curAnim:function(){return null==c?void 0:c.name},inspect:function(){var l=
{};return c&&(l.curAnim='"'+c.name+'"'),l}}}function jt(s,n,a){a=void 0===a?{}:a;return{text:s,textSize:n,font:a.font,width:0,height:0,add:function(){var d,u,p;if(!this.area&&!a.noArea){y();var l=m.fonts[null!=(d=this.font)?d:Se];d=o.fmtText(this.text+"",l,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:a.width});this.width=d.width/((null==(u=this.scale)?void 0:u.x)||1);this.height=d.height/((null==(p=this.scale)?void 0:p.y)||1);this.use(Oe(this.width,
this.height,this.origin))}},draw:function(){var c;y();var u=m.fonts[null!=(c=this.font)?c:Se];c=o.fmtText(this.text+"",u,{pos:this.pos,scale:this.scale,rot:this.angle,size:this.textSize,origin:this.origin,color:this.color,width:a.width});this.width=c.width;this.height=c.height;o.drawFmtText(c)}}}function zt(s,n,a){a=void 0===a?{}:a;return{width:s,height:n,add:function(){this.area||a.noArea||this.use(Oe(this.width,this.height,this.origin))},draw:function(){y();o.drawRect(this.pos,this.width,this.height,
{scale:this.scale,rot:this.angle,color:this.color,origin:this.origin,prog:m.shaders[this.shader],uniform:this.uniform})}}}function Xt(){return{solid:!0}}function Ht(s){s=void 0===s?{}:s;var p,c,n=0,a=null,d=null,u=null!=(p=s.maxVel)?p:960;return{jumpForce:null!=(c=s.jumpForce)?c:480,update:function(){this.move(0,n);var l=this.resolve(),g=!1;if(a&&(a.exists()&&this.isCollided(a)?d&&(this.pos=this.pos.add(a.pos.sub(d)),d=a.pos.clone()):(a=null,d=null,g=!0)),!a){n=Math.min(n+Me()*k(),u);l=$jscomp.makeIterator(l);
for(var $jscomp$key$D=l.next();!$jscomp$key$D.done;$jscomp$key$D=l.next())$jscomp$key$D=$jscomp$key$D.value,"bottom"===$jscomp$key$D.side&&0<n?(a=$jscomp$key$D.obj,n=0,d=a.pos.clone(),g||this.trigger("grounded",a)):"top"===$jscomp$key$D.side&&0>n&&(n=0,this.trigger("headbump",$jscomp$key$D.obj))}},curPlatform:function(){return a},grounded:function(){return null!==a},falling:function(){return 0<n},jump:function(l){a=null;n=-l||-this.jumpForce}}}function Wt(s,n){n=void 0===n?{}:n;return{shader:s,uniform:n}}
function Kt(s,n){var a=[],d=f(n.pos||0),u=0,p={getPos:function(c){for(var $jscomp$restParams=[],$jscomp$restIndex=0;$jscomp$restIndex<arguments.length;++$jscomp$restIndex)$jscomp$restParams[$jscomp$restIndex-0]=arguments[$jscomp$restIndex];$jscomp$restParams=f.apply(null,$jscomp.arrayFromIterable($jscomp$restParams));return f(d.x+$jscomp$restParams.x*n.width,d.y+$jscomp$restParams.y*n.height)},spawn:function(c,l){var g=function(){if(Array.isArray(c))return c;if(n[c]){if("function"==typeof n[c])return n[c]();
if(Array.isArray(n[c]))return[].concat($jscomp.arrayFromIterable(n[c]))}else if(n.any)return n.any(c)}();if(g)return g.push(qe(d.x+l.x*n.width,d.y+l.y*n.height)),g=pe(g),a.push(g),g.use({gridPos:l.clone(),setGridPos:function(N){this.gridPos=N.clone();this.pos=f(d.x+this.gridPos.x*n.width,d.y+this.gridPos.y*n.height)},moveLeft:function(){this.setGridPos(this.gridPos.add(f(-1,0)))},moveRight:function(){this.setGridPos(this.gridPos.add(f(1,0)))},moveUp:function(){this.setGridPos(this.gridPos.add(f(0,
-1)))},moveDown:function(){this.setGridPos(this.gridPos.add(f(0,1)))}}),g},width:function(){return u*n.width},height:function(){return s.length*n.height},destroy:function(){for(var $jscomp$iter$26=$jscomp.makeIterator(a),$jscomp$key$c=$jscomp$iter$26.next();!$jscomp$key$c.done;$jscomp$key$c=$jscomp$iter$26.next())ie($jscomp$key$c.value)}};return s.forEach(function(c,l){c=c.split("");u=Math.max(c.length,u);c.forEach(function(D,N){p.spawn(D,f(N,l))})}),p}t=void 0===t?{width:640,height:480,scale:1,fullscreen:!1,
debug:!1,crisp:!1,canvas:null,connect:null,logMax:8,root:document.body}:t;var e=vt({width:t.width,height:t.height,scale:t.scale,fullscreen:t.fullscreen,crisp:t.crisp,canvas:t.canvas,root:t.root}),o=xt(e.gl,{clearColor:t.clearColor?Y(t.clearColor):void 0,scale:t.scale,texFilter:t.texFilter}),i=Et(),m=Pt(o,i,{errHandler:function(s){v.error(s)}}),v=Lt(o,m,{max:t.logMax}),A=t.connect?Gt(t.connect):null;r(R,"recv");r($,"send");r(k,"dt");r(I,"play");r(j,"isCamLayer");r(T,"mousePos");r(w,"drawSprite");r(S,
"drawText");var _={loaded:!1,scenes:{},curScene:null,nextScene:null};r(G,"scene");r(y,"curScene");r(H,"sceneData");r(M,"regDebugInputs");r(q,"go");r(J,"goSync");r(E,"reload");r(O,"layers");r(te,"camPos");r(ne,"camScale");r(ue,"camRot");r(ce,"camShake");r(he,"camIgnore");r(pe,"add");r(be,"readd");r(Ee,"on");r(h,"action");r(x,"render");r(b,"collides");r(L,"overlaps");r(z,"clicks");r(V,"wait");r(K,"loop");r(C,"pushKeyEvent");r(P,"keyDown");r(X,"keyPress");r(F,"keyPressRep");r(Z,"keyRelease");r(re,"charInput");
r(ge,"mouseDown");r(Fe,"mouseClick");r(Ge,"mouseRelease");r(se,"get");r(me,"every");r(Ce,"revery");r(ie,"destroy");r(Ue,"destroyAll");r(Me,"gravity");r(Ae,"gameFrame");r(Be,"handleEvents");r(_e,"drawInspect");r(je,"start");r(qe,"pos");r(Ze,"scale");r(Ot,"rotate");r(Vt,"color");r(Nt,"origin");r(Ut,"layer");r(ze,"isSameLayer");r(Qe,"area");r(Oe,"getAreaFromSize");r(Bt,"sprite");r(jt,"text");r(zt,"rect");r(Xt,"solid");r(Ht,"body");r(Wt,"shader");var W={paused:!1,inspect:!1,timeScale:1,showLog:!0,fps:e.fps,
objCount:function(){return y().objs.size},stepFrame:function(){Ae(!0)},drawCalls:o.drawCalls,clearLog:v.clear,log:v.info,error:v.error};r(Kt,"addLevel");var ke={start:je,loadRoot:m.loadRoot,loadSprite:m.loadSprite,loadSound:m.loadSound,loadFont:m.loadFont,loadShader:m.loadShader,addLoader:m.addLoader,width:o.width,height:o.height,dt:k,time:e.time,screenshot:e.screenshot,scene:G,go:q,sceneData:H,layers:O,camPos:te,camScale:ne,camRot:ue,camShake:ce,camIgnore:he,gravity:Me,add:pe,readd:be,destroy:ie,
destroyAll:Ue,get:se,every:me,revery:Ce,send:$,recv:R,pos:qe,scale:Ze,rotate:Ot,color:Vt,origin:Nt,layer:Ut,area:Qe,sprite:Bt,text:jt,rect:zt,solid:Xt,body:Ht,shader:Wt,on:Ee,action:h,render:x,collides:b,overlaps:L,clicks:z,keyDown:P,keyPress:X,keyPressRep:F,keyRelease:Z,charInput:re,mouseDown:ge,mouseClick:Fe,mouseRelease:Ge,mousePos:T,cursor:e.cursor,keyIsDown:e.keyDown,keyIsPressed:e.keyPressed,keyIsPressedRep:e.keyPressedRep,keyIsReleased:e.keyReleased,mouseIsDown:e.mouseDown,mouseIsClicked:e.mouseClicked,
mouseIsReleased:e.mouseReleased,loop:K,wait:V,play:I,volume:i.volume,makeRng:Xe,rand:Pe,randSeed:ft,vec2:f,rgb:Ve,rgba:Y,quad:oe,choose:mt,chance:ht,lerp:De,map:ve,mapc:st,wave:ut,deg2rad:nt,rad2deg:rt,drawSprite:w,drawText:S,drawRect:o.drawRect,drawRectStroke:o.drawRectStroke,drawLine:o.drawLine,debug:W,addLevel:Kt};if(t.plugins)for(var $jscomp$iter$27=$jscomp.makeIterator(t.plugins),$jscomp$key$s=$jscomp$iter$27.next();!$jscomp$key$s.done;$jscomp$key$s=$jscomp$iter$27.next()){$jscomp$key$s=$jscomp$key$s.value;
$jscomp$key$s=$jscomp$key$s(ke);for(var a$jscomp$0 in $jscomp$key$s)ke[a$jscomp$0]=$jscomp$key$s[a$jscomp$0]}if(t.global)for(var s$62 in ke)window[s$62]=ke[s$62];return ke}})()})()}
//# sourceMappingURL=module$node_modules$kaboom$dist$kaboom.js.map
