shadow$provide.module$node_modules$Phaser$src$gameobjects$tilesprite$TileSprite=function(global,require,module,exports){var CanvasPool=require("module$node_modules$Phaser$src$display$canvas$CanvasPool");global=require("module$node_modules$Phaser$src$utils$Class");exports=require("module$node_modules$Phaser$src$gameobjects$components$index");var CONST=require("module$node_modules$Phaser$src$const"),GameObject=require("module$node_modules$Phaser$src$gameobjects$GameObject"),GetPowerOfTwo=require("module$node_modules$Phaser$src$math$pow2$GetPowerOfTwo"),
TileSpriteRender=require("module$node_modules$Phaser$src$gameobjects$tilesprite$TileSpriteRender"),Vector2=require("module$node_modules$Phaser$src$math$Vector2");require=new global({Extends:GameObject,Mixins:[exports.Alpha,exports.BlendMode,exports.ComputedSize,exports.Crop,exports.Depth,exports.Flip,exports.GetBounds,exports.Mask,exports.Origin,exports.Pipeline,exports.ScaleMode,exports.ScrollFactor,exports.Tint,exports.Transform,exports.Visible,TileSpriteRender],initialize:function(scene,x,y,width,
height,textureKey,frameKey){width=Math.floor(width);height=Math.floor(height);var renderer$jscomp$0=scene.sys.game.renderer;GameObject.call(this,scene,"TileSprite");this._tilePosition=new Vector2;this._tileScale=new Vector2(1,1);this.dirty=!1;this.renderer=renderer$jscomp$0;this.canvas=CanvasPool.create(this,width,height);this.context=this.canvas.getContext("2d");this.displayTexture=scene.sys.textures.get(textureKey);this.displayFrame=this.displayTexture.get(frameKey);this._crop=this.resetCropObject();
this.texture=scene.sys.textures.addCanvas(null,this.canvas,!0);this.frame=this.texture.get();this.potWidth=GetPowerOfTwo(this.displayFrame.width);this.potHeight=GetPowerOfTwo(this.displayFrame.height);this.fillCanvas=CanvasPool.create2D(this,this.potWidth,this.potHeight);this.fillContext=this.fillCanvas.getContext("2d");this.fillPattern=null;this.setFrame(frameKey);this.setPosition(x,y);this.setSize(width,height);this.setOriginFromFrame();this.initPipeline();if(scene.sys.game.config.renderType===
CONST.WEBGL)scene.sys.game.renderer.onContextRestored(function(renderer){var gl=renderer.gl;this.dirty=!0;this.fillPattern=null;this.fillPattern=renderer.createTexture2D(0,gl.LINEAR,gl.LINEAR,gl.REPEAT,gl.REPEAT,gl.RGBA,this.fillCanvas,this.potWidth,this.potHeight)},this)},setTexture:function(key,frame){this.displayTexture=this.scene.sys.textures.get(key);return this.setFrame(frame)},setFrame:function(frame,updateSize,updateOrigin){void 0===updateSize&&(updateSize=!0);void 0===updateOrigin&&(updateOrigin=
!0);this.displayFrame=this.displayTexture.get(frame);this.renderFlags=this.displayFrame.cutWidth&&this.displayFrame.cutHeight?this.renderFlags|8:this.renderFlags&-9;this._sizeComponent&&updateSize&&this.setSizeToFrame();this._originComponent&&updateOrigin&&(this.displayFrame.customPivot?this.setOrigin(this.displayFrame.pivotX,this.displayFrame.pivotY):this.updateDisplayOrigin());this.dirty=!0;this.updateTileTexture();return this},setTilePosition:function(x,y){void 0!==x&&(this.tilePositionX=x);void 0!==
y&&(this.tilePositionY=y);return this},setTileScale:function(x,y){void 0!==x&&(this.tileScaleX=x);void 0!==y&&(this.tileScaleY=y);return this},updateTileTexture:function(){if(this.dirty){var frame=this.displayFrame,ctx=this.fillContext,canvas=this.fillCanvas,fw=this.potWidth,fh=this.potHeight;this.renderer.gl||(fw=frame.cutWidth,fh=frame.cutHeight);ctx.clearRect(0,0,fw,fh);canvas.width=fw;canvas.height=fh;ctx.drawImage(frame.source.image,frame.cutX,frame.cutY,frame.cutWidth,frame.cutHeight,0,0,fw,
fh);this.fillPattern=this.renderer.gl?this.renderer.canvasToTexture(canvas,this.fillPattern):ctx.createPattern(canvas,"repeat");this.updateCanvas();this.dirty=!1}},updateCanvas:function(){var canvas=this.canvas;if(canvas.width!==this.width||canvas.height!==this.height)canvas.width=this.width,canvas.height=this.height,this.frame.setSize(this.width,this.height);if(!(!this.dirty||this.renderer&&this.renderer.gl)){canvas=this.context;var scaleX=this._tileScale.x,scaleY=this._tileScale.y,positionX=this._tilePosition.x,
positionY=this._tilePosition.y;canvas.clearRect(0,0,this.width,this.height);canvas.save();canvas.scale(scaleX,scaleY);canvas.translate(-positionX,-positionY);canvas.fillStyle=this.fillPattern;canvas.fillRect(positionX,positionY,this.width/scaleX,this.height/scaleY);canvas.restore()}this.dirty=!1},preDestroy:function(){this.renderer&&this.renderer.gl&&this.renderer.deleteTexture(this.fillPattern);CanvasPool.remove(this.canvas);CanvasPool.remove(this.fillCanvas);this.displayFrame=this.displayTexture=
this.fillCanvas=this.fillContext=this.fillPattern=null;this.texture.destroy();this.renderer=null},tilePositionX:{get:function(){return this._tilePosition.x},set:function(value){this._tilePosition.x=value;this.dirty=!0}},tilePositionY:{get:function(){return this._tilePosition.y},set:function(value){this._tilePosition.y=value;this.dirty=!0}},tileScaleX:{get:function(){return this._tileScale.x},set:function(value){this._tileScale.x=value;this.dirty=!0}},tileScaleY:{get:function(){return this._tileScale.y},
set:function(value){this._tileScale.y=value;this.dirty=!0}}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$gameobjects$tilesprite$TileSprite.js.map
