{
"version":3,
"file":"module$kaboom4.js",
"lineCount":2212,
"mappings":"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",
"sources":["kaboom4.js"],
"sourcesContent":["/*\n\nkaboom.js\nv0.4.1 \"Multiboom\"\n\na JavaScript game programming library\n\n= Author\ntga <tga@space55.xyz>\n\n= License\n\nCopyright (C) 2021 Replit\n\nThis program is free software: you can redistribute it and/or modify\nit under the terms of the GNU General Public License as published by\nthe Free Software Foundation, either version 3 of the License, or\n(at your option) any later version.\n\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\nGNU General Public License for more details.\n\nYou should have received a copy of the GNU General Public License\nalong with this program. If not, see <https://www.gnu.org/licenses/>.\n\n= Index\n\n(use the number at top border for quick search-jump)\n\n*11111111*\n| assets |\n*--------*\nassets loader / manager\n\n*22222*\n| app |\n*-----*\nmanages canvas DOM and inputs\n\n*33333*\n| gfx |\n*-----*\neverything visual\n\n*4444444*\n| audio |\n*-------*\neverything audio\n\n*555555*\n| math |\n*------*\nmath utils\n\n*666666*\n| game |\n*------*\nscene management, component system\n\n*7777777*\n| comps |\n*-------*\nbuilt-in components\n\n*8888888*\n| debug |\n*-------*\ndebug utils\n\n*99999999*\n| helper |\n*--------*\n\n*/\n\nconst kaboom = (gconf = {}) => {\n  /*\n\n*11111111*\n\nassets     *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  const ASCII_CHARS =\n    \" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\";\n  const DEF_FONT = \"unscii\";\n  const UNSCII_SRC =\n    \"data:image/png;base64,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\";\n\n  const assets = {\n    lastLoaderID: 0,\n    loadRoot: \"\",\n    loaders: {},\n    sprites: {},\n    sounds: {},\n    fonts: {},\n  };\n\n  function assetsInit() {\n    // default font unscii http://pelulamu.net/unscii/\n    loadFont(DEF_FONT, UNSCII_SRC, 8, 8);\n  }\n\n  function loadImg(src) {\n    const img = new Image();\n\n    img.crossOrigin = \"\";\n    img.src = src;\n\n    return new Promise((resolve, reject) => {\n      img.onload = () => {\n        resolve(img);\n      };\n      img.onerror = () => {\n        reject();\n      };\n    });\n  }\n\n  // make a new load tracker\n  // the game starts after all trackers are done()\n  function newLoader() {\n    const id = assets.lastLoaderID;\n    assets.loaders[id] = false;\n    assets.lastLoaderID++;\n    return {\n      done() {\n        assets.loaders[id] = true;\n      },\n    };\n  }\n\n  // get current load progress\n  function loadProgress() {\n    let total = 0;\n    let loaded = 0;\n\n    for (const id in assets.loaders) {\n      total += 1;\n      if (assets.loaders[id]) {\n        loaded += 1;\n      }\n    }\n\n    return loaded / total;\n  }\n\n  // global load path prefix\n  function loadRoot(path) {\n    if (path) {\n      assets.loadRoot = path;\n    }\n    return assets.loadRoot;\n  }\n\n  function isDataUrl(src) {\n    return src.startsWith(\"data:\");\n  }\n\n  // load a bitmap font to asset manager\n  function loadFont(name, src, gw, gh, chars) {\n    return new Promise((resolve, reject) => {\n      const loader = newLoader();\n      const path = isDataUrl(src) ? src : assets.loadRoot + src;\n\n      loadImg(path)\n        .then((img) => {\n          assets.fonts[name] = makeFont(\n            makeTex(img),\n            gw,\n            gh,\n            chars || ASCII_CHARS\n          );\n          resolve(assets.fonts[name]);\n        })\n        .catch(() => {\n          error(`failed to load font '${name}' from '${src}'`);\n          reject();\n        })\n        .finally(() => {\n          loader.done();\n        });\n    });\n  }\n\n  // TODO: use getSprite() functions for async settings\n  // load a sprite to asset manager\n  function loadSprite(name, src, conf = {}) {\n    // sliceX: num,\n    // sliceY: num,\n    // anims: { name: [num, num] }\n\n    // synchronously load sprite from local pixel data\n    //\n    // src could be either\n    //   - HTMLImageElement\n    //   - HTMLCanvasElement\n    //   - ImageData\n    //   - ImageBitmap\n    function loadRawSprite(name, src, conf = {}) {\n      const frames = [];\n      const tex = makeTex(src);\n      const sliceX = conf.sliceX || 1;\n      const sliceY = conf.sliceY || 1;\n      const qw = 1 / sliceX;\n      const qh = 1 / sliceY;\n\n      for (let j = 0; j < sliceY; j++) {\n        for (let i = 0; i < sliceX; i++) {\n          frames.push(quad(i * qw, j * qh, qw, qh));\n        }\n      }\n\n      const sprite = {\n        tex: tex,\n        frames: frames,\n        anims: conf.anims || {},\n      };\n\n      assets.sprites[name] = sprite;\n\n      return sprite;\n    }\n\n    return new Promise((resolve, reject) => {\n      // from url\n      if (typeof src === \"string\") {\n        const loader = newLoader();\n        const path = isDataUrl(src) ? src : assets.loadRoot + src;\n\n        loadImg(path)\n          .then((img) => {\n            resolve(loadRawSprite(name, img, conf));\n          })\n          .catch(() => {\n            error(`failed to load sprite '${name}' from '${src}'`);\n            reject();\n          })\n          .finally(() => {\n            loader.done();\n          });\n\n        return;\n      } else {\n        resolve(loadRawSprite(name, src, conf));\n      }\n    });\n  }\n\n  // load a sound to asset manager\n  function loadSound(name, src, conf = {}) {\n    return new Promise((resolve, reject) => {\n      // from url\n      if (typeof src === \"string\") {\n        const loader = newLoader();\n\n        fetch(assets.loadRoot + src)\n          .then((res) => {\n            return res.arrayBuffer();\n          })\n          .then((data) => {\n            return new Promise((resolve2, reject2) => {\n              audio.ctx.decodeAudioData(\n                data,\n                (buf) => {\n                  resolve2(buf);\n                },\n                (err) => {\n                  reject2();\n                }\n              );\n            });\n          })\n          .then((buf) => {\n            audio.sounds[name] = buf;\n          })\n          .catch(() => {\n            error(`failed to load sound '${name}' from '${src}'`);\n            reject();\n          })\n          .finally(() => {\n            loader.done();\n          });\n      }\n    });\n  }\n\n  /*\n\n*22222*\n\napp        *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  // app system init\n  const app = {\n    keyStates: {},\n    charInputted: [],\n    mouseState: \"up\",\n    mousePos: vec2(0, 0),\n    time: 0.0,\n    realTime: 0.0,\n    skipTime: false,\n    dt: 0.0,\n    scale: 1,\n    isTouch: false,\n  };\n\n  const keyMap = {\n    ArrowLeft: \"left\",\n    ArrowRight: \"right\",\n    ArrowUp: \"up\",\n    ArrowDown: \"down\",\n    \" \": \"space\",\n  };\n\n  const preventDefaultKeys = [\n    \"space\",\n    \"left\",\n    \"right\",\n    \"up\",\n    \"down\",\n    \"tab\",\n    \"f1\",\n    \"f2\",\n    \"f3\",\n    \"f4\",\n    \"f5\",\n    \"f6\",\n    \"f7\",\n    \"f8\",\n    \"f9\",\n    \"f10\",\n    \"f11\",\n  ];\n\n  let gl;\n\n  function appInit() {\n    app.canvas = gconf.canvas;\n\n    if (!app.canvas) {\n      app.canvas = document.createElement(\"canvas\");\n      const root = gconf.root || document.body;\n      root.appendChild(app.canvas);\n    }\n\n    app.scale = gconf.scale || 1;\n\n    if (gconf.fullscreen) {\n      app.canvas.width = window.innerWidth;\n      app.canvas.height = window.innerHeight;\n    } else {\n      app.canvas.width = (gconf.width || 640) * app.scale;\n      app.canvas.height = (gconf.height || 480) * app.scale;\n    }\n\n    const styles = [\"outline: none\"];\n\n    if (gconf.crisp) {\n      styles.push(\"image-rendering: pixelated\");\n      styles.push(\"image-rendering: crisp-edges\");\n    }\n\n    app.canvas.style = styles.join(\";\");\n    app.canvas.setAttribute(\"tabindex\", \"0\");\n\n    gl = app.canvas.getContext(\"webgl\", {\n      antialias: true,\n      depth: true,\n      stencil: true,\n      alpha: true,\n      preserveDrawingBuffer: true,\n    });\n\n    gfxInit();\n    audioInit();\n    assetsInit();\n\n    app.isTouch =\n      \"ontouchstart\" in window ||\n      navigator.maxTouchPoints > 0 ||\n      navigator.msMaxTouchPoints > 0;\n\n    app.canvas.addEventListener(\"contextmenu\", (e) => {\n      e.preventDefault();\n    });\n\n    app.canvas.addEventListener(\"mousemove\", (e) => {\n      app.mousePos = vec2(e.offsetX, e.offsetY).scale(1 / app.scale);\n    });\n\n    app.canvas.addEventListener(\"mousedown\", (e) => {\n      app.mouseState = \"pressed\";\n    });\n\n    app.canvas.addEventListener(\"mouseup\", (e) => {\n      app.mouseState = \"released\";\n    });\n\n    app.canvas.addEventListener(\"touchstart\", (e) => {\n      const t = e.touches[0];\n      app.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n      app.mouseState = \"pressed\";\n    });\n\n    app.canvas.addEventListener(\"touchmove\", (e) => {\n      const t = e.touches[0];\n      app.mousePos = vec2(t.clientX, t.clientY).scale(1 / app.scale);\n    });\n\n    app.canvas.addEventListener(\"keydown\", (e) => {\n      const k = keyMap[e.key] || e.key.toLowerCase();\n\n      if (preventDefaultKeys.includes(k)) {\n        e.preventDefault();\n      }\n\n      if (k.length === 1) {\n        app.charInputted.push(k);\n      }\n\n      if (k === \"space\") {\n        app.charInputted.push(\" \");\n      }\n\n      if (e.repeat) {\n        app.keyStates[k] = \"rpressed\";\n      } else {\n        app.keyStates[k] = \"pressed\";\n      }\n    });\n\n    app.canvas.addEventListener(\"keyup\", (e) => {\n      const k = keyMap[e.key] || e.key.toLowerCase();\n      app.keyStates[k] = \"released\";\n    });\n\n    app.canvas.focus();\n\n    document.addEventListener(\"visibilitychange\", (e) => {\n      switch (document.visibilityState) {\n        case \"visible\":\n          // prevent a surge of dt() when switch back after the tab being hidden for a while\n          app.skipTime = true;\n          audio.ctx.resume();\n          break;\n        case \"hidden\":\n          audio.ctx.suspend();\n          break;\n      }\n    });\n\n    if (gconf.debug) {\n      debug.showLog = true;\n    }\n  }\n\n  function processBtnState(s) {\n    if (s === \"pressed\" || s === \"rpressed\") {\n      return \"down\";\n    }\n    if (s === \"released\") {\n      return \"up\";\n    }\n    return s;\n  }\n\n  // check input state last frame\n  function mousePos(layer) {\n    const scene = curScene();\n\n    if (!layer) {\n      return app.mousePos.clone();\n    } else {\n      return scene.cam.ignore.includes(layer) ? mousePos() : scene.camMousePos;\n    }\n  }\n\n  function mouseIsClicked() {\n    return app.mouseState === \"pressed\";\n  }\n\n  function mouseIsDown() {\n    return app.mouseState === \"pressed\" || app.mouseState === \"down\";\n  }\n\n  function mouseIsReleased() {\n    return app.mouseState === \"released\";\n  }\n\n  function keyIsPressed(k) {\n    return app.keyStates[k] === \"pressed\";\n  }\n\n  function keyIsPressedRep(k) {\n    return app.keyStates[k] === \"pressed\" || app.keyStates[k] === \"rpressed\";\n  }\n\n  function keyIsDown(k) {\n    return (\n      app.keyStates[k] === \"pressed\" ||\n      app.keyStates[k] === \"rpressed\" ||\n      app.keyStates[k] === \"down\"\n    );\n  }\n\n  function keyIsReleased(k) {\n    return app.keyStates[k] === \"released\";\n  }\n\n  function charInputted() {\n    return app.charInputted;\n  }\n\n  // get delta time between last frame\n  function dt() {\n    return app.dt;\n  }\n\n  // get current running time\n  function time() {\n    return app.time;\n  }\n\n  // get a base64 png image of canvas\n  function screenshot() {\n    return app.canvas.toDataURL();\n  }\n\n  /*\n\n*33333*\n\ngfx        *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  const defVertSrc = `\nattribute vec3 a_pos;\nattribute vec2 a_uv;\nattribute vec4 a_color;\nvarying vec2 v_uv;\nvarying vec4 v_color;\nvoid main() {\n\tv_uv = a_uv;\n\tv_color = a_color;\n\tgl_Position = vec4(a_pos, 1.0);\n}\n`;\n\n  const defFragSrc = `\nprecision mediump float;\nvarying vec2 v_uv;\nvarying vec4 v_color;\nuniform sampler2D u_tex;\nvoid main() {\n\tgl_FragColor = v_color * texture2D(u_tex, v_uv);\n\tif (gl_FragColor.a == 0.0) {\n\t\tdiscard;\n\t}\n}\n`;\n\n  const STRIDE = 9;\n\n  const gfx = {\n    drawCalls: 0,\n    cam: vec2(0, 0),\n    transform: mat4(),\n    transformStack: [],\n  };\n\n  function gfxInit() {\n    gfx.mesh = makeBatchedMesh(65536, 65536);\n    gfx.prog = makeProgram(defVertSrc, defFragSrc);\n    gfx.defTex = makeTex(\n      new ImageData(new Uint8ClampedArray([255, 255, 255, 255]), 1, 1)\n    );\n    const c = gconf.clearColor || [0, 0, 0, 1];\n    gl.clearColor(c[0], c[1], c[2], c[3]);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    gl.enable(gl.DEPTH_TEST);\n    gl.enable(gl.BLEND);\n    gl.depthFunc(gl.LEQUAL);\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n  }\n\n  // draw all cached vertices in the batched renderer\n  function flush() {\n    gfx.mesh.flush();\n\n    if (!gfx.curTex) {\n      return;\n    }\n\n    gfx.mesh.bind();\n    gfx.prog.bind();\n    gfx.curTex.bind();\n\n    gl.vertexAttribPointer(0, 3, gl.FLOAT, false, STRIDE * 4, 0);\n    gl.enableVertexAttribArray(0);\n    gl.vertexAttribPointer(1, 2, gl.FLOAT, false, STRIDE * 4, 12);\n    gl.enableVertexAttribArray(1);\n    gl.vertexAttribPointer(2, 4, gl.FLOAT, false, STRIDE * 4, 20);\n    gl.enableVertexAttribArray(2);\n\n    gl.drawElements(gl.TRIANGLES, gfx.mesh.count(), gl.UNSIGNED_SHORT, 0);\n    gfx.drawCalls++;\n\n    gfx.prog.unbind();\n    gfx.mesh.unbind();\n    gfx.curTex = null;\n  }\n\n  function gfxFrameStart() {\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    gfx.drawCalls = 0;\n    gfx.transformStack = [];\n    gfx.transform = mat4();\n  }\n\n  function toNDC(pt) {\n    return vec2((pt.x / width()) * 2 - 1, (-pt.y / height()) * 2 + 1);\n  }\n\n  function gfxFrameEnd() {\n    flush();\n  }\n\n  // TODO: don't use push as prefix for these\n  function pushMatrix(m) {\n    gfx.transform = m.clone();\n  }\n\n  function pushTranslate(p) {\n    if (!p || (p.x === 0 && p.y === 0)) {\n      return;\n    }\n    gfx.transform = gfx.transform.translate(p);\n  }\n\n  function pushScale(p) {\n    if (!p || (p.x === 0 && p.y === 0)) {\n      return;\n    }\n    gfx.transform = gfx.transform.scale(p);\n  }\n\n  function pushRotateX(a) {\n    if (!a) {\n      return;\n    }\n    gfx.transform = gfx.transform.rotateX(a);\n  }\n\n  function pushRotateY(a) {\n    if (!a) {\n      return;\n    }\n    gfx.transform = gfx.transform.rotateY(a);\n  }\n\n  function pushRotateZ(a) {\n    if (!a) {\n      return;\n    }\n    gfx.transform = gfx.transform.rotateZ(a);\n  }\n\n  function pushTransform() {\n    gfx.transformStack.push(gfx.transform.clone());\n  }\n\n  function popTransform() {\n    if (gfx.transformStack.length > 0) {\n      gfx.transform = gfx.transformStack.pop();\n    }\n  }\n\n  // the batch renderer\n  function makeBatchedMesh(vcount, icount) {\n    const vbuf = gl.createBuffer();\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbuf);\n    gl.bufferData(gl.ARRAY_BUFFER, vcount * 32, gl.DYNAMIC_DRAW);\n    gl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n    const ibuf = gl.createBuffer();\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibuf);\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, icount * 2, gl.DYNAMIC_DRAW);\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n    let numIndices = 0;\n\n    return {\n      vbuf: vbuf,\n      ibuf: ibuf,\n      vqueue: [],\n      iqueue: [],\n\n      push(verts, indices) {\n        // TODO: deal with overflow\n        indices = indices.map((i) => {\n          return i + this.vqueue.length / STRIDE;\n        });\n        this.vqueue = this.vqueue.concat(verts);\n        this.iqueue = this.iqueue.concat(indices);\n      },\n\n      flush() {\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.vbuf);\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, new Float32Array(this.vqueue));\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf);\n        gl.bufferSubData(\n          gl.ELEMENT_ARRAY_BUFFER,\n          0,\n          new Uint16Array(this.iqueue)\n        );\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n\n        numIndices = this.iqueue.length;\n\n        this.iqueue = [];\n        this.vqueue = [];\n      },\n\n      bind() {\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.vbuf);\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.ibuf);\n      },\n\n      unbind() {\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\n      },\n\n      count() {\n        return numIndices;\n      },\n    };\n  }\n\n  function makeTex(data) {\n    const id = gl.createTexture();\n\n    gl.bindTexture(gl.TEXTURE_2D, id);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    return {\n      id: id,\n      width: data.width,\n      height: data.height,\n      bind() {\n        gl.bindTexture(gl.TEXTURE_2D, this.id);\n      },\n      unbind() {\n        gl.bindTexture(gl.TEXTURE_2D, null);\n      },\n    };\n  }\n\n  function makeProgram(vertSrc, fragSrc) {\n    const vertShader = gl.createShader(gl.VERTEX_SHADER);\n\n    gl.shaderSource(vertShader, vertSrc);\n    gl.compileShader(vertShader);\n\n    var msg = gl.getShaderInfoLog(vertShader);\n\n    if (msg) {\n      error(msg);\n    }\n\n    const fragShader = gl.createShader(gl.FRAGMENT_SHADER);\n\n    gl.shaderSource(fragShader, fragSrc);\n    gl.compileShader(fragShader);\n\n    var msg = gl.getShaderInfoLog(fragShader);\n\n    if (msg) {\n      error(msg);\n    }\n\n    const id = gl.createProgram();\n\n    gl.attachShader(id, vertShader);\n    gl.attachShader(id, fragShader);\n\n    gl.bindAttribLocation(id, 0, \"a_pos\");\n    gl.bindAttribLocation(id, 1, \"a_uv\");\n    gl.bindAttribLocation(id, 2, \"a_color\");\n\n    gl.linkProgram(id);\n\n    var msg = gl.getProgramInfoLog(id);\n\n    if (msg) {\n      error(msg);\n    }\n\n    return {\n      id: id,\n\n      bind() {\n        gl.useProgram(this.id);\n      },\n\n      unbind() {\n        gl.useProgram(null);\n      },\n\n      sendFloat(name, val) {\n        const loc = gl.getUniformLocation(this.id, name);\n        gl.uniform1f(loc, val);\n      },\n\n      sendVec2(name, x, y) {\n        const loc = gl.getUniformLocation(this.id, name);\n        gl.uniform2f(loc, x, y);\n      },\n\n      sendVec3(name, x, y, z) {\n        const loc = gl.getUniformLocation(this.id, name);\n        gl.uniform3f(loc, x, y, z);\n      },\n\n      sendVec4(name, x, y, z, w) {\n        const loc = gl.getUniformLocation(this.id, name);\n        gl.uniform4f(loc, x, y, z, w);\n      },\n\n      sendMat4(name, m) {\n        const loc = gl.getUniformLocation(this.id, name);\n        gl.uniformMatrix4fv(loc, false, new Float32Array(m));\n      },\n    };\n  }\n\n  function makeFont(tex, gw, gh, chars) {\n    const cols = tex.width / gw;\n    const rows = tex.height / gh;\n    const count = cols * rows;\n    const qw = 1.0 / cols;\n    const qh = 1.0 / rows;\n    const map = {};\n\n    chars = chars.split(\"\");\n\n    for (const [i, ch] of chars.entries()) {\n      map[ch] = vec2((i % cols) * qw, Math.floor(i / cols) * qh);\n    }\n\n    return {\n      tex: tex,\n      map: map,\n      qw: qw,\n      qh: qh,\n    };\n  }\n\n  // TODO: put texture and texture flush logic here\n  function drawRaw(verts, indices, tex = gfx.defTex) {\n    // flush on texture change\n    if (gfx.curTex !== tex) {\n      flush();\n      gfx.curTex = tex;\n    }\n\n    // update vertices to current transform matrix\n    verts = verts\n      .map((v) => {\n        const pt = toNDC(gfx.transform.multVec2(v.pos));\n        return [\n          pt.x,\n          pt.y,\n          v.pos.z,\n          v.uv.x,\n          v.uv.y,\n          v.color.r,\n          v.color.g,\n          v.color.b,\n          v.color.a,\n        ];\n      })\n      .flat();\n\n    gfx.mesh.push(verts, indices);\n  }\n\n  // draw a textured quad\n  function drawQuad(conf = {}) {\n    // conf: {\n    //\t   pos,\n    //\t   width,\n    //\t   height,\n    //\t   scale,\n    //\t   rot,\n    //\t   origin,\n    //\t   tex,\n    //\t   quad,\n    // }\n\n    const w = conf.width || 0;\n    const h = conf.height || 0;\n    const pos = conf.pos || vec2(0, 0);\n    const origin = originPt(conf.origin || DEF_ORIGIN);\n    const offset = origin.dot(vec2(w, h).scale(-0.5));\n    const scale = conf.scale === undefined ? vec2(1, 1) : vec2(conf.scale);\n    const rot = conf.rot || 0;\n    const q = conf.quad || quad(0, 0, 1, 1);\n    const z = conf.z === undefined ? 1 : 1 - conf.z;\n    const color = conf.color || rgba();\n\n    // TODO: (maybe) not use matrix transform here?\n    pushTransform();\n    pushTranslate(pos);\n    pushScale(scale);\n    pushRotateZ(rot);\n    pushTranslate(offset);\n\n    drawRaw(\n      [\n        {\n          pos: vec3(-w / 2, h / 2, z),\n          uv: vec2(q.x, q.y + q.h),\n          color: color,\n        },\n        {\n          pos: vec3(-w / 2, -h / 2, z),\n          uv: vec2(q.x, q.y),\n          color: color,\n        },\n        {\n          pos: vec3(w / 2, -h / 2, z),\n          uv: vec2(q.x + q.w, q.y),\n          color: color,\n        },\n        {\n          pos: vec3(w / 2, h / 2, z),\n          uv: vec2(q.x + q.w, q.y + q.h),\n          color: color,\n        },\n      ],\n      [0, 1, 3, 1, 2, 3],\n      conf.tex\n    );\n\n    popTransform();\n  }\n\n  function drawSprite(name, conf = {}) {\n    const spr = assets.sprites[name];\n\n    if (!spr) {\n      console.warn(`sprite not found: ${name}`);\n      return;\n    }\n\n    const q = { ...spr.frames[conf.frame || 0] };\n\n    if (conf.quad) {\n      q.x += conf.quad.x * q.w;\n      q.y += conf.quad.y * q.h;\n      q.w *= conf.quad.w;\n      q.h *= conf.quad.h;\n    }\n\n    const w = spr.tex.width * q.w;\n    const h = spr.tex.height * q.h;\n\n    drawQuad({\n      tex: spr.tex,\n      quad: q,\n      width: w,\n      height: h,\n      pos: conf.pos,\n      scale: conf.scale,\n      rot: conf.rot,\n      color: conf.color,\n      origin: conf.origin,\n      z: conf.z,\n    });\n  }\n\n  function drawRectStroke(pos, w, h, conf = {}) {\n    const offset = originPt(conf.origin || DEF_ORIGIN)\n      .dot(w, h)\n      .scale(0.5);\n    const p1 = pos.add(vec2(-w / 2, -h / 2)).sub(offset);\n    const p2 = pos.add(vec2(-w / 2, h / 2)).sub(offset);\n    const p3 = pos.add(vec2(w / 2, h / 2)).sub(offset);\n    const p4 = pos.add(vec2(w / 2, -h / 2)).sub(offset);\n\n    drawLine(p1, p2, conf);\n    drawLine(p2, p3, conf);\n    drawLine(p3, p4, conf);\n    drawLine(p4, p1, conf);\n  }\n\n  function drawRect(pos, w, h, conf = {}) {\n    drawQuad({\n      pos: pos,\n      width: w,\n      height: h,\n      scale: conf.scale,\n      rot: conf.rot,\n      color: conf.color,\n      origin: conf.origin,\n      z: conf.z,\n    });\n  }\n\n  // TODO: slow, use drawRaw() calc coords\n  function drawLine(p1, p2, conf = {}) {\n    const w = conf.width || 1;\n    const h = p1.dist(p2);\n    const rot = Math.PI / 2 - p1.angle(p2);\n\n    drawQuad({\n      pos: p1.add(p2).scale(0.5),\n      width: w,\n      height: h,\n      rot: rot,\n      origin: \"center\",\n      color: conf.color,\n      z: conf.z,\n    });\n  }\n\n  function drawText(txt, conf = {}) {\n    drawFmtText(fmtText(txt, conf));\n  }\n\n  // TODO: rotation\n  function drawFmtText(ftext) {\n    for (const ch of ftext.chars) {\n      drawQuad({\n        tex: ch.tex,\n        width: ch.tex.width * ch.quad.w,\n        height: ch.tex.height * ch.quad.h,\n        pos: ch.pos,\n        scale: ch.scale,\n        color: ch.color,\n        quad: ch.quad,\n        // TODO: topleft\n        origin: \"center\",\n        z: ch.z,\n      });\n    }\n  }\n\n  function drawPoly(conf = {}) {\n    // TODO\n  }\n\n  function drawCircle(conf = {}) {\n    // TODO\n  }\n\n  // get current canvas width\n  function width() {\n    return gl.drawingBufferWidth / app.scale;\n  }\n\n  // get current canvas height\n  function height() {\n    return gl.drawingBufferHeight / app.scale;\n  }\n\n  function originPt(orig) {\n    if (isVec2(orig)) {\n      return orig;\n    }\n    switch (orig) {\n      case \"topleft\":\n        return vec2(-1, -1);\n      case \"top\":\n        return vec2(0, -1);\n      case \"topright\":\n        return vec2(1, -1);\n      case \"left\":\n        return vec2(-1, 0);\n      case \"center\":\n        return vec2(0, 0);\n      case \"right\":\n        return vec2(1, 0);\n      case \"botleft\":\n        return vec2(-1, 1);\n      case \"bot\":\n        return vec2(0, 1);\n      case \"botright\":\n        return vec2(1, 1);\n    }\n  }\n\n  // format text and return a list of chars with their calculated position\n  function fmtText(text, conf = {}) {\n    const fontName = conf.font || DEF_FONT;\n    const font = assets.fonts[fontName];\n\n    if (!font) {\n      error(`font not found: '${fontName}'`);\n      return {\n        width: 0,\n        height: 0,\n        chars: [],\n      };\n    }\n\n    const chars = (text + \"\").split(\"\");\n    const gw = font.qw * font.tex.width;\n    const gh = font.qh * font.tex.height;\n    const size = conf.size || gh;\n    const scale = vec2(size / gh).dot(vec2(conf.scale || 1));\n    const cw = scale.x * gw;\n    const ch = scale.y * gh;\n    let curX = 0;\n    let th = ch;\n    let tw = 0;\n    const flines = [[]];\n\n    // check new lines and calc area size\n    for (const char of chars) {\n      // go new line if \\n or exceeds wrap value\n      if (char === \"\\n\" || (conf.width ? curX + cw > conf.width : false)) {\n        th += ch;\n        curX = 0;\n        flines.push([]);\n      }\n      if (char !== \"\\n\") {\n        flines[flines.length - 1].push(char);\n        curX += cw;\n      }\n      tw = Math.max(tw, curX);\n    }\n\n    if (conf.width) {\n      tw = conf.width;\n    }\n\n    // whole text offset\n    const fchars = [];\n    const pos = vec2(conf.pos);\n    const offset = originPt(conf.origin || DEF_ORIGIN).scale(0.5);\n    // this math is complicated i forgot how it works instantly\n    const ox = -offset.x * cw - (offset.x + 0.5) * (tw - cw);\n    const oy = -offset.y * ch - (offset.y + 0.5) * (th - ch);\n\n    flines.forEach((line, ln) => {\n      // line offset\n      const oxl = (tw - line.length * cw) * (offset.x + 0.5);\n\n      line.forEach((char, cn) => {\n        const qpos = font.map[char];\n        const x = cn * cw;\n        const y = ln * ch;\n        if (qpos) {\n          fchars.push({\n            tex: font.tex,\n            quad: quad(qpos.x, qpos.y, font.qw, font.qh),\n            ch: char,\n            pos: vec2(pos.x + x + ox + oxl, pos.y + y + oy),\n            color: conf.color,\n            origin: conf.origin,\n            scale: scale,\n            z: conf.z,\n          });\n        }\n      });\n    });\n\n    return {\n      width: tw,\n      height: th,\n      chars: fchars,\n    };\n  }\n\n  /*\n\n*4444444*\n\naudio      *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  // audio system init\n  const audio = {};\n\n  function audioInit() {\n    audio.sounds = {};\n    audio.ctx = new (window.AudioContext || window.webkitAudioContext)();\n    audio.gainNode = audio.ctx.createGain();\n    audio.gainNode.gain.value = 1;\n    audio.gainNode.connect(audio.ctx.destination);\n  }\n\n  // get / set master volume\n  function volume(v) {\n    if (v !== undefined) {\n      audio.gainNode.gain.value = v;\n    }\n    return audio.gainNode.gain.value;\n  }\n\n  // plays a sound, returns a control handle\n  function play(id, conf = {}) {\n    const sound = audio.sounds[id];\n\n    if (!sound) {\n      error(`sound not found: \"${id}\"`);\n      return;\n    }\n\n    const srcNode = audio.ctx.createBufferSource();\n\n    srcNode.buffer = sound;\n    srcNode.loop = conf.loop ? true : false;\n\n    const gainNode = audio.ctx.createGain();\n\n    srcNode.connect(gainNode);\n    gainNode.connect(audio.gainNode);\n    srcNode.start();\n\n    let paused = false;\n    let stopped = false;\n    let speed = 1;\n\n    const handle = {\n      stop() {\n        srcNode.stop();\n        stopped = true;\n      },\n\n      resume() {\n        if (paused) {\n          srcNode.playbackRate.value = speed;\n          paused = false;\n        }\n      },\n\n      pause() {\n        srcNode.playbackRate.value = 0;\n        paused = true;\n      },\n\n      paused() {\n        return paused;\n      },\n\n      stopped() {\n        return stopped;\n      },\n\n      speed(val) {\n        if (val !== undefined) {\n          speed = Math.clamp(val, 0, 2);\n          if (!paused) {\n            srcNode.playbackRate.value = speed;\n          }\n        }\n        return speed;\n      },\n\n      detune(val) {\n        if (!srcNode.detune) {\n          return 0;\n        }\n        if (val !== undefined) {\n          srcNode.detune.value = Math.clamp(val, -1200, 1200);\n        }\n        return srcNode.detune.value;\n      },\n\n      volume(val) {\n        if (val !== undefined) {\n          gainNode.gain.value = Math.clamp(val, 0, 3);\n        }\n        return gainNode.gain.value;\n      },\n\n      loop() {\n        srcNode.loop = true;\n      },\n\n      unloop() {\n        srcNode.loop = false;\n      },\n    };\n\n    handle.speed(conf.speed);\n    handle.detune(conf.detune);\n    handle.volume(conf.volume);\n\n    return handle;\n  }\n\n  /*\n\n*555555*\n\nmath       *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  Math.radians = function (degrees) {\n    return (degrees * Math.PI) / 180;\n  };\n\n  Math.degrees = function (radians) {\n    return (radians * 180) / Math.PI;\n  };\n\n  Math.clamp = function (val, min, max) {\n    return Math.min(Math.max(val, min), max);\n  };\n\n  function lerp(a, b, t) {\n    return a + (b - a) * t * dt();\n  }\n\n  function map(v, l1, h1, l2, h2) {\n    return l2 + ((v - l1) / (h1 - l1)) * (h2 - l2);\n  }\n\n  function vec3(x, y, z) {\n    return {\n      x: x,\n      y: y,\n      z: z,\n    };\n  }\n\n  function vec2(x, y) {\n    if (isVec2(x) && y === undefined) {\n      return vec2(x.x, x.y);\n    }\n\n    return {\n      x: x !== undefined ? x : 0,\n      y: y !== undefined ? y : x !== undefined ? x : 0,\n      clone() {\n        return vec2(this.x, this.y);\n      },\n      add(...p2) {\n        p2 = vec2(...p2);\n        return vec2(this.x + p2.x, this.y + p2.y);\n      },\n      sub(...p2) {\n        p2 = vec2(...p2);\n        return vec2(this.x - p2.x, this.y - p2.y);\n      },\n      scale(s) {\n        return vec2(this.x * s, this.y * s);\n      },\n      dist(...p2) {\n        p2 = vec2(...p2);\n        return Math.sqrt(\n          (this.x - p2.x) * (this.x - p2.x) + (this.y - p2.y) * (this.y - p2.y)\n        );\n      },\n      len() {\n        return this.dist(vec2(0, 0));\n      },\n      unit() {\n        return this.scale(1 / this.len());\n      },\n      normal() {\n        return vec2(this.y, -this.x);\n      },\n      dot(...p2) {\n        p2 = vec2(...p2);\n        return vec2(this.x * p2.x, this.y * p2.y);\n      },\n      angle(...p2) {\n        p2 = vec2(...p2);\n        return Math.atan2(this.y - p2.y, this.x - p2.x);\n      },\n      lerp(p2, t) {\n        return vec2(lerp(this.x, p2.x, t), lerp(this.y, p2.y, t));\n      },\n      eq(other) {\n        return this.x === other.x && this.y === other.y;\n      },\n      str() {\n        return `(${this.x}, ${this.y})`;\n      },\n    };\n  }\n\n  // TODO: terrible name\n  function vec2FromAngle(a) {\n    return vec2(Math.cos(a), Math.sin(a));\n  }\n\n  function isVec2(p) {\n    return p !== undefined && p.x !== undefined && p.y !== undefined;\n  }\n\n  function isColor(c) {\n    return (\n      c !== undefined &&\n      c.r !== undefined &&\n      c.g !== undefined &&\n      c.b !== undefined &&\n      c.a !== undefined\n    );\n  }\n\n  function rgb(r, g, b) {\n    return rgba(r, g, b, 1);\n  }\n\n  function rgba(r, g, b, a) {\n    if (arguments.length === 0) {\n      return rgba(1, 1, 1, 1);\n    }\n\n    return {\n      r: r,\n      g: g,\n      b: b,\n      a: a === undefined ? 1 : a,\n      clone() {\n        return rgba(this.r, this.g, this.b, this.a);\n      },\n      lighten(a) {\n        return rgba(this.r + a, this.g + a, this.b + a, this.a);\n      },\n      darken(a) {\n        return this.lighten(-a);\n      },\n      eq(other) {\n        return (\n          this.r === other.r &&\n          this.g === other.g &&\n          this.b === other.g &&\n          this.a === other.a\n        );\n      },\n    };\n  }\n\n  function quad(x, y, w, h) {\n    return {\n      x: x,\n      y: y,\n      w: w,\n      h: h,\n      clone() {\n        return quad(this.x, this.y, this.w, this.h);\n      },\n      eq(other) {\n        return (\n          this.x === other.x &&\n          this.y === other.y &&\n          this.w === other.w &&\n          this.h === other.h\n        );\n      },\n    };\n  }\n\n  function colRectRect(r1, r2) {\n    return (\n      r1.p2.x >= r2.p1.x &&\n      r1.p1.x <= r2.p2.x &&\n      r1.p2.y >= r2.p1.y &&\n      r1.p1.y <= r2.p2.y\n    );\n  }\n\n  function overlapRectRect(r1, r2) {\n    return (\n      r1.p2.x > r2.p1.x &&\n      r1.p1.x < r2.p2.x &&\n      r1.p2.y > r2.p1.y &&\n      r1.p1.y < r2.p2.y\n    );\n  }\n\n  function colLineLine(l1, l2) {\n    const a =\n      ((l2.p2.x - l2.p1.x) * (l1.p1.y - l2.p1.y) -\n        (l2.p2.y - l2.p1.y) * (l1.p1.x - l2.p1.x)) /\n      ((l2.p2.y - l2.p1.y) * (l1.p2.x - l1.p1.x) -\n        (l2.p2.x - l2.p1.x) * (l1.p2.y - l1.p1.y));\n    const b =\n      ((l1.p2.x - l1.p1.x) * (l1.p1.y - l2.p1.y) -\n        (l1.p2.y - l1.p1.y) * (l1.p1.x - l2.p1.x)) /\n      ((l2.p2.y - l2.p1.y) * (l1.p2.x - l1.p1.x) -\n        (l2.p2.x - l2.p1.x) * (l1.p2.y - l1.p1.y));\n    return a >= 0.0 && a <= 1.0 && b >= 0.0 && b <= 1.0;\n  }\n\n  function colRectLine(r, l) {\n    if (colRectPt(r, l.p1) || colRectPt(r, l.p2)) {\n      return true;\n    }\n    return (\n      colLineLine(l, makeLine(r.p1, vec2(r.p2.x, r.p1.y))) ||\n      colLineLine(l, makeLine(vec2(r.p2.x, r.p1.y), r.p2)) ||\n      colLineLine(l, makeLine(r.p2, vec2(r.p1.x, r.p2.y))) ||\n      colLineLine(l, makeLine(vec2(r.p1.x, r.p2.y), r.p1))\n    );\n  }\n\n  function colRectPt(r, pt) {\n    return pt.x >= r.p1.x && pt.x <= r.p2.x && pt.y >= r.p1.y && pt.y < r.p2.y;\n  }\n\n  function makeLine(p1, p2) {\n    return {\n      p1: p1.clone(),\n      p2: p2.clone(),\n      clone() {\n        return makeLine(this.p1, this.p2);\n      },\n    };\n  }\n\n  function mat4(m) {\n    return {\n      m: m ? [...m] : [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n\n      clone() {\n        return mat4(this.m);\n      },\n\n      mult(other) {\n        const out = [];\n\n        for (let i = 0; i < 4; i++) {\n          for (let j = 0; j < 4; j++) {\n            out[i * 4 + j] =\n              this.m[0 * 4 + j] * other.m[i * 4 + 0] +\n              this.m[1 * 4 + j] * other.m[i * 4 + 1] +\n              this.m[2 * 4 + j] * other.m[i * 4 + 2] +\n              this.m[3 * 4 + j] * other.m[i * 4 + 3];\n          }\n        }\n\n        return mat4(out);\n      },\n\n      multVec4(p) {\n        return {\n          x:\n            p.x * this.m[0] +\n            p.y * this.m[4] +\n            p.z * this.m[8] +\n            p.w * this.m[12],\n          y:\n            p.x * this.m[1] +\n            p.y * this.m[5] +\n            p.z * this.m[9] +\n            p.w * this.m[13],\n          z:\n            p.x * this.m[2] +\n            p.y * this.m[6] +\n            p.z * this.m[10] +\n            p.w * this.m[14],\n          w:\n            p.x * this.m[3] +\n            p.y * this.m[7] +\n            p.z * this.m[11] +\n            p.w * this.m[15],\n        };\n      },\n\n      multVec3(p) {\n        const p4 = this.multVec4({\n          x: p.x,\n          y: p.y,\n          z: p.z,\n          w: 1.0,\n        });\n        return {\n          x: p4.x,\n          y: p4.y,\n          z: p4.z,\n        };\n      },\n\n      scale(s) {\n        return this.mult(\n          mat4([s.x, 0, 0, 0, 0, s.y, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1])\n        );\n      },\n\n      translate(p) {\n        return this.mult(\n          mat4([1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, p.x, p.y, 0, 1])\n        );\n      },\n\n      rotateX(a) {\n        return this.mult(\n          mat4([\n            1,\n            0,\n            0,\n            0,\n            0,\n            Math.cos(a),\n            -Math.sin(a),\n            0,\n            0,\n            Math.sin(a),\n            Math.cos(a),\n            0,\n            0,\n            0,\n            0,\n            1,\n          ])\n        );\n      },\n\n      rotateY(a) {\n        return this.mult(\n          mat4([\n            Math.cos(a),\n            0,\n            -Math.sin(a),\n            0,\n            0,\n            1,\n            0,\n            0,\n            Math.sin(a),\n            0,\n            Math.cos(a),\n            0,\n            0,\n            0,\n            0,\n            1,\n          ])\n        );\n      },\n\n      rotateZ(a) {\n        return this.mult(\n          mat4([\n            Math.cos(a),\n            -Math.sin(a),\n            0,\n            0,\n            Math.sin(a),\n            Math.cos(a),\n            0,\n            0,\n            0,\n            0,\n            1,\n            0,\n            0,\n            0,\n            0,\n            1,\n          ])\n        );\n      },\n\n      multVec2(p) {\n        return vec2(\n          p.x * this.m[0] + p.y * this.m[4] + 0 * this.m[8] + 1 * this.m[12],\n          p.x * this.m[1] + p.y * this.m[5] + 0 * this.m[9] + 1 * this.m[13]\n        );\n      },\n\n      invert() {\n        const out = [];\n\n        const f00 = this.m[10] * this.m[15] - this.m[14] * this.m[11];\n        const f01 = this.m[9] * this.m[15] - this.m[13] * this.m[11];\n        const f02 = this.m[9] * this.m[14] - this.m[13] * this.m[10];\n        const f03 = this.m[8] * this.m[15] - this.m[12] * this.m[11];\n        const f04 = this.m[8] * this.m[14] - this.m[12] * this.m[10];\n        const f05 = this.m[8] * this.m[13] - this.m[12] * this.m[9];\n        const f06 = this.m[6] * this.m[15] - this.m[14] * this.m[7];\n        const f07 = this.m[5] * this.m[15] - this.m[13] * this.m[7];\n        const f08 = this.m[5] * this.m[14] - this.m[13] * this.m[6];\n        const f09 = this.m[4] * this.m[15] - this.m[12] * this.m[7];\n        const f10 = this.m[4] * this.m[14] - this.m[12] * this.m[6];\n        const f11 = this.m[5] * this.m[15] - this.m[13] * this.m[7];\n        const f12 = this.m[4] * this.m[13] - this.m[12] * this.m[5];\n        const f13 = this.m[6] * this.m[11] - this.m[10] * this.m[7];\n        const f14 = this.m[5] * this.m[11] - this.m[9] * this.m[7];\n        const f15 = this.m[5] * this.m[10] - this.m[9] * this.m[6];\n        const f16 = this.m[4] * this.m[11] - this.m[8] * this.m[7];\n        const f17 = this.m[4] * this.m[10] - this.m[8] * this.m[6];\n        const f18 = this.m[4] * this.m[9] - this.m[8] * this.m[5];\n\n        out[0] = this.m[5] * f00 - this.m[6] * f01 + this.m[7] * f02;\n        out[4] = -(this.m[4] * f00 - this.m[6] * f03 + this.m[7] * f04);\n        out[8] = this.m[4] * f01 - this.m[5] * f03 + this.m[7] * f05;\n        out[12] = -(this.m[4] * f02 - this.m[5] * f04 + this.m[6] * f05);\n\n        out[1] = -(this.m[1] * f00 - this.m[2] * f01 + this.m[3] * f02);\n        out[5] = this.m[0] * f00 - this.m[2] * f03 + this.m[3] * f04;\n        out[9] = -(this.m[0] * f01 - this.m[1] * f03 + this.m[3] * f05);\n        out[13] = this.m[0] * f02 - this.m[1] * f04 + this.m[2] * f05;\n\n        out[2] = this.m[1] * f06 - this.m[2] * f07 + this.m[3] * f08;\n        out[6] = -(this.m[0] * f06 - this.m[2] * f09 + this.m[3] * f10);\n        out[10] = this.m[0] * f11 - this.m[1] * f09 + this.m[3] * f12;\n        out[14] = -(this.m[0] * f08 - this.m[1] * f10 + this.m[2] * f12);\n\n        out[3] = -(this.m[1] * f13 - this.m[2] * f14 + this.m[3] * f15);\n        out[7] = this.m[0] * f13 - this.m[2] * f16 + this.m[3] * f17;\n        out[11] = -(this.m[0] * f14 - this.m[1] * f16 + this.m[3] * f18);\n        out[15] = this.m[0] * f15 - this.m[1] * f17 + this.m[2] * f18;\n\n        const det =\n          this.m[0] * out[0] +\n          this.m[1] * out[4] +\n          this.m[2] * out[8] +\n          this.m[3] * out[12];\n\n        for (let i = 0; i < 4; i++) {\n          for (let j = 0; j < 4; j++) {\n            out[i * 4 + j] *= 1.0 / det;\n          }\n        }\n\n        return mat4(out);\n      },\n    };\n  }\n\n  // easy sine wave\n  function wave(a, b, t = 1, off = 0) {\n    return a + ((Math.sin(time() * t + off) + 1) / 2) * (b - a);\n  }\n\n  // basic ANSI C LCG\n  const A = 1103515245;\n  const C = 12345;\n  const M = 2147483648;\n  const defRNG = makeRng(Date.now());\n\n  function makeRng(seed) {\n    return {\n      seed: seed,\n      gen(a, b) {\n        if (isVec2(a) && isVec2(b)) {\n          return vec2(this.gen(a.x, b.x), this.gen(a.y, b.y));\n        } else if (isColor(a) && isColor(b)) {\n          return rgba(\n            this.gen(a.r, b.r),\n            this.gen(a.g, b.g),\n            this.gen(a.b, b.b),\n            this.gen(a.a, b.a)\n          );\n        } else if (a !== undefined) {\n          if (b === undefined) {\n            return this.gen() * a;\n          } else {\n            return this.gen() * (b - a) + a;\n          }\n        } else if (a === undefined && b === undefined) {\n          this.seed = (A * this.seed + C) % M;\n          return this.seed / M;\n        } else {\n          error(\"invalid param to rand()\");\n        }\n      },\n    };\n  }\n\n  function randSeed(seed) {\n    defRNG.seed = seed;\n  }\n\n  function rand(a, b) {\n    return defRNG.gen(a, b);\n  }\n\n  function chance(p) {\n    return rand(0, 1) <= p;\n  }\n\n  function choose(list) {\n    return list[Math.floor(rand(list.length))];\n  }\n\n  function deepCopy(input) {\n    if (typeof input !== \"object\" || input === null) {\n      return input;\n    }\n\n    const out = Array.isArray(input) ? [] : {};\n\n    for (const key in input) {\n      out[key] = deepCopy(input[key]);\n    }\n\n    return out;\n  }\n\n  /*\n\n*666666*\n\ngame       *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  // TODO: comp registry?\n  // TODO: avoid comp fields direct assign / collision\n  // TODO: in-source doc on the component system\n\n  const DEF_GRAVITY = 980;\n  const DEF_ORIGIN = \"topleft\";\n\n  const game = {\n    loaded: false,\n    curScene: undefined,\n    paused: false,\n    scenes: {},\n    log: [],\n  };\n\n  // start describing a scene (this should be called before start())\n  function scene(name, cb) {\n    game.scenes[name] = {\n      init: cb,\n      initialized: false,\n\n      // event callbacks\n      events: {\n        add: [],\n        update: [],\n        draw: [],\n        destroy: [],\n        keyDown: [],\n        keyPress: [],\n        keyPressRep: [],\n        keyRelease: [],\n        mouseClick: [],\n        mouseRelease: [],\n        mouseDown: [],\n        charInput: [],\n      },\n\n      action: [],\n      render: [],\n\n      // in game pool\n      objs: new Map(),\n      lastID: 0,\n      timers: {},\n      lastTimerID: 0,\n\n      // cam\n      cam: {\n        pos: vec2(width() / 2, height() / 2),\n        scale: vec2(1, 1),\n        angle: 0,\n        shake: 0,\n        ignore: [],\n        mpos: vec2(0),\n      },\n\n      camMousePos: vec2(0),\n\n      // misc\n      layers: {},\n      gravity: DEF_GRAVITY,\n      data: {},\n    };\n  }\n\n  function curScene() {\n    return game.scenes[game.curScene];\n  }\n\n  // custom data kv store for scene\n  function sceneData() {\n    return curScene().data;\n  }\n\n  // register inputs for controlling debug features\n  function regDebugInputs() {\n    const dbg = debug;\n\n    keyPress(\"`\", () => {\n      dbg.showLog = !dbg.showLog;\n      log(`show log: ${dbg.showLog ? \"on\" : \"off\"}`);\n    });\n\n    keyPress(\"f1\", () => {\n      dbg.showArea = !dbg.showArea;\n      log(`show area: ${dbg.showArea ? \"on\" : \"off\"}`);\n    });\n\n    keyPress(\"f2\", () => {\n      dbg.hoverInfo = !dbg.hoverInfo;\n      log(`hover info: ${dbg.hoverInfo ? \"on\" : \"off\"}`);\n    });\n\n    keyPress(\"f8\", () => {\n      dbg.paused = !dbg.paused;\n      log(`${dbg.paused ? \"paused\" : \"unpaused\"}`);\n    });\n\n    keyPress(\"f7\", () => {\n      dbg.timeScale = Math.clamp(dbg.timeScale - 0.2, 0, 2);\n      log(`time scale: ${dbg.timeScale.toFixed(1)}`);\n    });\n\n    keyPress(\"f9\", () => {\n      dbg.timeScale = Math.clamp(dbg.timeScale + 0.2, 0, 2);\n      log(`time scale: ${dbg.timeScale.toFixed(1)}`);\n    });\n\n    keyPress(\"f10\", () => {\n      stepFrame();\n      log(`stepped frame`);\n    });\n  }\n\n  // switch to a scene\n  function go(name, ...args) {\n    reload(name);\n    game.curScene = name;\n    const scene = game.scenes[name];\n    if (!scene) {\n      error(`scene not found: '${name}'`);\n      return;\n    }\n    if (!scene.initialized) {\n      scene.init(...args);\n      if (gconf.debug) {\n        regDebugInputs();\n      }\n      scene.initialized = true;\n    }\n  }\n\n  // reload a scene, reset all objs to their init states\n  function reload(name) {\n    if (!game.scenes[name]) {\n      error(`scene not found: '${name}'`);\n      return;\n    }\n    scene(name, game.scenes[name].init);\n  }\n\n  function layers(list, def) {\n    const scene = curScene();\n\n    if (!scene) {\n      return;\n    }\n\n    const each = 0.5 / list.length;\n\n    list.forEach((name, i) => {\n      scene.layers[name] = 0.5 + each * i;\n    });\n\n    if (def) {\n      scene.defLayer = def;\n    }\n  }\n\n  function camPos(...pos) {\n    const cam = curScene().cam;\n    if (pos.length > 0) {\n      cam.pos = vec2(...pos);\n    }\n    return cam.pos.clone();\n  }\n\n  function camScale(...scale) {\n    const cam = curScene().cam;\n    if (scale.length > 0) {\n      cam.scale = vec2(...scale);\n    }\n    return cam.scale.clone();\n  }\n\n  function camRot(angle) {\n    const cam = curScene().cam;\n    if (angle !== undefined) {\n      cam.angle = angle;\n    }\n    return cam.angle;\n  }\n\n  function camShake(intensity) {\n    const cam = curScene().cam;\n    cam.shake = intensity;\n  }\n\n  function camIgnore(layers) {\n    const cam = curScene().cam;\n    cam.ignore = layers;\n  }\n\n  function add(comps) {\n    const obj = {\n      hidden: false,\n      paused: false,\n      _tags: [],\n\n      _events: {\n        add: [],\n        update: [],\n        draw: [],\n        destroy: [],\n        debugInfo: [],\n      },\n\n      // use a comp\n      use(comp) {\n        if (comp === undefined) {\n          return;\n        }\n\n        const type = typeof comp;\n\n        // tags\n        if (type === \"string\") {\n          this._tags.push(comp);\n          return;\n        }\n\n        if (type !== \"object\") {\n          error(`invalid comp type: ${type}`);\n          return;\n        }\n\n        // multi comps\n        if (Array.isArray(comp)) {\n          for (const c of comp) {\n            this.use(c);\n          }\n          return;\n        }\n\n        for (const k in comp) {\n          // event / custom method\n          if (typeof comp[k] === \"function\") {\n            if (this._events[k]) {\n              this._events[k].push(comp[k].bind(this));\n            } else {\n              this[k] = comp[k].bind(this);\n            }\n            continue;\n          }\n\n          // TODO: deal with getter / setters\n          // fields\n          this[k] = comp[k];\n        }\n      },\n\n      // if obj is current in scene\n      exists() {\n        return this._sceneID !== undefined;\n      },\n\n      // if obj has certain tag\n      is(tag) {\n        if (tag === \"*\") {\n          return true;\n        }\n        if (Array.isArray(tag)) {\n          for (const t of tag) {\n            if (!this._tags.includes(t)) {\n              return false;\n            }\n          }\n          return true;\n        }\n        return this._tags.includes(tag);\n      },\n\n      on(event, cb) {\n        if (!this._events[event]) {\n          this._events[event] = [];\n        }\n        this._events[event].push(cb);\n      },\n\n      action(cb) {\n        this.on(\"update\", cb);\n      },\n\n      trigger(event, ...args) {\n        if (this._events[event]) {\n          for (const f of this._events[event]) {\n            f(...args);\n          }\n        }\n        const scene = curScene();\n        const events = scene.events[event];\n        if (events) {\n          for (const ev of events) {\n            if (this.is(ev.tag)) {\n              ev.cb(this);\n            }\n          }\n        }\n      },\n\n      addTag(t) {\n        if (this.is(t)) {\n          return;\n        }\n        this._tags.push(t);\n      },\n\n      removeTag(t) {\n        const idx = this._tags.indexOf(t);\n        if (idx > -1) {\n          this._tags.splice(idx, 1);\n        }\n      },\n    };\n\n    obj.use(comps);\n\n    const scene = curScene();\n\n    scene.objs.set(scene.lastID, obj);\n    obj._sceneID = scene.lastID;\n    scene.lastID++;\n\n    obj.trigger(\"add\");\n\n    for (const e of scene.events.add) {\n      if (obj.is(e.tag)) {\n        e.cb(obj);\n      }\n    }\n\n    return obj;\n  }\n\n  function readd(obj) {\n    if (!obj.exists()) {\n      return;\n    }\n\n    const scene = curScene();\n\n    scene.objs.delete(obj._sceneID);\n    scene.objs.set(scene.lastID, obj);\n    obj._sceneID = scene.lastID;\n    scene.lastID++;\n\n    return obj;\n  }\n\n  // add an event to a tag\n  function on(event, tag, cb) {\n    const scene = curScene();\n    if (!scene.events[event]) {\n      scene.events[event] = [];\n    }\n    scene.events[event].push({\n      tag: tag,\n      cb: cb,\n    });\n  }\n\n  // add update event to a tag or global update\n  function action(tag, cb) {\n    if (typeof tag === \"function\" && cb === undefined) {\n      curScene().action.push(tag);\n    } else {\n      on(\"update\", tag, cb);\n    }\n  }\n\n  // add draw event to a tag or global draw\n  function render(tag, cb) {\n    if (typeof tag === \"function\" && cb === undefined) {\n      curScene().render.push(tag);\n    } else {\n      on(\"update\", tag, cb);\n    }\n  }\n\n  // add an event that runs with objs with t1 collides with objs with t2\n  function collides(t1, t2, f) {\n    action(t1, (o1) => {\n      o1._checkCollisions(t2, (o2) => {\n        f(o1, o2);\n      });\n    });\n  }\n\n  // add an event that runs with objs with t1 overlaps with objs with t2\n  function overlaps(t1, t2, f) {\n    action(t1, (o1) => {\n      o1._checkOverlaps(t2, (o2) => {\n        f(o1, o2);\n      });\n    });\n  }\n\n  // add an event that runs when objs with tag t is clicked\n  function clicks(t, f) {\n    action(t, (o) => {\n      if (o.isClicked()) {\n        f(o);\n      }\n    });\n  }\n\n  // add an event that'd be run after t\n  function wait(t, f) {\n    if (f) {\n      const scene = curScene();\n      scene.timers[scene.lastTimerID] = {\n        time: t,\n        cb: f,\n      };\n      scene.lastTimerID++;\n    } else {\n      return new Promise((r) => wait(t, r));\n    }\n  }\n\n  // TODO: return control handle\n  // add an event that's run every t seconds\n  function loop(t, f) {\n    const newF = () => {\n      f();\n      wait(t, newF);\n    };\n    newF();\n  }\n\n  function pushKeyEvent(e, k, f) {\n    if (Array.isArray(k)) {\n      for (const key of k) {\n        pushKeyEvent(e, key, f);\n      }\n    } else {\n      const scene = curScene();\n      scene.events[e].push({\n        key: k,\n        cb: f,\n      });\n    }\n  }\n\n  // input callbacks\n  function keyDown(k, f) {\n    pushKeyEvent(\"keyDown\", k, f);\n  }\n\n  function keyPress(k, f) {\n    pushKeyEvent(\"keyPress\", k, f);\n  }\n\n  function keyPressRep(k, f) {\n    pushKeyEvent(\"keyPressRep\", k, f);\n  }\n\n  function keyRelease(k, f) {\n    pushKeyEvent(\"keyRelease\", k, f);\n  }\n\n  function charInput(f) {\n    const scene = curScene();\n    scene.events.charInput.push({\n      cb: f,\n    });\n  }\n\n  function mouseDown(f) {\n    const scene = curScene();\n    scene.events.mouseDown.push({\n      cb: f,\n    });\n  }\n\n  function mouseClick(f) {\n    const scene = curScene();\n    scene.events.mouseClick.push({\n      cb: f,\n    });\n  }\n\n  function mouseRelease(f) {\n    const scene = curScene();\n    scene.events.mouseRelease.push({\n      cb: f,\n    });\n  }\n\n  // get all objects with tag\n  function get(t) {\n    const scene = curScene();\n    const objs = [...scene.objs.values()];\n\n    if (!t) {\n      return objs;\n    } else {\n      return objs.filter((obj) => obj.is(t));\n    }\n  }\n\n  // apply a function to all objects currently in scene with tag t\n  function every(t, f) {\n    if (typeof t === \"function\" && f === undefined) {\n      get().forEach(t);\n    } else {\n      get(t).forEach(f);\n    }\n  }\n\n  // every but in reverse order\n  function revery(t, f) {\n    if (typeof t === \"function\" && f === undefined) {\n      get().reverse().forEach(t);\n    } else {\n      get(t).reverse().forEach(f);\n    }\n  }\n\n  // destroy an obj\n  function destroy(obj) {\n    if (!obj.exists()) {\n      return;\n    }\n\n    const scene = curScene();\n\n    if (!scene) {\n      return;\n    }\n\n    obj.trigger(\"destroy\");\n    scene.objs.delete(obj._sceneID);\n    delete obj._sceneID;\n  }\n\n  // destroy all obj with the tag\n  function destroyAll(t) {\n    every(t, (obj) => {\n      destroy(obj);\n    });\n  }\n\n  // get / set gravity\n  function gravity(g) {\n    const scene = curScene();\n    if (g !== undefined) {\n      scene.gravity = g;\n    }\n    return scene.gravity;\n  }\n\n  const LOG_TIME = 6;\n\n  // TODO: cleaner pause logic\n  function gameFrame(ignorePause) {\n    const scene = curScene();\n\n    if (!scene) {\n      error(`scene not found: '${game.curScene}'`);\n      return;\n    }\n\n    const doUpdate = ignorePause || !debug.paused;\n\n    if (doUpdate) {\n      // update timers\n      for (const id in scene.timers) {\n        const t = scene.timers[id];\n        t.time -= dt();\n        if (t.time <= 0) {\n          t.cb();\n          delete scene.timers[id];\n        }\n      }\n    }\n\n    gfxFrameStart();\n\n    // update every obj\n    revery((obj) => {\n      if (!obj.paused && doUpdate) {\n        obj.trigger(\"update\");\n      }\n    });\n\n    if (doUpdate) {\n      for (const f of scene.action) {\n        f();\n      }\n    }\n\n    // calculate camera matrix\n    const size = vec2(width(), height());\n    const cam = scene.cam;\n    const shake = vec2FromAngle(rand(0, Math.PI * 2)).scale(cam.shake);\n\n    cam.shake = lerp(cam.shake, 0, 5);\n\n    const camMat = mat4()\n      .translate(size.scale(0.5))\n      .scale(cam.scale)\n      .rotateZ(cam.angle)\n      .translate(size.scale(-0.5))\n      .translate(cam.pos.scale(-1).add(size.scale(0.5)).add(shake));\n    scene.camMousePos = camMat.invert().multVec2(mousePos());\n\n    // draw every obj\n    every((obj) => {\n      if (!obj.hidden) {\n        pushTransform();\n\n        if (!cam.ignore.includes(obj.layer)) {\n          pushMatrix(camMat);\n        }\n\n        obj.trigger(\"draw\");\n\n        popTransform();\n      }\n    });\n\n    for (const f of scene.render) {\n      f();\n    }\n\n    // TODO: make log and progress bar fixed size independent of global scale\n    // draw log\n    game.log = game.log.filter((l) => l.timer < debug.logTime);\n\n    if (game.log.length > debug.logMax) {\n      game.log = game.log.slice(0, debug.logMax);\n    }\n\n    const pos = vec2(0, height());\n\n    if (debug.showLog) {\n      game.log.forEach((log, i) => {\n        const col = (() => {\n          switch (log.type) {\n            case \"log\":\n              return rgb(1, 1, 1);\n            case \"error\":\n              return rgb(1, 0, 0.5);\n          }\n        })();\n\n        const ftext = fmtText(log.msg, {\n          pos: pos,\n          origin: \"botleft\",\n          color: col,\n          z: 1,\n        });\n\n        drawRect(pos, ftext.width, ftext.height, {\n          origin: \"botleft\",\n          color: rgba(0, 0, 0, 0.5),\n          z: 1,\n        });\n\n        drawFmtText(ftext);\n        log.timer += dt();\n        pos.y -= ftext.height;\n      });\n    }\n\n    gfxFrameEnd();\n  }\n\n  // TODO: on screen error message?\n  // start the game with a scene\n  // put main event loop in app module\n  function start(name, ...args) {\n    const frame = (t) => {\n      const realTime = t / 1000;\n      const realDt = realTime - app.realTime;\n\n      app.realTime = realTime;\n\n      if (!app.skipTime) {\n        app.dt = realDt * debug.timeScale;\n        app.time += app.dt;\n      }\n\n      app.skipTime = false;\n\n      if (!game.loaded) {\n        // if assets are not fully loaded, draw a progress bar\n\n        const progress = loadProgress();\n\n        if (progress === 1) {\n          game.loaded = true;\n          go(name, ...args);\n        } else {\n          gfxFrameStart();\n\n          const w = width() / 2;\n          const h = 12;\n          const pos = vec2(width() / 2, height() / 2).sub(vec2(w / 2, h / 2));\n\n          gfxFrameStart();\n          drawRectStroke(pos, w, h, { width: 2 });\n          drawRect(pos, w * progress, h);\n          gfxFrameEnd();\n        }\n      } else {\n        const scene = curScene();\n\n        if (!scene) {\n          error(`scene not found: '${game.curScene}'`);\n          return;\n        }\n\n        for (const e of scene.events.charInput) {\n          charInputted().forEach(e.cb);\n        }\n\n        // run input checks & callbacks\n        for (const e of scene.events.keyDown) {\n          if (keyIsDown(e.key)) {\n            e.cb(e.key);\n          }\n        }\n\n        for (const e of scene.events.keyPress) {\n          if (keyIsPressed(e.key)) {\n            e.cb(e.key);\n          }\n        }\n\n        for (const e of scene.events.keyPressRep) {\n          if (keyIsPressedRep(e.key)) {\n            e.cb(e.key);\n          }\n        }\n\n        for (const e of scene.events.keyRelease) {\n          if (keyIsReleased(e.key)) {\n            e.cb(e.key);\n          }\n        }\n\n        for (const e of scene.events.mouseDown) {\n          if (mouseIsDown()) {\n            e.cb();\n          }\n        }\n\n        for (const e of scene.events.mouseClick) {\n          if (mouseIsClicked()) {\n            e.cb();\n          }\n        }\n\n        for (const e of scene.events.mouseRelease) {\n          if (mouseIsReleased()) {\n            e.cb();\n          }\n        }\n\n        gameFrame();\n\n        for (const k in app.keyStates) {\n          app.keyStates[k] = processBtnState(app.keyStates[k]);\n        }\n\n        app.mouseState = processBtnState(app.mouseState);\n        app.charInputted = [];\n      }\n\n      requestAnimationFrame(frame);\n    };\n\n    requestAnimationFrame(frame);\n  }\n\n  /*\n\n*7777777*\n\ncomps      *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  // TODO: have velocity here?\n  function pos(...args) {\n    return {\n      pos: vec2(...args),\n\n      move(...args) {\n        const p = vec2(...args);\n        const dx = p.x * dt();\n        const dy = p.y * dt();\n\n        this.pos.x += dx;\n        this.pos.y += dy;\n      },\n\n      debugInfo() {\n        return {\n          pos: `(${~~this.pos.x}, ${~~this.pos.y})`,\n        };\n      },\n    };\n  }\n\n  // TODO: allow single number assignment\n  function scale(...args) {\n    return {\n      scale: vec2(...args),\n      flipX(s) {\n        this.scale.x = Math.sign(s) * Math.abs(this.scale.x);\n      },\n      flipY(s) {\n        this.scale.y = Math.sign(s) * Math.abs(this.scale.y);\n      },\n    };\n  }\n\n  function rotate(r) {\n    return {\n      angle: r,\n    };\n  }\n\n  function color(...args) {\n    return {\n      color: rgba(...args),\n    };\n  }\n\n  function origin(o) {\n    return {\n      origin: o,\n    };\n  }\n\n  function layer(z) {\n    return {\n      layer: z,\n      debugInfo() {\n        const scene = curScene();\n        return {\n          layer: this.layer || scene.defLayer,\n        };\n      },\n    };\n  }\n\n  // TODO: active flag\n  // TODO: tell which size collides\n  // TODO: dynamic update when size change\n  function area(p1, p2) {\n    const colliding = {};\n    const overlapping = {};\n\n    return {\n      area: {\n        p1: p1,\n        p2: p2,\n      },\n\n      areaWidth() {\n        const { p1, p2 } = this._worldArea();\n        return p2.x - p1.x;\n      },\n\n      areaHeight() {\n        const { p1, p2 } = this._worldArea();\n        return p2.y - p1.y;\n      },\n\n      draw() {\n        const showArea = debug.showArea;\n        const hoverInfo = debug.hoverInfo;\n\n        if (!showArea) {\n          return;\n        }\n\n        let width = showArea.width || 2;\n        const color = showArea.color || rgba(0, 1, 1, 1);\n        const hovered = this.isHovered();\n\n        if (hoverInfo && hovered) {\n          width += 2;\n        }\n\n        const a = this._worldArea();\n        const pos = vec2((a.p1.x + a.p2.x) / 2, (a.p1.y + a.p2.y) / 2);\n        const w = a.p2.x - a.p1.x;\n        const h = a.p2.y - a.p1.y;\n\n        drawRectStroke(a.p1, a.p2.x - a.p1.x, a.p2.y - a.p1.y, {\n          width: width / app.scale,\n          color: color,\n          z: 0.9,\n        });\n\n        const mpos = mousePos(this.layer || curScene().defLayer);\n\n        if (hoverInfo && hovered) {\n          const padding = vec2(6, 6).scale(1 / app.scale);\n          let bw = 0;\n          let bh = 0;\n          const lines = [];\n\n          const addLine = (txt) => {\n            const ftxt = fmtText(txt, {\n              size: 12 / app.scale,\n              pos: mpos.add(vec2(padding.x, padding.y + bh)),\n              z: 1,\n            });\n            lines.push(ftxt);\n            bw = ftxt.width > bw ? ftxt.width : bw;\n            bh += ftxt.height;\n          };\n\n          for (const tag of this._tags) {\n            addLine(`\"${tag}\"`);\n          }\n\n          for (const debugInfo of this._events.debugInfo) {\n            const info = debugInfo();\n\n            for (const field in info) {\n              addLine(`${field}: ${info[field]}`);\n            }\n          }\n\n          bw += padding.x * 2;\n          bh += padding.y * 2;\n\n          // background\n          drawRect(mpos, bw, bh, {\n            color: rgba(0, 0, 0, 1),\n            z: 1,\n          });\n\n          drawRectStroke(mpos, bw, bh, {\n            width: (width - 2) / app.scale,\n            color: rgba(0, 1, 1, 1),\n            z: 1,\n          });\n\n          for (const line of lines) {\n            drawFmtText(line);\n          }\n        }\n      },\n\n      clicks(f) {\n        this.action(() => {\n          if (this.isClicked()) {\n            f();\n          }\n        });\n      },\n\n      isClicked() {\n        return mouseIsClicked() && this.isHovered();\n      },\n\n      hovers(f) {\n        this.action(() => {\n          if (this.isHovered()) {\n            f();\n          }\n        });\n      },\n\n      hasPt(pt) {\n        const a = this._worldArea();\n        return colRectPt(\n          {\n            p1: a.p1,\n            p2: a.p2,\n          },\n          pt\n        );\n      },\n\n      isHovered() {\n        return this.hasPt(mousePos(this.layer || curScene().defLayer));\n      },\n\n      // push object out of other solid objects\n      resolve() {\n        const targets = [];\n\n        every((other) => {\n          if (other === this) {\n            return;\n          }\n\n          if (!other.solid) {\n            return;\n          }\n\n          if (!other.area) {\n            return;\n          }\n\n          if (this.layer !== other.layer) {\n            return;\n          }\n\n          const a1 = this._worldArea();\n          const a2 = other._worldArea();\n\n          if (!colRectRect(a1, a2)) {\n            return;\n          }\n\n          const disLeft = a1.p2.x - a2.p1.x;\n          const disRight = a2.p2.x - a1.p1.x;\n          const disTop = a1.p2.y - a2.p1.y;\n          const disBottom = a2.p2.y - a1.p1.y;\n          const min = Math.min(disLeft, disRight, disTop, disBottom);\n\n          let side;\n\n          switch (min) {\n            case disLeft:\n              this.pos.x -= disLeft;\n              side = \"right\";\n              break;\n            case disRight:\n              this.pos.x += disRight;\n              side = \"left\";\n              break;\n            case disTop:\n              this.pos.y -= disTop;\n              side = \"bottom\";\n              break;\n            case disBottom:\n              this.pos.y += disBottom;\n              side = \"top\";\n              break;\n          }\n\n          targets.push({\n            obj: other,\n            side: side,\n          });\n        });\n\n        return targets;\n      },\n\n      _checkCollisions(tag, f) {\n        every(tag, (obj) => {\n          if (this === obj) {\n            return;\n          }\n          if (colliding[obj._sceneID]) {\n            return;\n          }\n          if (this.isCollided(obj)) {\n            f(obj);\n            colliding[obj._sceneID] = obj;\n          }\n        });\n\n        for (const id in colliding) {\n          const obj = colliding[id];\n          if (!this.isCollided(obj)) {\n            delete colliding[id];\n          }\n        }\n      },\n\n      collides(tag, f) {\n        this.action(() => {\n          this._checkCollisions(tag, f);\n        });\n      },\n\n      // TODO: repetitive with collides\n      _checkOverlaps(tag, f) {\n        every(tag, (obj) => {\n          if (this === obj) {\n            return;\n          }\n          if (overlapping[obj._sceneID]) {\n            return;\n          }\n          if (this.isOverlapped(obj)) {\n            f(obj);\n            overlapping[obj._sceneID] = obj;\n          }\n        });\n\n        for (const id in overlapping) {\n          const obj = overlapping[id];\n          if (!this.isOverlapped(obj)) {\n            delete overlapping[id];\n          }\n        }\n      },\n\n      overlaps(tag, f) {\n        this.action(() => {\n          this._checkOverlaps(tag, f);\n        });\n      },\n\n      // TODO: cache\n      // TODO: use matrix mult for more accuracy and rotation?\n      _worldArea() {\n        const a = this.area;\n        const pos = this.pos || vec2(0);\n        const scale = this.scale || vec2(1);\n        const p1 = pos.add(a.p1.dot(scale));\n        const p2 = pos.add(a.p2.dot(scale));\n\n        const area = {\n          p1: vec2(Math.min(p1.x, p2.x), Math.min(p1.y, p2.y)),\n          p2: vec2(Math.max(p1.x, p2.x), Math.max(p1.y, p2.y)),\n        };\n\n        return area;\n      },\n\n      isCollided(other) {\n        if (!other.area) {\n          return false;\n        }\n\n        if (this.layer !== other.layer) {\n          return false;\n        }\n\n        const a1 = this._worldArea();\n        const a2 = other._worldArea();\n\n        return colRectRect(a1, a2);\n      },\n\n      isOverlapped(other) {\n        if (!other.area) {\n          return false;\n        }\n\n        if (this.layer !== other.layer) {\n          return false;\n        }\n\n        const a1 = this._worldArea();\n        const a2 = other._worldArea();\n\n        return overlapRectRect(a1, a2);\n      },\n    };\n  }\n\n  function getAreaFromSize(w, h, o) {\n    const size = vec2(w, h);\n    const offset = originPt(o || DEF_ORIGIN)\n      .dot(size)\n      .scale(-0.5);\n    return area(offset.sub(size.scale(0.5)), offset.add(size.scale(0.5)));\n  }\n\n  function sprite(id, conf = {}) {\n    const spr = assets.sprites[id];\n\n    if (!spr) {\n      error(`sprite not found: \"${id}\"`);\n      return;\n    }\n\n    const q = { ...spr.frames[0] };\n\n    if (conf.quad) {\n      q.x += conf.quad.x * q.w;\n      q.y += conf.quad.y * q.h;\n      q.w *= conf.quad.w;\n      q.h *= conf.quad.h;\n    }\n\n    const width = spr.tex.width * q.w;\n    const height = spr.tex.height * q.h;\n    let timer = 0;\n    let looping = false;\n    let curAnim = null;\n    const events = {};\n\n    return {\n      spriteID: id,\n      width: width,\n      height: height,\n      animSpeed: conf.animSpeed || 0.1,\n      frame: conf.frame || 0,\n      quad: conf.quad || quad(0, 0, 1, 1),\n\n      add() {\n        // add default area\n        if (!this.area && !conf.noArea) {\n          this.use(getAreaFromSize(this.width, this.height, this.origin));\n        }\n      },\n\n      draw() {\n        const scene = curScene();\n        const spr = assets.sprites[this.spriteID];\n        const q = spr.frames[this.frame];\n\n        drawSprite(this.spriteID, {\n          pos: this.pos,\n          scale: this.scale,\n          rot: this.angle,\n          color: this.color,\n          frame: this.frame,\n          origin: this.origin,\n          quad: this.quad,\n          z: scene.layers[this.layer || scene.defLayer],\n        });\n      },\n\n      update() {\n        if (!curAnim) {\n          return;\n        }\n\n        const speed = this.animSpeed;\n        const spr = assets.sprites[this.spriteID];\n        const anim = spr.anims[curAnim];\n\n        timer += dt();\n\n        if (timer >= this.animSpeed) {\n          // TODO: anim dir\n          this.frame++;\n          if (this.frame > anim[1]) {\n            if (looping) {\n              this.frame = anim[0];\n            } else {\n              this.frame--;\n              this.stop();\n            }\n          }\n          timer -= this.animSpeed;\n        }\n      },\n\n      play(name, loop) {\n        const spr = assets.sprites[this.spriteID];\n        const anim = spr.anims[name];\n\n        if (!anim) {\n          error(`anim not found: ${name}`);\n          return;\n        }\n\n        if (curAnim) {\n          this.stop();\n        }\n\n        curAnim = name;\n        this.frame = anim[0];\n        looping = loop === undefined ? true : loop;\n\n        if (events[name] && events[name].play) {\n          events[name].play();\n        }\n      },\n\n      stop() {\n        if (!curAnim) {\n          return;\n        }\n        if (events[curAnim] && events[curAnim].end) {\n          events[curAnim].end();\n        }\n        curAnim = null;\n      },\n\n      numFrames() {\n        const spr = assets.sprites[this.spriteID];\n        return spr.frames.length;\n      },\n\n      curAnim() {\n        return curAnim;\n      },\n\n      onAnimPlay(name, cb) {\n        if (!events[name]) {\n          events[name] = {};\n        }\n        events[name].play = cb;\n      },\n\n      onAnimEnd(name, cb) {\n        if (!events[name]) {\n          events[name] = {};\n        }\n        events[name].end = cb;\n      },\n\n      debugInfo() {\n        const info = {};\n        if (curAnim) {\n          info.curAnim = `\"${curAnim}\"`;\n        }\n        return info;\n      },\n    };\n  }\n\n  // TODO: add area\n  function text(t, size, conf = {}) {\n    return {\n      text: t,\n      textSize: size,\n      font: conf.font,\n\n      add() {\n        // add default area\n        if (!this.area && !conf.noArea) {\n          const scene = curScene();\n          const ftext = fmtText(this.text + \"\", {\n            pos: this.pos,\n            scale: this.scale,\n            rot: this.angle,\n            size: this.textSize,\n            origin: this.origin,\n            color: this.color,\n            font: this.font,\n            width: conf.width,\n            z: scene.layers[this.layer || scene.defLayer],\n          });\n          this.width = ftext.width / ((this.scale && this.scale.x) || 1);\n          this.height = ftext.height / ((this.scsale && this.scale.y) || 1);\n          this.use(getAreaFromSize(this.width, this.height, this.origin));\n        }\n      },\n\n      draw() {\n        const scene = curScene();\n\n        const ftext = fmtText(this.text + \"\", {\n          pos: this.pos,\n          scale: this.scale,\n          rot: this.angle,\n          size: this.textSize,\n          origin: this.origin,\n          color: this.color,\n          font: this.font,\n          width: conf.width,\n          z: scene.layers[this.layer || scene.defLayer],\n        });\n\n        this.width = ftext.tw;\n        this.height = ftext.th;\n\n        drawFmtText(ftext);\n      },\n    };\n  }\n\n  function rect(w, h, conf = {}) {\n    return {\n      width: w,\n      height: h,\n\n      add() {\n        // add default area\n        if (!this.area && !conf.noArea) {\n          this.use(getAreaFromSize(this.width, this.height, this.origin));\n        }\n      },\n\n      draw() {\n        const scene = curScene();\n\n        drawRect(this.pos, this.width, this.height, {\n          scale: this.scale,\n          rot: this.angle,\n          color: this.color,\n          origin: this.origin,\n          z: scene.layers[this.layer || scene.defLayer],\n        });\n      },\n    };\n  }\n\n  function solid() {\n    return {\n      solid: true,\n    };\n  }\n\n  function timer() {\n    return {\n      time: 0,\n      update() {\n        this.time += dt();\n      },\n    };\n  }\n\n  // maximum y velocity with body()\n  const DEF_MAX_VEL = 960;\n  const DEF_JUMP_FORCE = 480;\n\n  function body(conf = {}) {\n    let velY = 0;\n    let curPlatform = null;\n    const maxVel = conf.maxVel || DEF_MAX_VEL;\n\n    return {\n      jumpForce: conf.jumpForce !== undefined ? conf.jumpForce : DEF_JUMP_FORCE,\n\n      update() {\n        this.move(0, velY);\n\n        const targets = this.resolve();\n        let justOff = false;\n\n        // check if loses current platform\n        if (curPlatform) {\n          if (!curPlatform.exists() || !this.isCollided(curPlatform)) {\n            curPlatform = null;\n            justOff = true;\n          }\n        }\n\n        if (!curPlatform) {\n          velY = Math.min(velY + gravity() * dt(), maxVel);\n\n          // check if grounded to a new platform\n          for (const target of targets) {\n            if (target.side === \"bottom\" && velY > 0) {\n              curPlatform = target.obj;\n              velY = 0;\n              if (!justOff) {\n                this.trigger(\"grounded\", curPlatform);\n              }\n            } else if (target.side === \"top\" && velY < 0) {\n              velY = 0;\n              this.trigger(\"headbump\", target.obj);\n            }\n          }\n        }\n      },\n\n      grounded() {\n        return curPlatform !== null;\n      },\n\n      jump(force) {\n        curPlatform = null;\n        velY = -force || -this.jumpForce;\n      },\n    };\n  }\n\n  /*\n\n*8888888*\n\ndebug     *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  const debug = {\n    paused: false,\n    timeScale: 1,\n    showArea: false,\n    hoverInfo: false,\n    showLog: false,\n    logTime: 6,\n    logMax: 32,\n  };\n\n  function dbg() {\n    return debug;\n  }\n\n  function fps() {\n    return 1.0 / dt();\n  }\n\n  function objCount() {\n    const scene = curScene();\n    return scene.objs.size;\n  }\n\n  function stepFrame() {\n    gameFrame(true);\n  }\n\n  function error(msg) {\n    console.error(msg);\n    game.log.unshift({\n      type: \"error\",\n      msg: msg,\n      timer: 0,\n    });\n  }\n\n  function log(msg) {\n    console.log(msg);\n    game.log.unshift({\n      type: \"log\",\n      msg: msg,\n      timer: 0,\n    });\n  }\n\n  /*\n\n*99999999*\n\nhelper    *                     .            ~       +    .\n    .           .            ~          +\n            +          .                          .\n              .                      .\n @      .        ~           .                 @            +\n                                       +\n     .                                                 ~\n         ~            +           +\n              +                .      .               +\n      ~                   .                 +               ~\n   .       @        .                   ~           .\n                               .                           .\n\n*/\n\n  function addLevel(arr, conf = {}) {\n    const objs = [];\n    const offset = vec2(conf.pos);\n    let longRow = 0;\n\n    const level = {\n      getPos(...p) {\n        p = vec2(...p);\n        return vec2(offset.x + p.x * conf.width, offset.y + p.y * conf.height);\n      },\n\n      spawn(sym, p) {\n        const comps = (() => {\n          if (Array.isArray(sym)) {\n            return sym;\n          } else if (conf[sym]) {\n            if (typeof conf[sym] === \"function\") {\n              return conf[sym]();\n            } else if (Array.isArray(conf[sym])) {\n              return [...conf[sym]];\n            }\n          } else if (conf.any) {\n            return conf.any(sym);\n          }\n        })();\n\n        if (comps) {\n          comps.push(\n            pos(offset.x + p.x * conf.width, offset.y + p.y * conf.height)\n          );\n\n          const obj = add(comps);\n\n          objs.push(obj);\n\n          obj.use({\n            gridPos: p.clone(),\n\n            setGridPos(p) {\n              this.gridPos = p.clone();\n              this.pos = vec2(\n                offset.x + this.gridPos.x * conf.width,\n                offset.y + this.gridPos.y * conf.height\n              );\n            },\n\n            moveLeft() {\n              this.setGridPos(this.gridPos.add(vec2(-1, 0)));\n            },\n\n            moveRight() {\n              this.setGridPos(this.gridPos.add(vec2(1, 0)));\n            },\n\n            moveUp() {\n              this.setGridPos(this.gridPos.add(vec2(0, -1)));\n            },\n\n            moveDown() {\n              this.setGridPos(this.gridPos.add(vec2(0, 1)));\n            },\n          });\n        }\n      },\n\n      width() {\n        return longRow * conf.width;\n      },\n\n      height() {\n        return arr.length * conf.height;\n      },\n\n      destroy() {\n        for (const obj of objs) {\n          destroy(obj);\n        }\n      },\n    };\n\n    arr.forEach((row, i) => {\n      if (typeof row === \"string\") {\n        row = row.split(\"\");\n      }\n\n      longRow = Math.max(row.length, longRow);\n\n      row.forEach((sym, j) => {\n        level.spawn(sym, vec2(j, i));\n      });\n    });\n\n    return level;\n  }\n\n  const lib = {\n    start,\n    // asset load\n    loadRoot,\n    loadSprite,\n    loadSound,\n    loadFont,\n    newLoader,\n    // query\n    width,\n    height,\n    dt,\n    time,\n    screenshot,\n    // scene\n    scene,\n    go,\n    sceneData,\n    // misc\n    layers,\n    camPos,\n    camScale,\n    camRot,\n    camShake,\n    camIgnore,\n    gravity,\n    // obj\n    add,\n    readd,\n    destroy,\n    destroyAll,\n    get,\n    every,\n    // comps\n    pos,\n    scale,\n    rotate,\n    color,\n    origin,\n    layer,\n    area,\n    sprite,\n    text,\n    rect,\n    solid,\n    timer,\n    body,\n    // group events\n    on,\n    action,\n    render,\n    collides,\n    overlaps,\n    clicks,\n    // input\n    keyDown,\n    keyPress,\n    keyPressRep,\n    keyRelease,\n    charInput,\n    mouseDown,\n    mouseClick,\n    mouseRelease,\n    mousePos,\n    keyIsDown,\n    keyIsPressed,\n    keyIsPressedRep,\n    keyIsReleased,\n    mouseIsDown,\n    mouseIsClicked,\n    mouseIsReleased,\n    // timer\n    loop,\n    wait,\n    // audio\n    play,\n    volume,\n    // math\n    makeRng,\n    rand,\n    randSeed,\n    vec2,\n    rgb,\n    rgba,\n    quad,\n    choose,\n    chance,\n    lerp,\n    map,\n    wave,\n    // raw draw\n    drawSprite,\n    drawText,\n    drawRect,\n    drawRectStroke,\n    drawLine,\n    drawPoly,\n    drawCircle,\n    // debug\n    dbg,\n    objCount,\n    fps,\n    stepFrame,\n    log,\n    error,\n    // level\n    addLevel,\n  };\n\n  if (gconf.plugins) {\n    for (const src of gconf.plugins) {\n      const map = src(lib);\n      for (const k in map) {\n        lib[k] = map[k];\n      }\n    }\n  }\n\n  if (gconf.global) {\n    for (const k in lib) {\n      window[k] = lib[k];\n    }\n  }\n\n  appInit();\n\n  return lib;\n};\n\nexport default kaboom;\n"],
"names":["kaboom","gconf","assetsInit","loadFont","DEF_FONT","UNSCII_SRC","loadImg","src","img","Image","crossOrigin","Promise","resolve","reject","onload","img.onload","onerror","img.onerror","newLoader","id","assets","lastLoaderID","loaders","done","loadProgress","total","loaded","loadRoot","path","isDataUrl","startsWith","name","gw","gh","chars","loader","then","fonts","makeFont","makeTex","ASCII_CHARS","catch","error","finally","loadSprite","conf","loadRawSprite","frames","tex","sliceX","sliceY","qw","qh","j","i","push","quad","sprite","anims","sprites","loadSound","fetch","res","arrayBuffer","data","resolve2","reject2","audio","ctx","decodeAudioData","buf","err","sounds","appInit","app","canvas","document","createElement","root","body","appendChild","scale","fullscreen","width","window","innerWidth","height","innerHeight","styles","crisp","style","join","setAttribute","gl","getContext","antialias","depth","stencil","alpha","preserveDrawingBuffer","gfxInit","audioInit","isTouch","navigator","maxTouchPoints","msMaxTouchPoints","addEventListener","e","preventDefault","mousePos","vec2","offsetX","offsetY","mouseState","t","touches","clientX","clientY","k","keyMap","key","toLowerCase","preventDefaultKeys","includes","length","charInputted","repeat","keyStates","focus","visibilityState","skipTime","resume","suspend","debug","showLog","processBtnState","s","layer","scene","curScene","clone","cam","ignore","camMousePos","mouseIsClicked","mouseIsDown","mouseIsReleased","keyIsPressed","keyIsPressedRep","keyIsDown","keyIsReleased","dt","time","screenshot","toDataURL","gfx","mesh","makeBatchedMesh","prog","makeProgram","defVertSrc","defFragSrc","defTex","ImageData","Uint8ClampedArray","c","clearColor","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","enable","DEPTH_TEST","BLEND","depthFunc","LEQUAL","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","flush","curTex","bind","vertexAttribPointer","FLOAT","STRIDE","enableVertexAttribArray","drawElements","TRIANGLES","count","UNSIGNED_SHORT","drawCalls","unbind","gfxFrameStart","transformStack","transform","mat4","toNDC","pt","x","y","gfxFrameEnd","pushMatrix","m","pushTranslate","p","translate","pushScale","pushRotateX","a","rotateX","pushRotateY","rotateY","pushRotateZ","rotateZ","pushTransform","popTransform","pop","vcount","icount","vbuf","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","DYNAMIC_DRAW","ibuf","ELEMENT_ARRAY_BUFFER","numIndices","vqueue","iqueue","verts","indices","map","concat","bufferSubData","Float32Array","Uint16Array","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_MIN_FILTER","NEAREST","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","vertSrc","fragSrc","vertShader","createShader","VERTEX_SHADER","shaderSource","compileShader","msg","getShaderInfoLog","fragShader","FRAGMENT_SHADER","createProgram","attachShader","bindAttribLocation","linkProgram","getProgramInfoLog","useProgram","sendFloat","val","loc","getUniformLocation","uniform1f","sendVec2","uniform2f","sendVec3","z","uniform3f","sendVec4","w","uniform4f","sendMat4","uniformMatrix4fv","cols","rows","split","entries","ch","Math","floor","drawRaw","v","multVec2","pos","uv","color","r","g","b","flat","drawQuad","h","origin","originPt","DEF_ORIGIN","offset","dot","undefined","rot","q","rgba","vec3","drawSprite","spr","console","warn","frame","drawRectStroke","p1","add","sub","p2","p3","p4","drawLine","drawRect","dist","PI","angle","drawText","txt","drawFmtText","fmtText","ftext","drawPoly","drawCircle","drawingBufferWidth","drawingBufferHeight","orig","isVec2","text","fontName","font","size","cw","curX","th","tw","flines","char","max","fchars","ox","oy","forEach","line","ln","oxl","cn","qpos","AudioContext","webkitAudioContext","gainNode","createGain","gain","value","connect","destination","volume","play","sound","srcNode","createBufferSource","buffer","loop","start","paused","stopped","speed","handle","stop","playbackRate","pause","clamp","detune","unloop","lerp","l1","h1","l2","h2","sqrt","len","unit","normal","atan2","eq","other","str","vec2FromAngle","cos","sin","isColor","rgb","arguments","lighten","darken","colRectRect","r1","r2","overlapRectRect","colLineLine","colRectLine","l","colRectPt","makeLine","mult","out","multVec4","multVec3","invert","f00","f01","f02","f03","f04","f05","f06","f07","f08","f09","f10","f11","f12","f13","f14","f15","f16","f17","f18","det","wave","off","makeRng","seed","gen","A","C","M","randSeed","defRNG","rand","chance","choose","list","deepCopy","input","Array","isArray","cb","game","scenes","init","initialized","events","update","draw","destroy","keyDown","keyPress","keyPressRep","keyRelease","mouseClick","mouseRelease","mouseDown","charInput","action","render","objs","Map","lastID","timers","lastTimerID","shake","mpos","layers","gravity","DEF_GRAVITY","sceneData","regDebugInputs","dbg","log","showArea","hoverInfo","timeScale","toFixed","stepFrame","go","args","reload","def","each","defLayer","camPos","camScale","camRot","camShake","intensity","camIgnore","comps","obj","hidden","_tags","_events","debugInfo","use","comp","type","exists","_sceneID","is","tag","on","event","trigger","f","ev","addTag","removeTag","idx","indexOf","splice","set","readd","delete","collides","t1","t2","o1","_checkCollisions","o2","overlaps","_checkOverlaps","clicks","o","isClicked","wait","newF","pushKeyEvent","get","values","filter","every","revery","reverse","destroyAll","gameFrame","ignorePause","doUpdate","camMat","timer","logTime","logMax","slice","col","realTime","realDt","progress","requestAnimationFrame","move","dx","dy","flipX","sign","abs","flipY","rotate","area","colliding","overlapping","areaWidth","_worldArea","areaHeight","hovered","isHovered","padding","bw","bh","lines","addLine","ftxt","info","field","hovers","hasPt","targets","solid","a1","a2","disLeft","disRight","disTop","disBottom","min","side","isCollided","isOverlapped","getAreaFromSize","looping","curAnim","spriteID","animSpeed","noArea","anim","end","numFrames","onAnimPlay","onAnimEnd","textSize","scsale","rect","velY","curPlatform","maxVel","DEF_MAX_VEL","jumpForce","DEF_JUMP_FORCE","justOff","target","grounded","jump","force","fps","objCount","unshift","addLevel","arr","longRow","level","getPos","spawn","sym","any","gridPos","setGridPos","moveLeft","moveRight","moveUp","moveDown","row","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","radians","Math.radians","degrees","Math.degrees","Math.clamp","Date","now","LOG_TIME","lib","plugins","global","$jscompDefaultExport","$jscomp$tmp$exports$module$name"]
}
