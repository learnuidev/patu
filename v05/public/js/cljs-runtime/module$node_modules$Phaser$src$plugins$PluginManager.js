shadow$provide.module$node_modules$Phaser$src$plugins$PluginManager=function(global,require,module,exports){global=require("module$node_modules$Phaser$src$utils$Class");var EventEmitter=require("module$node_modules$eventemitter3$index"),FileTypesManager=require("module$node_modules$Phaser$src$loader$FileTypesManager"),GameObjectCreator=require("module$node_modules$Phaser$src$gameobjects$GameObjectCreator"),GameObjectFactory=require("module$node_modules$Phaser$src$gameobjects$GameObjectFactory"),GetFastValue=
require("module$node_modules$Phaser$src$utils$object$GetFastValue"),PluginCache=require("module$node_modules$Phaser$src$plugins$PluginCache"),Remove=require("module$node_modules$Phaser$src$utils$array$Remove");require=new global({Extends:EventEmitter,initialize:function(game){EventEmitter.call(this);this.game=game;this.plugins=[];this.scenePlugins=[];this._pendingGlobal=[];this._pendingScene=[];if(game.isBooted)this.boot();else game.events.once("boot",this.boot,this)},boot:function(){var i,config=
this.game.config,list=config.installGlobalPlugins;list=list.concat(this._pendingGlobal);for(i=0;i<list.length;i++){var entry=list[i];var key=GetFastValue(entry,"key",null);var plugin=GetFastValue(entry,"plugin",null);var start=GetFastValue(entry,"start",!1);var mapping=GetFastValue(entry,"mapping",null);entry=GetFastValue(entry,"data",null);key&&plugin&&this.install(key,plugin,start,mapping,entry)}list=config.installScenePlugins;list=list.concat(this._pendingScene);for(i=0;i<list.length;i++)entry=
list[i],key=GetFastValue(entry,"key",null),plugin=GetFastValue(entry,"plugin",null),mapping=GetFastValue(entry,"mapping",null),key&&plugin&&this.installScenePlugin(key,plugin,mapping);this._pendingGlobal=[];this._pendingScene=[];this.game.events.once("destroy",this.destroy,this)},addToScene:function(sys,globalPlugins,scenePlugins){var i,game=this.game,scene=sys.scene,map=sys.settings.map,isBooted=sys.settings.isBooted;for(i=0;i<globalPlugins.length;i++){var pluginKey=globalPlugins[i];game[pluginKey]?
(sys[pluginKey]=game[pluginKey],map.hasOwnProperty(pluginKey)&&(scene[map[pluginKey]]=sys[pluginKey])):"game"===pluginKey&&map.hasOwnProperty(pluginKey)&&(scene[map[pluginKey]]=game)}for(game=0;game<scenePlugins.length;game++)for(globalPlugins=scenePlugins[game],i=0;i<globalPlugins.length;i++)if(pluginKey=globalPlugins[i],PluginCache.hasCore(pluginKey)){pluginKey=PluginCache.getCore(pluginKey);var plugin=new pluginKey.plugin(scene,this);sys[pluginKey.mapping]=plugin;pluginKey.custom?scene[pluginKey.mapping]=
plugin:map.hasOwnProperty(pluginKey.mapping)&&(scene[map[pluginKey.mapping]]=plugin);isBooted&&plugin.boot()}globalPlugins=this.plugins;for(i=0;i<globalPlugins.length;i++)sys=globalPlugins[i],sys.mapping&&(scene[sys.mapping]=sys.plugin)},getDefaultScenePlugins:function(){var list=this.game.config.defaultPlugins;return list=list.concat(this.scenePlugins)},installScenePlugin:function(key,plugin,mapping,addToScene){"function"!==typeof plugin?console.warn("Invalid Scene Plugin: "+key):PluginCache.hasCore(key)?
console.warn("Scene Plugin key in use: "+key):(PluginCache.register(key,plugin,mapping,!0),this.scenePlugins.push(key),addToScene&&(plugin=new plugin(addToScene,this),addToScene.sys[key]=plugin,mapping&&""!==mapping&&(addToScene[mapping]=plugin),plugin.boot()))},install:function(key,plugin,start,mapping,data){void 0===start&&(start=!1);void 0===mapping&&(mapping=null);void 0===data&&(data=null);if("function"!==typeof plugin)console.warn("Invalid Plugin: "+key);else if(PluginCache.hasCustom(key))console.warn("Plugin key in use: "+
key);else if(null!==mapping&&(start=!0),this.game.isBooted){if(PluginCache.registerCustom(key,plugin,mapping,data),start)return this.start(key)}else this._pendingGlobal.push({key:key,plugin:plugin,start:start,mapping:mapping,data:data})},getIndex:function(key){for(var list=this.plugins,i=0;i<list.length;i++)if(list[i].key===key)return i;return-1},getEntry:function(key){key=this.getIndex(key);if(-1!==key)return this.plugins[key]},isActive:function(key){return(key=this.getEntry(key))&&key.active},start:function(key,
runAs){void 0===runAs&&(runAs=key);var entry=this.getEntry(runAs);entry&&!entry.active?(entry.active=!0,entry.plugin.start()):entry||(entry=this.createEntry(key,runAs));return entry?entry.plugin:null},createEntry:function(key,runAs){if(key=PluginCache.getCustom(key)){var instance=new key.plugin(this);key={key:runAs,plugin:instance,active:!0,mapping:key.mapping,data:key.data};this.plugins.push(key);instance.init(key.data);instance.start()}return key},stop:function(key){(key=this.getEntry(key))&&key.active&&
(key.active=!1,key.plugin.stop());return this},get:function(key,autoStart){void 0===autoStart&&(autoStart=!0);var entry=this.getEntry(key);return entry?entry.plugin:(entry=this.getClass(key))&&autoStart?(entry=this.createEntry(key,key))?entry.plugin:null:entry?entry:null},getClass:function(key){return PluginCache.getCustomClass(key)},removeGlobalPlugin:function(key){var entry=this.getEntry(key);entry&&Remove(this.plugins,entry);PluginCache.removeCustom(key)},removeScenePlugin:function(key){Remove(this.scenePlugins,
key);PluginCache.remove(key)},registerGameObject:function(key,factoryCallback,creatorCallback){factoryCallback&&GameObjectFactory.register(key,factoryCallback);creatorCallback&&GameObjectCreator.register(key,creatorCallback);return this},registerFileType:function(key,callback,addToScene){FileTypesManager.register(key,callback);addToScene&&addToScene.sys.load&&(addToScene.sys.load[key]=callback)},destroy:function(){for(var i=0;i<this.plugins.length;i++)this.plugins[i].plugin.destroy();PluginCache.destroyCustomPlugins();
this.game.noReturn&&PluginCache.destroyCorePlugins();this.game=null;this.plugins=[];this.scenePlugins=[]}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$plugins$PluginManager.js.map
