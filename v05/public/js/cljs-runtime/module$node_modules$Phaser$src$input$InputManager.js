shadow$provide.module$node_modules$Phaser$src$input$InputManager=function(global,require,module,exports){global=require("module$node_modules$Phaser$src$utils$Class");var CONST=require("module$node_modules$Phaser$src$input$const"),EventEmitter=require("module$node_modules$eventemitter3$index"),Mouse=require("module$node_modules$Phaser$src$input$mouse$MouseManager"),Pointer=require("module$node_modules$Phaser$src$input$Pointer"),Rectangle=require("module$node_modules$Phaser$src$geom$rectangle$Rectangle"),
Touch=require("module$node_modules$Phaser$src$input$touch$TouchManager"),TransformMatrix=require("module$node_modules$Phaser$src$gameobjects$components$TransformMatrix"),TransformXY=require("module$node_modules$Phaser$src$math$TransformXY");require=new global({initialize:function(game,config){this.game=game;this.config=config;this.enabled=!0;this.events=new EventEmitter;this.queue=[];this.domCallbacks={up:[],down:[],move:[],upOnce:[],downOnce:[],moveOnce:[]};this._hasMoveCallback=this._hasDownCallback=
this._hasUpCallback=!1;this._customCursor="";this._setCursor=0;this.defaultCursor="";this.mouse=config.inputMouse?new Mouse(this):null;this.touch=config.inputTouch?new Touch(this):null;this.pointers=[];this.pointersTotal=config.inputActivePointers;config.inputTouch&&1===this.pointersTotal&&(this.pointersTotal=2);for(var i=0;i<=this.pointersTotal;i++)this.pointers.push(new Pointer(this,i));this.mousePointer=config.inputMouse?this.pointers[0]:null;this.activePointer=this.pointers[0];this.dirty=!1;this.scale=
{x:1,y:1};this.globalTopOnly=!0;this.ignoreEvents=!1;this.bounds=new Rectangle;this._tempPoint={x:0,y:0};this._tempHitTest=[];this._tempMatrix=new TransformMatrix;this._tempMatrix2=new TransformMatrix;game.events.once("boot",this.boot,this)},boot:function(){this.canvas=this.game.canvas;this.updateBounds();this.events.emit("boot");this.game.events.on("prestep",this.update,this);this.game.events.on("poststep",this.postUpdate,this);this.game.events.once("destroy",this.destroy,this)},updateBounds:function(){var bounds=
this.bounds,clientRect=this.canvas.getBoundingClientRect();bounds.x=clientRect.left+window.pageXOffset-document.documentElement.clientLeft;bounds.y=clientRect.top+window.pageYOffset-document.documentElement.clientTop;bounds.width=clientRect.width;bounds.height=clientRect.height},resize:function(){this.updateBounds();var gh=this.game.config.height,bh=this.bounds.height;this.scale.x=this.game.config.width/this.bounds.width;this.scale.y=gh/bh},update:function(time){var i;this._setCursor=0;this.events.emit("update");
this.dirty=this.ignoreEvents=!1;var len=this.queue.length,pointers=this.pointers;for(i=0;i<this.pointersTotal;i++)pointers[i].reset();if(this.enabled&&0!==len){this.dirty=!0;this.updateBounds();this.scale.x=this.game.config.width/this.bounds.width;this.scale.y=this.game.config.height/this.bounds.height;pointers=this.queue.splice(0,len);var mouse=this.mousePointer;for(i=0;i<len;i+=2){var event=pointers[i+1];switch(pointers[i]){case CONST.MOUSE_DOWN:mouse.down(event,time);break;case CONST.MOUSE_MOVE:mouse.move(event,
time);break;case CONST.MOUSE_UP:mouse.up(event,time);break;case CONST.TOUCH_START:this.startPointer(event,time);break;case CONST.TOUCH_MOVE:this.updatePointer(event,time);break;case CONST.TOUCH_END:this.stopPointer(event,time);break;case CONST.POINTER_LOCK_CHANGE:this.events.emit("pointerlockchange",event,this.mouse.locked)}}}},postUpdate:function(){1===this._setCursor?this.canvas.style.cursor=this._customCursor:2===this._setCursor&&(this.canvas.style.cursor=this.defaultCursor)},setDefaultCursor:function(cursor){this.defaultCursor=
cursor;this.canvas.style.cursor!==cursor&&(this.canvas.style.cursor=cursor)},setCursor:function(interactiveObject){interactiveObject.cursor&&(this._setCursor=1,this._customCursor=interactiveObject.cursor)},resetCursor:function(interactiveObject){interactiveObject.cursor&&(this._setCursor=2)},startPointer:function(event,time){for(var pointers=this.pointers,c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(!pointer.active){pointer.touchstart(changedTouch,
time);this.activePointer=pointer;break}}},updatePointer:function(event,time){for(var pointers=this.pointers,c=0;c<event.changedTouches.length;c++)for(var changedTouch=event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchmove(changedTouch,time);this.activePointer=pointer;break}}},stopPointer:function(event,time){for(var pointers=this.pointers,c=0;c<event.changedTouches.length;c++)for(var changedTouch=
event.changedTouches[c],i=1;i<this.pointersTotal;i++){var pointer=pointers[i];if(pointer.active&&pointer.identifier===changedTouch.identifier){pointer.touchend(changedTouch,time);break}}},addPointer:function(quantity){void 0===quantity&&(quantity=1);var output=[];10<this.pointersTotal+quantity&&(quantity=10-this.pointersTotal);for(var i=0;i<quantity;i++){var pointer=new Pointer(this,this.pointers.length);this.pointers.push(pointer);this.pointersTotal++;output.push(pointer)}return output},processDomCallbacks:function(once,
every,event){var i;for(i=0;i<once.length;i++)once[i](event);for(i=0;i<every.length;i++)every[i](event);return 0<every.length},queueTouchStart:function(event){this.queue.push(CONST.TOUCH_START,event);if(this._hasDownCallback){var callbacks=this.domCallbacks;this._hasDownCallback=this.processDomCallbacks(callbacks.downOnce,callbacks.down,event)}},queueTouchMove:function(event){this.queue.push(CONST.TOUCH_MOVE,event);if(this._hasMoveCallback){var callbacks=this.domCallbacks;this._hasMoveCallback=this.processDomCallbacks(callbacks.moveOnce,
callbacks.move,event)}},queueTouchEnd:function(event){this.queue.push(CONST.TOUCH_END,event);if(this._hasUpCallback){var callbacks=this.domCallbacks;this._hasUpCallback=this.processDomCallbacks(callbacks.upOnce,callbacks.up,event)}},queueMouseDown:function(event){this.queue.push(CONST.MOUSE_DOWN,event);if(this._hasDownCallback){var callbacks=this.domCallbacks;this._hasDownCallback=this.processDomCallbacks(callbacks.downOnce,callbacks.down,event)}},queueMouseMove:function(event){this.queue.push(CONST.MOUSE_MOVE,
event);if(this._hasMoveCallback){var callbacks=this.domCallbacks;this._hasMoveCallback=this.processDomCallbacks(callbacks.moveOnce,callbacks.move,event)}},queueMouseUp:function(event){this.queue.push(CONST.MOUSE_UP,event);if(this._hasUpCallback){var callbacks=this.domCallbacks;this._hasUpCallback=this.processDomCallbacks(callbacks.upOnce,callbacks.up,event)}},addUpCallback:function(callback,isOnce){void 0===isOnce&&(isOnce=!0);isOnce?this.domCallbacks.upOnce.push(callback):this.domCallbacks.up.push(callback);
this._hasUpCallback=!0;return this},addDownCallback:function(callback,isOnce){void 0===isOnce&&(isOnce=!0);isOnce?this.domCallbacks.downOnce.push(callback):this.domCallbacks.down.push(callback);this._hasDownCallback=!0;return this},addMoveCallback:function(callback,isOnce){void 0===isOnce&&(isOnce=!1);isOnce?this.domCallbacks.moveOnce.push(callback):this.domCallbacks.move.push(callback);this._hasMoveCallback=!0;return this},inputCandidate:function(gameObject,camera){var input=gameObject.input;if(!input||
!input.enabled||!gameObject.willRender(camera))return!1;input=!0;if(gameObject=gameObject.parentContainer){do{if(!gameObject.willRender(camera)){input=!1;break}gameObject=gameObject.parentContainer}while(gameObject)}return input},hitTest:function(pointer,gameObjects,camera,output){void 0===output&&(output=this._tempHitTest);var tempPoint=this._tempPoint,csx=camera.scrollX,csy=camera.scrollY;output.length=0;var x=pointer.x,y=pointer.y;1!==camera.resolution&&(x+=camera._x,y+=camera._y);camera.getWorldPoint(x,
y,tempPoint);pointer.worldX=tempPoint.x;pointer.worldY=tempPoint.y;pointer={x:0,y:0};x=this._tempMatrix;y=this._tempMatrix2;for(var i=0;i<gameObjects.length;i++){var gameObject=gameObjects[i];if(this.inputCandidate(gameObject,camera)){var px=tempPoint.x+csx*gameObject.scrollFactorX-csx,py=tempPoint.y+csy*gameObject.scrollFactorY-csy;gameObject.parentContainer?(gameObject.getWorldTransformMatrix(x,y),x.applyInverse(px,py,pointer)):TransformXY(px,py,gameObject.x,gameObject.y,gameObject.rotation,gameObject.scaleX,
gameObject.scaleY,pointer);this.pointWithinHitArea(gameObject,pointer.x,pointer.y)&&output.push(gameObject)}}return output},pointWithinHitArea:function(gameObject,x,y){x+=gameObject.displayOriginX;y+=gameObject.displayOriginY;var input=gameObject.input;return input&&input.hitAreaCallback(input.hitArea,x,y,gameObject)?(input.localX=x,input.localY=y,!0):!1},pointWithinInteractiveObject:function(object,x,y){if(!object.hitArea)return!1;x+=object.gameObject.displayOriginX;y+=object.gameObject.displayOriginY;
object.localX=x;object.localY=y;return object.hitAreaCallback(object.hitArea,x,y,object)},transformPointer:function(pointer,pageX,pageY){pointer.prevPosition.x=pointer.x;pointer.prevPosition.y=pointer.y;pointer.x=(pageX-this.bounds.left)*this.scale.x;pointer.y=(pageY-this.bounds.top)*this.scale.y},transformX:function(pageX){return(pageX-this.bounds.left)*this.scale.x},transformY:function(pageY){return(pageY-this.bounds.top)*this.scale.y},getOffsetX:function(){return this.bounds.left},getOffsetY:function(){return this.bounds.top},
getScaleX:function(){return this.game.config.width/this.bounds.width},getScaleY:function(){return this.game.config.height/this.bounds.height},destroy:function(){this.events.removeAllListeners();this.mouse&&this.mouse.destroy();this.touch&&this.touch.destroy();for(var i=0;i<this.pointers.length;i++)this.pointers[i].destroy();this.domCallbacks={};this.pointers=[];this.queue=[];this._tempHitTest=[];this._tempMatrix.destroy();this.game=this.canvas=null}});module.exports=require}
//# sourceMappingURL=module$node_modules$Phaser$src$input$InputManager.js.map
